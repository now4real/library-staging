/**
 * @preserve
 * LIGHTSTREAMER - www.lightstreamer.com
 * Lightstreamer Web Client
 * Version 9.2.0+20240416-n4r
 * Copyright (c) Lightstreamer Srl. All Rights Reserved.
 * Contains: LightstreamerClient, Subscription, ConsoleLogLevel,
 * ConsoleLoggerProvider, Logger, LoggerProvider, ClientListener,
 * ClientMessageListener, ItemUpdate, SubscriptionListener
 * UMD
 */
!function(t,e){var s,i=(s=function(t){"use strict";function e(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var s=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(s,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),s}const s=t=>(e,s)=>(t.set(e,s),s),i=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,r=2*n,a=(t,e)=>s=>{const a=e.get(s);let o=void 0===a?s.size:a<r?a+1:0;if(!s.has(o))return t(s,o);if(s.size<n){for(;s.has(o);)o=Math.floor(Math.random()*r);return t(s,o)}if(s.size>i)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;s.has(o);)o=Math.floor(Math.random()*i);return t(s,o)},o=new WeakMap,h=a(s(o),o),c=t=>void 0!==t.method&&"call"===t.method,l=t=>null===t.error&&"number"==typeof t.id,u=t=>{const e=new Map([[0,()=>{}]]),s=new Map([[0,()=>{}]]),i=new Map,n=new Worker(t);return n.addEventListener("message",(({data:t})=>{if(c(t)){const{params:{timerId:n,timerType:r}}=t;if("interval"===r){const t=e.get(n);if("number"==typeof t){const e=i.get(t);if(void 0===e||e.timerId!==n||e.timerType!==r)throw new Error("The timer is in an undefined state.")}else{if(void 0===t)throw new Error("The timer is in an undefined state.");t()}}else if("timeout"===r){const t=s.get(n);if("number"==typeof t){const e=i.get(t);if(void 0===e||e.timerId!==n||e.timerType!==r)throw new Error("The timer is in an undefined state.")}else{if(void 0===t)throw new Error("The timer is in an undefined state.");t(),s.delete(n)}}}else{if(!l(t)){const{error:{message:e}}=t;throw new Error(e)}{const{id:n}=t,r=i.get(n);if(void 0===r)throw new Error("The timer is in an undefined state.");const{timerId:a,timerType:o}=r;i.delete(n),"interval"===o?e.delete(a):s.delete(a)}}})),{clearInterval:t=>{const s=h(i);i.set(s,{timerId:t,timerType:"interval"}),e.set(t,s),n.postMessage({id:s,method:"clear",params:{timerId:t,timerType:"interval"}})},clearTimeout:t=>{const e=h(i);i.set(e,{timerId:t,timerType:"timeout"}),s.set(t,e),n.postMessage({id:e,method:"clear",params:{timerId:t,timerType:"timeout"}})},setInterval:(t,s=0)=>{const i=h(e);return e.set(i,(()=>{t(),"function"==typeof e.get(i)&&n.postMessage({id:null,method:"set",params:{delay:s,now:performance.now(),timerId:i,timerType:"interval"}})})),n.postMessage({id:null,method:"set",params:{delay:s,now:performance.now(),timerId:i,timerType:"interval"}}),i},setTimeout:(t,e=0)=>{const i=h(s);return s.set(i,t),n.postMessage({id:null,method:"set",params:{delay:e,now:performance.now(),timerId:i,timerType:"timeout"}}),i}}},_=(t,e)=>{let s=null;return()=>{if(null!==s)return s;const i=new Blob([e],{type:"application/javascript; charset=utf-8"}),n=URL.createObjectURL(i);return s=t(n),setTimeout((()=>URL.revokeObjectURL(n))),s}},d=_(u,'(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'),f=t=>d().clearInterval(t),m=t=>d().clearTimeout(t),p=(...t)=>d().setInterval(...t),g=(...t)=>d().setTimeout(...t);var v=e(Object.freeze({__proto__:null,clearInterval:f,clearTimeout:m,setInterval:p,setTimeout:g})),S=function(){};S.prototype={fatal:function(t,e){},isFatalEnabled:function(){},error:function(t,e){},isErrorEnabled:function(){},warn:function(t,e){},isWarnEnabled:function(){},info:function(t,e){},isInfoEnabled:function(){},debug:function(t,e){},isDebugEnabled:function(){},trace:function(t,e){},isTraceEnabled:function(){}};var y=function(){};function b(){}function E(){}y.prototype={getLogger:function(t){}},b.prototype={onServerError:function(t,e){},onStatusChange:function(t){},onPropertyChange:function(t){},onListenStart:function(){},onListenEnd:function(){},onServerKeepalive:function(){}},E.prototype={onAbort:function(t,e){},onError:function(t){},onDiscarded:function(t){},onDeny:function(t,e,s){},onProcessed:function(t,e){}};var w=function(){};w.prototype={getItemName:function(){},getItemPos:function(){},getValue:function(t){},getValueAsJSONPatchIfAvailable:function(t){return null},isValueChanged:function(t){},isSnapshot:function(){},forEachChangedField:function(t){},forEachField:function(t){}};var T=function(){};T.prototype={onItemUpdate:function(t){},onItemLostUpdates:function(t,e,s){},onCommandSecondLevelItemLostUpdates:function(t,e){},onEndOfSnapshot:function(t,e){},onClearSnapshot:function(t,e){},onSubscription:function(){},onUnsubscription:function(){},onSubscriptionError:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onListenStart:function(){},onListenEnd:function(){},onRealMaxFrequency:function(t){}};var R={};!function(t){var e,s=function(){return W.__string_rec(this,"")},i=i||{};function n(t,e){var s=Object.create(t);for(var i in e)s[i]=e[i];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}var r=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};r.__name__=!0,r.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},__class__:r};var a=function(){};a.__name__=!0,a.dateStr=function(t){var e=t.getMonth()+1,s=t.getDate(),i=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:""+e)+"-"+(s<10?"0"+s:""+s)+" "+(i<10?"0"+i:""+i)+":"+(n<10?"0"+n:""+n)+":"+(r<10?"0"+r:""+r)},a.cca=function(t,e){var s=t.charCodeAt(e);if(s==s)return s},a.substr=function(t,e,s){if(null==s)s=t.length;else if(s<0){if(0!=e)return"";s=t.length+s}return t.substr(e,s)},a.remove=function(t,e){var s=t.indexOf(e);return-1!=s&&(t.splice(s,1),!0)},a.now=function(){return Date.now()};var o=function(t,e){this.min=t,this.max=e};o.__name__=!0,o.prototype={hasNext:function(){return this.min<this.max},next:function(){return this.min++},__class__:o};var h=function(){};h.__name__=!0,h.has=function(t,e){for(var s=ds(t);s.hasNext();)if(s.next()==e)return!0;return!1},h.exists=function(t,e){for(var s=ds(t);s.hasNext();)if(e(s.next()))return!0;return!1},h.count=function(t,e){var s=0;if(null==e)for(var i=ds(t);i.hasNext();)i.next(),++s;else for(var n=ds(t);n.hasNext();)e(n.next())&&++s;return s},h.empty=function(t){return!ds(t).hasNext()},h.find=function(t,e){for(var s=ds(t);s.hasNext();){var i=s.next();if(e(i))return i}return null},Math.__name__=!0;var c=function(){};c.__name__=!0,c.field=function(t,e){try{return t[e]}catch(t){return null}},c.fields=function(t){var e=[];if(null!=t){var s=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&s.call(t,i)&&e.push(i)}return e},c.copy=function(t){if(null==t)return null;for(var e={},s=0,i=c.fields(t);s<i.length;){var n=i[s];++s,e[n]=c.field(t,n)}return e};var l=function(){};l.__name__=!0,l.string=function(t){return W.__string_rec(t,"")},l.parseInt=function(t){var e=parseInt(t);return isNaN(e)?null:e},l.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var u=function(){this.b=""};u.__name__=!0,u.prototype={__class__:u};var _=function(){};_.__name__=!0,_.startsWith=function(t,e){return t.length>=e.length&&0==t.lastIndexOf(e,0)},_.endsWith=function(t,e){var s=e.length,i=t.length;return i>=s&&t.indexOf(e,i-s)==i-s},_.isSpace=function(t,e){var s=a.cca(t,e);return s>8&&s<14||32==s},_.ltrim=function(t){for(var e=t.length,s=0;s<e&&_.isSpace(t,s);)++s;return s>0?a.substr(t,s,e-s):t},_.rtrim=function(t){for(var e=t.length,s=0;s<e&&_.isSpace(t,e-s-1);)++s;return s>0?a.substr(t,0,e-s):t},_.trim=function(t){return _.ltrim(_.rtrim(t))},_.replace=function(t,e,s){return t.split(e).join(s)};var d=function(){};d.__name__=!0,d.enumEq=function(t,e){if(t==e)return!0;try{var s=t.__enum__;if(null==s||s!=e.__enum__)return!1;if(t._hx_index!=e._hx_index)return!1;for(var n=i[s].__constructs__[t._hx_index].__params__,r=0;r<n.length;){var a=n[r];if(++r,!d.enumEq(t[a],e[a]))return!1}}catch(r){return!1}return!0};var f=R.LSConnectionDetails=function(t){this.serverAddress=Es,this.client=t,this.lock=t.lock};f.__name__=!0,f.prototype={getServerAddress:function(){return this.serverAddress},setServerAddress:function(t){var e=p.fromString(t);if(e!=this.serverAddress){Ms.isInfoEnabled()&&Ms.info("serverAddress changed: "+e);var s=this.serverAddress;this.serverAddress=e,this.client.eventDispatcher.onPropertyChange("serverAddress"),s!=e&&this.client.machine.evtServerAddressChanged()}},getAdapterSet:function(){return this.adapterSet},setAdapterSet:function(t){t!=this.adapterSet&&(Ms.isInfoEnabled()&&Ms.info("adapterSet changed: "+t),this.adapterSet=t,this.client.eventDispatcher.onPropertyChange("adapterSet"))},getUser:function(){return this.user},setUser:function(t){t!=this.user&&(Ms.isInfoEnabled()&&Ms.info("user changed: "+t),this.user=t,this.client.eventDispatcher.onPropertyChange("user"))},setPassword:function(t){t!=this.password&&(Ms.isInfoEnabled()&&Ms.info("password changed"),this.password=t,this.client.eventDispatcher.onPropertyChange("password"))},getSessionId:function(){return this.sessionId},setSessionId:function(t){t!=this.sessionId&&(this.sessionId=t,this.client.eventDispatcher.onPropertyChange("sessionId"))},getServerInstanceAddress:function(){return this.serverInstanceAddress},setServerInstanceAddress:function(t){t!=this.serverInstanceAddress&&(this.serverInstanceAddress=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddress"))},getServerSocketName:function(){return this.serverSocketName},setServerSocketName:function(t){t!=this.serverSocketName&&(this.serverSocketName=t,this.client.eventDispatcher.onPropertyChange("serverSocketName"))},getClientIp:function(){return this.clientIp},setClientIp:function(t){t!=this.clientIp&&(this.clientIp=t,this.client.eventDispatcher.onPropertyChange("clientIp"))},toString:function(){var t=te._new();return te.set(t,"serverAddress",this.serverAddress),te.set(t,"adapterSet",this.adapterSet),te.set(t,"user",this.user),te.set(t,"sessionId",this.sessionId),te.set(t,"serverInstanceAddress",this.serverInstanceAddress),te.set(t,"serverSocketName",this.serverSocketName),te.set(t,"clientIp",this.clientIp),te.set(t,"libVersion",x.LIB_NAME+" "+x.LIB_VERSION),as.stringify(t.h)},__class__:f};var m=function(){};m.__name__=!0,m.get_supported=function(){return"undefined"!=typeof window&&void 0!==window.location&&"string"==typeof window.location.protocol};var p={_new:function(t){return t},fromString:function(t){if(null==t)return null;if(_.startsWith(t,"http://")||_.startsWith(t,"https://"))return t;throw new b("address is malformed")}},g=function(t,e,s){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=null!=s?s:this,this.__skipStack=0;var i=Error.prepareStackTrace;if(Error.prepareStackTrace=function(t){return t.stack},s instanceof Error)this.stack=s.stack;else{var n=null;if(Error.captureStackTrace)Error.captureStackTrace(this,g),n=this;else if(void 0===(n=new Error).stack){try{throw n}catch(t){}this.__skipStack++}this.stack=n.stack}Error.prepareStackTrace=i};g.__name__=!0,g.caught=function(t){return t instanceof g?t:t instanceof Error?new g(t.message,null,t):new ns(t,null,t)},g.thrown=function(t){if(t instanceof g)return t.get_native();if(t instanceof Error)return t;var e=new ns(t);return e.__skipStack++,e},g.__super__=Error,g.prototype=n(Error.prototype,{toString:function(){return this.get_message()},details:function(){if(null==this.get_previous()){var t="Exception: "+this.toString(),e=this.get_stack();return t+(null==e?"null":ss.toString(e))}for(var s="",i=this,n=null;null!=i;){if(null==n)s="Exception: "+i.get_message()+(null==(t=i.get_stack())?"null":ss.toString(t))+s;else{var r=ss.subtract(i.get_stack(),n.get_stack());s="Exception: "+i.get_message()+(null==r?"null":ss.toString(r))+"\n\nNext "+s}n=i,i=i.get_previous()}return s},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_previous:function(){return this.__previousException},get_native:function(){return this.__nativeException},get_stack:function(){var t=this.__exceptionStack;if(null==t){var e=is.toHaxe(is.normalize(this.stack),this.__skipStack);return this.setProperty("__exceptionStack",e),e}return t},setProperty:function(t,e){try{Object.defineProperty(this,t,{value:e})}catch(s){this[t]=e}},__class__:g});var b=function(t,e,s){g.call(this,t,e,s),this.__skipStack++};b.__name__=!0,b.__super__=g,b.prototype=n(g.prototype,{__class__:b});var E=R.LSConnectionOptions=function(t){this.cookieHandlingRequired=!1,this.slowingEnabled=!1,this.serverInstanceAddressIgnored=!1,this.httpExtraHeadersOnSessionCreationOnly=!1,this.stalledTimeout=2e3,this.sessionRecoveryTimeout=15e3,this.reverseHeartbeatInterval=0,this.retryDelay=4e3,this.reconnectTimeout=3e3,this.pollingInterval=0,this.realMaxBandwidth=null,this.requestedMaxBandwidth=Oe.BWUnlimited,this.keepaliveInterval=0,this.idleTimeout=19e3,this.httpExtraHeaders=null,this.forcedTransport=null,this.firstRetryMaxDelay=100,this.contentLength=5e7,this.client=t,this.lock=t.lock};E.__name__=!0,E.prototype={getContentLength:function(){return this.contentLength},setContentLength:function(t){var e=De.fromIntGt0(t);e!=this.contentLength&&(Ms.isInfoEnabled()&&Ms.info("contentLength changed: "+e),this.contentLength=e,this.client.eventDispatcher.onPropertyChange("contentLength"))},getFirstRetryMaxDelay:function(){return this.firstRetryMaxDelay},setFirstRetryMaxDelay:function(t){var e=Le.fromIntGt0(t);e!=this.firstRetryMaxDelay&&(Ms.isInfoEnabled()&&Ms.info("firstRetryMaxDelay changed: "+e),this.firstRetryMaxDelay=e,this.client.eventDispatcher.onPropertyChange("firstRetryMaxDelay"))},getForcedTransport:function(){return this.forcedTransport},setForcedTransport:function(t){var e=Ne.fromString(t);e!=this.forcedTransport&&(Ms.isInfoEnabled()&&Ms.info("forcedTransport changed: "+e),this.forcedTransport=e,this.client.eventDispatcher.onPropertyChange("forcedTransport"),this.client.machine.evtExtSetForcedTransport())},getHttpExtraHeaders:function(){return null==this.httpExtraHeaders?null:re.fromMapToDynamicAccess(this.httpExtraHeaders)},setHttpExtraHeaders:function(t){var e=null!=t?re.toHaxe(t):null;this.mapEq(e,this.httpExtraHeaders)||(Ms.isInfoEnabled()&&Ms.info("httpExtraHeaders changed: "+(null==e?"null":as.stringify(e.h))),this.httpExtraHeaders=e,this.client.eventDispatcher.onPropertyChange("httpExtraHeaders"))},mapEq:function(t,e){if(t==e)return!0;if(null==t||null==e)return!1;if(h.count(t)!=h.count(e))return!1;for(var s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var a=i[r++];if(s[a]!=e.h[a])return!1}return!0},getIdleTimeout:function(){return this.idleTimeout},setIdleTimeout:function(t){var e=Le.fromIntGtEq0(t);e!=this.idleTimeout&&(Ms.isInfoEnabled()&&Ms.info("idleTimeout changed: "+e),this.idleTimeout=e,this.client.eventDispatcher.onPropertyChange("idleTimeout"))},getKeepaliveInterval:function(){return this.keepaliveInterval},setKeepaliveInterval:function(t){var e=Le.fromIntGtEq0(t);e!=this.keepaliveInterval&&(Ms.isInfoEnabled()&&Ms.info("keepaliveInterval changed: "+e),this.keepaliveInterval=e,this.client.eventDispatcher.onPropertyChange("keepaliveInterval"))},getRequestedMaxBandwidth:function(){return Me.toString(this.requestedMaxBandwidth)},setRequestedMaxBandwidth:function(t){null!=t&&(t=null==t?"null":""+t);var e=Me.fromString(t);d.enumEq(e,this.requestedMaxBandwidth)||(Ms.isInfoEnabled()&&Ms.info("requestedMaxBandwidth changed: "+Me.toString(e)),this.requestedMaxBandwidth=e,this.client.eventDispatcher.onPropertyChange("requestedMaxBandwidth"),this.client.machine.evtExtSetRequestedMaxBandwidth())},getRealMaxBandwidth:function(){return He.toString(this.realMaxBandwidth)},setRealMaxBandwidth:function(t){He.eq(t,this.realMaxBandwidth)||(this.realMaxBandwidth=t,this.client.eventDispatcher.onPropertyChange("realMaxBandwidth"))},getPollingInterval:function(){return this.pollingInterval},setPollingInterval:function(t){var e=Le.fromIntGtEq0(t);e!=this.pollingInterval&&(Ms.isInfoEnabled()&&Ms.info("pollingInterval changed: "+e),this.pollingInterval=e,this.client.eventDispatcher.onPropertyChange("pollingInterval"))},getReconnectTimeout:function(){return this.reconnectTimeout},setReconnectTimeout:function(t){var e=Le.fromIntGt0(t);e!=this.reconnectTimeout&&(Ms.isInfoEnabled()&&Ms.info("reconnectTimeout changed: "+e),this.reconnectTimeout=e,this.client.eventDispatcher.onPropertyChange("reconnectTimeout"))},getRetryDelay:function(){return this.retryDelay},setRetryDelay:function(t){var e=Le.fromIntGt0(t);e!=this.retryDelay&&(Ms.isInfoEnabled()&&Ms.info("retryDelay changed: "+e),this.retryDelay=e,this.client.eventDispatcher.onPropertyChange("retryDelay"))},getReverseHeartbeatInterval:function(){return this.reverseHeartbeatInterval},setReverseHeartbeatInterval:function(t){var e=Le.fromIntGtEq0(t);e!=this.reverseHeartbeatInterval&&(Ms.isInfoEnabled()&&Ms.info("reverseHeartbeatInterval changed: "+e),this.reverseHeartbeatInterval=e,this.client.eventDispatcher.onPropertyChange("reverseHeartbeatInterval"),this.client.machine.evtExtSetReverseHeartbeatInterval())},getSessionRecoveryTimeout:function(){return this.sessionRecoveryTimeout},setSessionRecoveryTimeout:function(t){var e=Le.fromIntGtEq0(t);e!=this.sessionRecoveryTimeout&&(Ms.isInfoEnabled()&&Ms.info("sessionRecoveryTimeout changed: "+e),this.sessionRecoveryTimeout=e,this.client.eventDispatcher.onPropertyChange("sessionRecoveryTimeout"))},getStalledTimeout:function(){return this.stalledTimeout},setStalledTimeout:function(t){var e=Le.fromIntGt0(t);e!=this.stalledTimeout&&(Ms.isInfoEnabled()&&Ms.info("stalledTimeout changed: "+e),this.stalledTimeout=e,this.client.eventDispatcher.onPropertyChange("stalledTimeout"))},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.httpExtraHeadersOnSessionCreationOnly},setHttpExtraHeadersOnSessionCreationOnly:function(t){t!=this.httpExtraHeadersOnSessionCreationOnly&&(Ms.isInfoEnabled()&&Ms.info("httpExtraHeadersOnSessionCreationOnly changed: "+(null==t?"null":""+t)),this.httpExtraHeadersOnSessionCreationOnly=t,this.client.eventDispatcher.onPropertyChange("httpExtraHeadersOnSessionCreationOnly"))},isServerInstanceAddressIgnored:function(){return this.serverInstanceAddressIgnored},setServerInstanceAddressIgnored:function(t){t!=this.serverInstanceAddressIgnored&&(Ms.isInfoEnabled()&&Ms.info("serverInstanceAddressIgnored changed: "+(null==t?"null":""+t)),this.serverInstanceAddressIgnored=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddressIgnored"))},setCookieHandlingRequired:function(t){t!=this.cookieHandlingRequired&&(Ms.isInfoEnabled()&&Ms.info("cookieHandlingRequired changed: "+(null==t?"null":""+t)),this.cookieHandlingRequired=t,this.client.eventDispatcher.onPropertyChange("cookieHandlingRequired"))},isCookieHandlingRequired:function(){return this.cookieHandlingRequired},isSlowingEnabled:function(){return this.slowingEnabled},setSlowingEnabled:function(t){t!=this.slowingEnabled&&(Ms.isInfoEnabled()&&Ms.info("slowingEnabled changed: "+(null==t?"null":""+t)),this.slowingEnabled=t,this.client.eventDispatcher.onPropertyChange("slowingEnabled"))},toString:function(){var t=te._new();return te.set(t,"forcedTransport",this.forcedTransport),te.set(t,"requestedMaxBandwidth",this.requestedMaxBandwidth),te.set(t,"realMaxBandwidth",this.realMaxBandwidth),te.set(t,"retryDelay",this.retryDelay),te.set(t,"firstRetryMaxDelay",this.firstRetryMaxDelay),te.set(t,"sessionRecoveryTimeout",this.sessionRecoveryTimeout),te.set(t,"reverseHeartbeatInterval",this.reverseHeartbeatInterval),te.set(t,"stalledTimeout",this.stalledTimeout),te.set(t,"reconnectTimeout",this.reconnectTimeout),te.set(t,"keepaliveInterval",this.keepaliveInterval),te.set(t,"pollingInterval",this.pollingInterval),te.set(t,"idleTimeout",this.idleTimeout),te.set(t,"contentLength",this.contentLength),te.set(t,"slowingEnabled",this.slowingEnabled),te.set(t,"serverInstanceAddressIgnored",this.serverInstanceAddressIgnored),te.set(t,"HTTPExtraHeadersOnSessionCreationOnly",this.httpExtraHeadersOnSessionCreationOnly),te.set(t,"HTTPExtraHeaders",this.httpExtraHeaders),te.set(t,"cookieHandlingRequired",this.cookieHandlingRequired),as.stringify(t.h)},__class__:E};var I=function(){this.listeners=[]};I.__name__=!0,I.prototype={addListener:function(t){return-1==this.listeners.indexOf(t)&&(this.listeners.push(t),!0)},removeListener:function(t){return a.remove(this.listeners,t)},getListeners:function(){return this.listeners},dispatchToAll:function(t){for(var e=0,s=this.listeners;e<s.length;)this.dispatchToOne(s[e++],t)},dispatchToOne:function(t,e){Ks((function(){try{e(t)}catch(t){var s=g.caught(t);Ms.isErrorEnabled()&&Ms.error("Uncaught exception\n"+s.details())}}))},__class__:I};var C=function(){I.call(this)};C.__name__=!0,C.__super__=I,C.prototype=n(I.prototype,{removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onServerError:function(t,e){this.dispatchToAll((function(s){null!=s.onServerError&&s.onServerError(t,e)}))},onStatusChange:function(t){this.dispatchToAll((function(e){null!=e.onStatusChange&&e.onStatusChange(t)}))},onPropertyChange:function(t){this.dispatchToAll((function(e){null!=e.onPropertyChange&&e.onPropertyChange(t)}))},onServerKeepalive:function(){this.dispatchToAll((function(t){null!=t.onServerKeepalive&&t.onServerKeepalive()}))},__class__:C});var x=R.LSLightstreamerClient=function(t,e){this.lock=new F,this.eventDispatcher=new C,this.connectionDetails=new f(this),this.connectionOptions=new E(this),this.machine=new B(this,new ge(this)),null!=t&&this.connectionDetails.setServerAddress(t),null!=e&&this.connectionDetails.setAdapterSet(e)};x.__name__=!0,x.setLoggerProvider=function(t){q.setLoggerProvider(t)},x.prototype={addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},connect:function(){this.machine.connect()},disconnect:function(){this.machine.disconnect()},getStatus:function(){return this.machine.getStatus()},sendMessage:function(t,e,s,i,n){null==n&&(n=!1),null==s&&(s=-1),this.machine.sendMessage(t,e,null!=s?s:-1,i,null!=n&&n)},subscribe:function(t){this.machine.subscribeExt(t)},unsubscribe:function(t){this.machine.unsubscribe(t)},getSubscriptions:function(){return this.machine.getSubscriptions().slice()},getSubscriptionWrappers:function(){for(var t=[],e=0,s=this.machine.getSubscriptions();e<s.length;){var i=s[e];++e,null!=i.wrapper&&t.push(i.wrapper)}return t.slice()},__class__:x};var L=i["com.lightstreamer.client._Subscription.SubscriptionState"]={__ename__:!0,__constructs__:null,Inactive:{_hx_name:"Inactive",_hx_index:0,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:s},Active:{_hx_name:"Active",_hx_index:1,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:s},Subscribed:{_hx_name:"Subscribed",_hx_index:2,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:s}};L.__constructs__=[L.Inactive,L.Active,L.Subscribed];var D=function(){I.call(this)};D.__name__=!0,D.__super__=I,D.prototype=n(I.prototype,{onClearSnapshot:function(t,e){this.dispatchToAll((function(s){null!=s.onClearSnapshot&&s.onClearSnapshot(t,e)}))},onCommandSecondLevelItemLostUpdates:function(t,e){this.dispatchToAll((function(s){null!=s.onCommandSecondLevelItemLostUpdates&&s.onCommandSecondLevelItemLostUpdates(t,e)}))},onCommandSecondLevelSubscriptionError:function(t,e,s){this.dispatchToAll((function(i){null!=i.onCommandSecondLevelSubscriptionError&&i.onCommandSecondLevelSubscriptionError(t,e,s)}))},onEndOfSnapshot:function(t,e){this.dispatchToAll((function(s){null!=s.onEndOfSnapshot&&s.onEndOfSnapshot(t,e)}))},onItemLostUpdates:function(t,e,s){this.dispatchToAll((function(i){null!=i.onItemLostUpdates&&i.onItemLostUpdates(t,e,s)}))},onItemUpdate:function(t){this.dispatchToAll((function(e){null!=e.onItemUpdate&&e.onItemUpdate(t)}))},removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onSubscription:function(){this.dispatchToAll((function(t){null!=t.onSubscription&&t.onSubscription()}))},onSubscriptionError:function(t,e){this.dispatchToAll((function(s){null!=s.onSubscriptionError&&s.onSubscriptionError(t,e)}))},onUnsubscription:function(){this.dispatchToAll((function(t){null!=t.onUnsubscription&&t.onUnsubscription()}))},onRealMaxFrequency:function(t){this.dispatchToAll((function(e){null!=e.onRealMaxFrequency&&e.onRealMaxFrequency(t)}))},__class__:D});var N=R.LSSubscription=function(t,e,s,i){this.lock=new F,this.m_internal=!1,this.state=L.Inactive,this.eventDispatcher=new D,this.wrapper=i,this.mode=Ke.fromString(t),this.initSnapshot(),this.initItemsAndFields("string"==typeof e?[e].slice():e,s)};N.__name__=!0,N.prototype={initSnapshot:function(){this.snapshot="RAW"==this.mode?null:Fe.SnpYes},initItemsAndFields:function(t,e){if(null!=t){if(null==e)throw new b("Please specify a valid field list");if(this.items=Ve.fromArray(ae.copy(t,t)),this.fields=Ge.fromArray(ae.copy(e,e)),"COMMAND"==this.mode&&-1==this.fields.indexOf("key"))throw new b("Field 'key' is missing");if("COMMAND"==this.mode&&-1==this.fields.indexOf("command"))throw new b("Field 'command' is missing")}else if(null!=e)throw new b("Please specify a valid item or item list")},addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},isActive:function(){return this.state!=L.Inactive},isSubscribed:function(){return this.state==L.Subscribed},getDataAdapter:function(){return this.dataAdapter},setDataAdapter:function(t){this.checkActive(),this.dataAdapter=ze.fromString(t)},getMode:function(){return this.mode},getItems:function(){return null==this.items?null:this.items.slice()},fetchItems:function(){return this.items},setItems:function(t){this.checkActive(),this.items=Ve.fromArray(null==t?null:ae.copy(t,t)),this.group=null},getItemGroup:function(){return this.group},setItemGroup:function(t){this.checkActive(),this.group=ze.fromString(t),this.items=null},getFields:function(){return null==this.fields?null:this.fields.slice()},fetchFields:function(){return this.fields},setFields:function(t){this.checkActive();var e=Ge.fromArray(null==t?null:ae.copy(t,t));if("COMMAND"==this.mode&&null!=e){if(-1==e.indexOf("command"))throw new b("Field 'command' is missing");if(-1==e.indexOf("key"))throw new b("Field 'key' is missing")}this.fields=e,this.schema=null},getFieldSchema:function(){return this.schema},setFieldSchema:function(t){this.checkActive(),this.schema=ze.fromString(t),this.fields=null},getRequestedBufferSize:function(){return ke.toString(this.bufferSize)},setRequestedBufferSize:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.bufferSize=ke.fromString(t)},getRequestedSnapshot:function(){return qe.toString(this.snapshot)},setRequestedSnapshot:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive();var e=qe.fromString(t);switch(this.mode){case"COMMAND":case"MERGE":if(null!=e&&null!=e&&2==e._hx_index)throw new b("Snapshot length is not permitted if MERGE or COMMAND was specified as mode");break;case"RAW":if(null!=e)throw new b("Snapshot is not permitted if RAW was specified as mode")}this.snapshot=e},getRequestedMaxFrequency:function(){return We.toString(this.requestedMaxFrequency)},setRequestedMaxFrequency:function(t){var e,s=this;null!=t&&(t=null==t?"null":""+t),this.lock.synchronized((function(){var i=We.fromString(t);switch(s.mode){case"COMMAND":case"DISTINCT":case"MERGE":break;default:throw new b("The operation in only available on MERGE, DISTINCT and COMMAND Subscripitons")}if(s.isActive()&&(null==i||i==Ae.FreqUnfiltered||s.requestedMaxFrequency==Ae.FreqUnfiltered))throw new b("Cannot change the frequency from/to 'unfiltered' or to null while the Subscription is active");return null!=s.subId&&ks.isInfoEnabled()&&ks.info("Subscription "+s.subId+" requested max frequency changed: "+t),s.requestedMaxFrequency=i,e=s.manager})),null!=e&&e.evtExtConfigure()},getSelector:function(){return this.selector},setSelector:function(t){this.checkActive(),this.selector=ze.fromString(t)},getCommandPosition:function(){if(this.checkCommand(),null==this.cmdIdx)throw new ne("The position of the command field is currently unknown");return this.cmdIdx},getKeyPosition:function(){if(this.checkCommand(),null==this.keyIdx)throw new ne("The position of the key field is currently unknown");return this.keyIdx},getCommandSecondLevelDataAdapter:function(){return this.dataAdapter2},setCommandSecondLevelDataAdapter:function(t){this.checkActive(),this.checkCommand(),this.dataAdapter2=ze.fromString(t)},getCommandSecondLevelFields:function(){return null==this.fields2?null:this.fields2.slice()},setCommandSecondLevelFields:function(t){this.checkActive(),this.checkCommand(),this.fields2=Ge.fromArray(null==t?null:ae.copy(t,t)),this.schema2=null},getCommandSecondLevelFieldSchema:function(){return this.schema2},setCommandSecondLevelFieldSchema:function(t){this.checkActive(),this.checkCommand(),this.schema2=ze.fromString(t),this.fields2=null},getValue:function(t,e){var s="number"==typeof t&&(0|t)===t,i="string"==typeof t,n="number"==typeof e&&(0|e)===e,r="string"==typeof e;if(s&&n)return this.getValuePosPos(t,e);if(s&&r)return this.getValuePosName(t,e);if(i&&n)return this.getValueNamePos(t,e);if(i&&r)return this.getValueNameName(t,e);throw new b("Invalid argument type")},getCommandValue:function(t,e,s){var i="number"==typeof t&&(0|t)===t,n="string"==typeof t,r="number"==typeof s&&(0|s)===s,a="string"==typeof s;if(i&&r)return this.getCommandValuePosPos(t,e,s);if(i&&a)return this.getCommandValuePosName(t,e,s);if(n&&r)return this.getCommandValueNamePos(t,e,s);if(n&&a)return this.getCommandValueNameName(t,e,s);throw new b("Invalid argument type")},getValuePosPos:function(t,e){var s,i=this;if(t<1||e<1)throw new b("The specified position is out of bounds");return this.lock.synchronized((function(){return s=i.manager})),null!=s?s.getValue(t,e):null},getValuePosName:function(t,e){var s=this;return this.getValuePosPos(t,this.lock.synchronized((function(){return s.getFieldPos(e)})))},getValueNamePos:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized((function(){return s.getItemPos(t)})),e)},getValueNameName:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized((function(){return s.getItemPos(t)})),this.lock.synchronized((function(){return s.getFieldPos(e)})))},getCommandValuePosPos:function(t,e,s){var i,n=this;if(this.checkCommand(),t<1||s<1)throw new b("The specified position is out of bounds");return this.lock.synchronized((function(){return i=n.manager})),null!=i?i.getCommandValue(t,e,s):null},getCommandValuePosName:function(t,e,s){var i=this;return this.getCommandValuePosPos(t,e,this.lock.synchronized((function(){return i.getFieldPos(s)})))},getCommandValueNamePos:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized((function(){return i.getItemPos(t)})),e,s)},getCommandValueNameName:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized((function(){return i.getItemPos(t)})),e,this.lock.synchronized((function(){return i.getFieldPos(s)})))},getItemPos:function(t){var e;if(null==this.items||-1==(e=Ve.getPos(this.items,t)))throw new b("Unknown item name");return e},getFieldPos:function(t){var e;if(null==this.fields||-1==(e=Ge.getPos(this.fields,t)))throw new b("Unknown field name");return e},checkActive:function(){if(this.isActive())throw new ne("Cannot modify an active Subscription. Please unsubscribe before applying any change")},checkCommand:function(){if("COMMAND"!=this.mode)throw new ne("This method can only be used on COMMAND subscriptions")},fetch_items:function(){return this.items},fetch_fields:function(){return this.fields},fetch_fields2:function(){return this.fields2},fetch_mode:function(){return this.mode},fetch_requestedBufferSize:function(){return this.bufferSize},fetch_requestedSnapshot:function(){return this.snapshot},fetch_requestedMaxFrequency:function(){return this.requestedMaxFrequency},fetch_nItems:function(){return this.nItems},fetch_subManager:function(){return this.manager},setActive:function(){this.state=L.Active},setInactive:function(){this.state=L.Inactive,this.subId=null,this.cmdIdx=null,this.keyIdx=null,this.nItems=null,this.nFields=null},setSubscribed:function(t,e,s){this.state=L.Subscribed,this.subId=t,this.nItems=e,this.nFields=s},setSubscribedCMD:function(t,e,s,i,n){this.state=L.Subscribed,this.subId=t,this.cmdIdx=i,this.keyIdx=n,this.nItems=e,this.nFields=s},fetch_nFields:function(){return this.nFields},isInternal:function(){return this.m_internal},setInternal:function(){this.m_internal=!0},getItemName:function(t){return null!=this.items?this.items[t-1]:null},relate:function(t){this.manager=t},unrelate:function(t){this.manager==t&&(this.manager=null)},hasSnapshot:function(){return!(null==this.snapshot||this.snapshot==Fe.SnpNo)},getItemNameOrPos:function(t){return null!=this.items?this.items[t-1]:""+t},fireOnSubscription:function(t){ks.isInfoEnabled()&&ks.info("Subscription "+t+" added"),this.eventDispatcher.onSubscription()},fireOnUnsubscription:function(t){ks.isInfoEnabled()&&ks.info("Subscription "+t+" deleted"),this.eventDispatcher.onUnsubscription()},fireOnSubscriptionError:function(t,e,s){ks.isWarnEnabled()&&ks.warn("Subscription "+t+" failed: "+e+" - "+s),this.eventDispatcher.onSubscriptionError(e,s)},fireOnEndOfSnapshot:function(t,e){ks.isDebugEnabled()&&ks.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot ended"),this.eventDispatcher.onEndOfSnapshot(this.getItemName(t),t)},fireOnClearSnapshot:function(t,e){ks.isDebugEnabled()&&ks.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot cleared"),this.eventDispatcher.onClearSnapshot(this.getItemName(t),t)},fireOnLostUpdates:function(t,e,s){ks.isDebugEnabled()&&ks.debug("Subscription "+s+":"+this.getItemNameOrPos(t)+": lost "+e+" updates"),this.eventDispatcher.onItemLostUpdates(this.getItemName(t),t,e)},fireOnItemUpdate:function(t,e){ks.isDebugEnabled()&&ks.debug("Subscription "+e+":"+this.getItemNameOrPos(t.getItemPos())+" update: "+l.string(t)),this.eventDispatcher.onItemUpdate(t)},fireOnRealMaxFrequency:function(t,e){ks.isDebugEnabled()&&ks.debug("Subscription "+e+" real max frequency changed: "+l.string(t)),this.eventDispatcher.onRealMaxFrequency(Ye(t))},fireOnSubscriptionError2Level:function(t,e,s,i,n){ks.isWarnEnabled()&&ks.warn("Subscription "+i+":"+this.getItemNameOrPos(n)+":"+t+" failed: "+e+" - "+s),this.eventDispatcher.onCommandSecondLevelSubscriptionError(e,s,t)},fireOnLostUpdates2Level:function(t,e,s,i){ks.isDebugEnabled()&&ks.debug("Subscription "+s+":"+this.getItemNameOrPos(i)+":"+t+": lost "+e+" updates"),this.eventDispatcher.onCommandSecondLevelItemLostUpdates(e,t)},toString:function(){var t=te._new();return te.set(t,"mode",this.mode),te.set(t,"items",null!=this.items?l.string(this.items):this.group),te.set(t,"fields",null!=this.fields?l.string(this.fields):this.schema),te.set(t,"dataAdapter",this.dataAdapter),te.set(t,"requestedBufferSize",this.bufferSize),te.set(t,"requestedSnapshot",this.snapshot),te.set(t,"requestedMaxFrequency",this.requestedMaxFrequency),te.set(t,"selector",this.selector),te.set(t,"secondLevelFields",null!=this.fields2?l.string(this.fields2):this.schema2),te.set(t,"secondLevelDataAdapter",this.dataAdapter2),as.stringify(t.h)},__class__:N};var O=function(){};O.__name__=!0,O.__isInterface__=!0,O.prototype={__class__:O};var M=function(t){this.frozen=!1,this.onEvent=t};M.__name__=!0,M.__interfaces__=[O],M.newLoggingInstance=function(){var t=new M((function(t){qs.isWarnEnabled()&&qs.warn(l.string(t)+" event detected")}));return t.startListening(),t},M.prototype={handleFrozen:function(){this.frozen=!0,this.onEvent(me.Frozen)},handleResumed:function(){this.frozen=!1,this.onEvent(me.Resumed)},startListening:function(){m.get_supported()&&(window.addEventListener("freeze",fs(this,this.handleFrozen),{capture:!0}),window.addEventListener("resume",fs(this,this.handleResumed),{capture:!0}))},stopListening:function(){m.get_supported()&&(window.removeEventListener("freeze",fs(this,this.handleFrozen),{capture:!0}),window.removeEventListener("resume",fs(this,this.handleResumed),{capture:!0}))},__class__:M};var P=function(){};P.__name__=!0,P.__interfaces__=[S],P.prototype={__class__:P};var k=function(){};k.__name__=!0,k.__super__=P,k.prototype=n(P.prototype,{fatal:function(t,e){},error:function(t,e){},warn:function(t,e){},info:function(t,e){},debug:function(t,e){},trace:function(t,e){},isFatalEnabled:function(){return!1},isErrorEnabled:function(){return!1},isWarnEnabled:function(){return!1},isInfoEnabled:function(){return!1},isDebugEnabled:function(){return!1},isTraceEnabled:function(){return!1},__class__:k});var F=function(){};F.__name__=!0,F.prototype={acquire:function(){},release:function(){},synchronized:function(t){var e=null,s=null;try{s=t()}catch(t){e=g.caught(t)}if(null!=e)throw g.thrown(e);return s},__class__:F};var q=function(){};q.__name__=!0,q.getLogger=function(t){return q.lock.synchronized((function(){var e=q.logInstances.h[t];if(null==e){var s=new A(null==q.currentLoggerProvider?q.emptyLogger:q.currentLoggerProvider.getLogger(t));q.logInstances.h[t]=s,e=s}return e}))},q.setLoggerProvider=function(t){q.lock.synchronized((function(){q.currentLoggerProvider=t;for(var e=q.logInstances.h,s=Object.keys(e),i=s.length,n=0;n<i;){var r=s[n++];e[r].wrappedLogger=null==q.currentLoggerProvider?q.emptyLogger:q.currentLoggerProvider.getLogger(r)}}))},q.newLogger=function(t){return null==q.currentLoggerProvider?q.emptyLogger:q.currentLoggerProvider.getLogger(t)};var A=function(t){this.wrappedLogger=t};A.__name__=!0,A.__super__=P,A.prototype=n(P.prototype,{fatal:function(t,e){this.wrappedLogger.fatal(t,e)},error:function(t,e){this.wrappedLogger.error(t,e)},warn:function(t,e){this.wrappedLogger.warn(t,e)},info:function(t,e){this.wrappedLogger.info(t,e)},debug:function(t,e){this.wrappedLogger.debug(t,e)},trace:function(t,e){this.wrappedLogger.trace(t,e)},isFatalEnabled:function(){return this.wrappedLogger.isFatalEnabled()},isErrorEnabled:function(){return this.wrappedLogger.isErrorEnabled()},isWarnEnabled:function(){return this.wrappedLogger.isWarnEnabled()},isInfoEnabled:function(){return this.wrappedLogger.isInfoEnabled()},isDebugEnabled:function(){return this.wrappedLogger.isDebugEnabled()},isTraceEnabled:function(){return this.wrappedLogger.isTraceEnabled()},__class__:A});var W=function(){};W.__name__=!0,W.getClass=function(t){if(null==t)return null;if(t instanceof Array)return Array;var e=t.__class__;if(null!=e)return e;var s=W.__nativeClassName(t);return null!=s?W.__resolveNativeClass(s):null},W.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var s=typeof t;switch("function"==s&&(t.__name__||t.__ename__)&&(s="object"),s){case"function":return"<function>";case"object":if(t.__enum__){var n=i[t.__enum__].__constructs__[t._hx_index],r=n._hx_name;return n.__params__?(e+="\t",r+"("+function(s){for(var i=[],r=0,a=n.__params__;r<a.length;){var o=a[r];r+=1,i.push(W.__string_rec(t[o],e))}return i}().join(",")+")"):r}if(t instanceof Array){var a="[";e+="\t";for(var o=0,h=t.length;o<h;){var c=o++;a+=(c>0?",":"")+W.__string_rec(t[c],e)}return a+="]"}var l;try{l=t.toString}catch(o){return"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var u=t.toString();if("[object Object]"!=u)return u}a="{\n",e+="\t";var _=null!=t.hasOwnProperty,d=null;for(d in t)_&&!t.hasOwnProperty(d)||"prototype"!=d&&"__class__"!=d&&"__super__"!=d&&"__interfaces__"!=d&&"__properties__"!=d&&(2!=a.length&&(a+=", \n"),a+=e+d+" : "+W.__string_rec(t[d],e));return a+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},W.__interfLoop=function(t,e){for(;;){if(null==t)return!1;if(t==e)return!0;var s=t.__interfaces__;if(null!=s)for(var i=0,n=s.length;i<n;){var r=s[i++];if(r==e||W.__interfLoop(r,e))return!0}t=t.__super__}},W.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case vs:return"boolean"==typeof t;case ps:return null!=t;case gs:return"number"==typeof t;case ms:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(W.__downcastCheck(t,e))return!0}else if("object"==typeof e&&W.__isNativeObj(e)&&t instanceof e)return!0;return e==Ss&&null!=t.__name__||e==ys&&null!=t.__ename__||null!=t.__enum__&&i[t.__enum__]==e}},W.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&W.__interfLoop(W.getClass(t),e)},W.__cast=function(t,e){if(null==t||W.__instanceof(t,e))return t;throw g.thrown("Cannot cast "+l.string(t)+" to "+l.string(e))},W.__nativeClassName=function(t){var e=W.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},W.__isNativeObj=function(t){return null!=W.__nativeClassName(t)},W.__resolveNativeClass=function(e){return t[e]};var B=function(t,e){this.slw_m=.5,this.slw_hugeDelayMs=2e4,this.slw_maxAvgDelayMs=7e3,this.slw_avgDelayMs=0,this.slw_refTime=0,this.rec_clientProg=0,this.rec_serverProg=0,this.subscriptionManagers=new ce,this.messageManagers=new ee,this.sequenceMap=new as,this.disabledTransports=new be,this.suspendedTransports=new be,this.ctrl_connectTs=0,this.recoverTs=0,this.connectTs=0,this.m_nextSubId=0,this.m_nextReqId=0,this.m_status="DISCONNECTED",this.delayCounter=new Et,this.state=new st,this.client=t,this.lock=t.lock,this.details=t.connectionDetails,this.options=t.connectionOptions,this.wsFactory=fs(e,e.createWsClient),this.httpFactory=fs(e,e.createHttpClient),this.ctrlFactory=fs(e,e.createCtrlClient),this.timerFactory=fs(e,e.createTimer),this.randomGenerator=fs(e,e.randomMillis),this.reachabilityFactory=fs(e,e.createReachabilityManager),this.frz_pageLifecycleFactory=fs(e,e.createPageLifecycleFactory),this.clientEventDispatcher=t.eventDispatcher,this.switchRequest=new j(this),this.constrainRequest=new $(this),this.delayCounter.reset(this.options.retryDelay)};B.__name__=!0,B.prototype={disposeSession:function(){this.disposeWS(),this.disposeHTTP(),this.disposeCtrl(),this.details.setServerInstanceAddress(null),this.details.setSessionId(null),this.details.setServerSocketName(null),this.details.setClientIp(null),this.options.setRealMaxBandwidth(null),this.lastKnownClientIp=null,this.resetSequenceMap(),this.rec_serverProg=0,this.rec_clientProg=0,this.bw_lastReqId=null,this.bw_requestedMaxBandwidth=null,this.swt_lastReqId=null},disposeClient:function(){this.sessionId=null,this.enableAllTransports(),this.resetCurrentRetryDelay(),this.resetSequenceMap(),this.cause=null},evtExtConnect:function(){this.traceEvent("connect");var t,e=!0;100==this.state.s_m&&(B.frz_globalPageLifecycle.frozen?(qs.isWarnEnabled()&&qs.warn("connection requested while page is frozen"),this.cause="page.frozen",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=117,this.state.traceState(),e=this.evtExtConnect_NextRegion(),null!=(t=this.frz_pageLifecycle)&&t.startListening(),this.evtRetry(V.page_frozen)):(this.cause="api",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=101,this.state.traceState(),e=this.evtExtConnect_NextRegion(),null!=(t=this.frz_pageLifecycle)&&t.startListening(),this.evtSelectCreate())),e&&this.evtExtConnect_NextRegion()},evtExtConnect_NextRegion:function(){return this.evtExtConnect_NetworkReachabilityRegion()},evtExtConnect_NetworkReachabilityRegion:function(){var t=this;if(1400==this.state.s_nr){var e=new je(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(e),this.state.s_nr=1410,this.state.traceState(),this.nr_reachabilityManager.startListening((function(s){switch(s._hx_index){case 0:t.evtNetworkReachable(e);break;case 1:t.evtNetworkNotReachable(e)}}))}return!1},doInstallPageLifecycle:function(){var t=this;this.frz_pageLifecycle=this.frz_pageLifecycleFactory((function(e){switch(e._hx_index){case 0:t.evtPageFrozen();break;case 1:t.evtPageResumed()}}))},doUnistallPageLifecycle:function(){var t=this.frz_pageLifecycle;null!=t&&t.stopListening(),this.frz_pageLifecycle=null},evtPageFrozen:function(){switch(this.traceEvent("page.frozen"),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtRetryTimeout();break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(V.page_frozen);break;case 130:case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(V.page_frozen);break;case 150:var t=this.state.s_tr;if(null!=t)switch(t){case 210:this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.clear_w(),this.state.goto_m_from_session(117),this.exit_w(),this.evtEndSession(),this.evtRetry(V.page_frozen);break;case 220:case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_session(117),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(V.page_frozen);break;case 240:var e;if(500==(null!=(i=this.state.s_ws)?i.m:null))this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(V.page_frozen);else(i=!!(s=501==(null!=(e=this.state.s_ws)?e.m:null)||502==(null!=(e=this.state.s_ws)?e.m:null))||503==(null!=(s=this.state.s_ws)?s.m:null))&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(V.page_frozen));break;case 250:var s,i;(i=600==(null!=(s=this.state.s_wp)?s.m:null)||601==(null!=(s=this.state.s_wp)?s.m:null))?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_ws_to_m(),this.evtRetry(V.page_frozen)):602==(null!=(i=this.state.s_wp)?i.m:null)&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_wp_to_m(),this.evtRetry(V.page_frozen));break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_rec(117),this.exit_rec_to_m(),this.evtRetry(V.page_frozen);break;case 270:710==this.state.s_h?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hs(117),this.exit_hs_to_m(),this.evtRetry(V.page_frozen)):720==this.state.s_h&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hp(117),this.exit_hp_to_m(),this.evtRetry(V.page_frozen))}}},evtPageResumed:function(){this.traceEvent("page.resumed"),117==this.state.s_m&&(this.state.s_m=116,this.state.traceState(),this.evtSelectCreate())},evtNetworkNotReachable:function(t){Ps.isInfoEnabled()&&Ps.info(t+" is NOT reachable"),this.traceEvent("nr:network.not.reachable"),(1410==this.state.s_nr||1412==this.state.s_nr)&&(this.state.s_nr=1411,this.state.traceState())},evtNetworkReachable:function(t){Ps.isInfoEnabled()&&Ps.info(t+" is reachable"),this.traceEvent("nr:network.reachable"),1410==this.state.s_nr?(this.state.s_nr=1412,this.state.traceState()):1411==this.state.s_nr&&(this.state.s_nr=1412,this.state.traceState(),this.evtOnlineAgain())},evtOnlineAgain:function(){this.traceEvent("online.again"),112==this.state.s_m?(this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate()):1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtServerAddressChanged:function(){var t=this;switch(this.traceEvent("nr:serverAddress.changed"),this.state.s_nr){case 1410:case 1411:case 1412:var e=this.nr_reachabilityManager,s=new je(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(s),this.state.s_nr=1410,this.state.traceState(),null!=e&&e.stopListening(),this.nr_reachabilityManager.startListening((function(e){switch(e._hx_index){case 0:t.evtNetworkReachable(s);break;case 1:t.evtNetworkNotReachable(s)}}))}},evtExtDisconnect:function(t){switch(this.traceEvent("disconnect: cause="+l.string(t)),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtTerminate(t);break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 130:case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(t);break;case 220:case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_session(100),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtTerminate(t);break;case 240:var s;if(500==(null!=(n=this.state.s_ws)?n.m:null))this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t);else(n=!!(i=501==(null!=(s=this.state.s_ws)?s.m:null)||502==(null!=(s=this.state.s_ws)?s.m:null))||503==(null!=(i=this.state.s_ws)?i.m:null))&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t));break;case 250:var i,n;(n=600==(null!=(i=this.state.s_wp)?i.m:null)||601==(null!=(i=this.state.s_wp)?i.m:null))?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_ws_to_m(),this.evtTerminate(t)):602==(null!=(n=this.state.s_wp)?n.m:null)&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(t));break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(t);break;case 270:710==this.state.s_h?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(t)):720==this.state.s_h&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(t))}}},evtSelectCreate:function(){if(this.traceEvent("select.create"),101==this.state.s_m||116==this.state.s_m)switch(this.getBestForCreating()._hx_index){case 0:this.notifyStatus("CONNECTING"),this.openWS_Create(),this.state.s_m=120,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 1:this.notifyStatus("CONNECTING"),this.sendCreateHTTP(),this.state.s_m=130,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 2:this.notifyStatus("DISCONNECTED"),this.state.s_m=100,this.state.traceState(),this.evtTerminate(G.TC_otherError("Unable to select a transport"))}},evtWSOpen:function(){var t;this.traceEvent("ws.open"),120==this.state.s_m?(this.sendCreateWS(),this.state.s_m=121,this.state.traceState()):500==(null!=(t=this.state.s_ws)?t.m:null)?(this.sendBindWS_Streaming(),this.state.s_ws.m=501,this.state.traceState()):600==(null!=(t=this.state.s_wp)?t.m:null)&&(oe.sure(this.ws).send("wsok"),this.state.s_wp.m=601,this.state.traceState())},evtMessage:function(t){var e=!0;if(_.startsWith(t,"U,")){var s=mt(t);this.evtU(s.subId,s.itemIdx,s.values,t)}else if(_.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(dt(t.split(",")[1]));else if(_.startsWith(t,"PROBE"))this.evtPROBE();else if(_.startsWith(t,"LOOP"))this.evtLOOP(dt(t.split(",")[1]));else if(_.startsWith(t,"CONOK")){var i=t.split(",");this.evtCONOK(i[1],dt(i[2]),dt(i[3]),i[4])}else if(_.startsWith(t,"WSOK"))this.evtWSOK();else if(_.startsWith(t,"SERVNAME"))this.evtSERVNAME(t.split(",")[1]);else if(_.startsWith(t,"CLIENTIP"))this.evtCLIENTIP(t.split(",")[1]);else if(_.startsWith(t,"CONS")){var n=t.split(",")[1];switch(n){case"unlimited":this.evtCONS(Ue.BWUnlimited);break;case"unmanaged":this.evtCONS(Ue.BWUnmanaged);break;default:this.evtCONS(Ue.BWLimited(ft(n)))}}else if(_.startsWith(t,"MSGDONE")){"*"==(o=(i=t.split(","))[1])&&(o="UNORDERED_MESSAGES");var r=dt(i[2]),a=i[3];this.evtMSGDONE(o,r,""==a?"":gt(a))}else if(_.startsWith(t,"MSGFAIL")){var o;"*"==(o=(i=t.split(","))[1])&&(o="UNORDERED_MESSAGES"),this.evtMSGFAIL(o,dt(i[2]),dt(i[3]),gt(i[4]))}else if(_.startsWith(t,"REQERR"))i=t.split(","),this.evtREQERR(dt(i[1]),dt(i[2]),gt(i[3]));else if(_.startsWith(t,"PROG"))this.evtPROG(dt(t.split(",")[1]));else if(_.startsWith(t,"SUBOK"))i=t.split(","),this.evtSUBOK(dt(i[1]),dt(i[2]),dt(i[3]));else if(_.startsWith(t,"SUBCMD"))i=t.split(","),this.evtSUBCMD(dt(i[1]),dt(i[2]),dt(i[3]),dt(i[4]),dt(i[5]));else if(_.startsWith(t,"UNSUB"))this.evtUNSUB(dt(t.split(",")[1]));else if(_.startsWith(t,"CONF")){var h=dt((i=t.split(","))[1]);"unlimited"==i[2]?this.evtCONF(h,Be.RFreqUnlimited):this.evtCONF(h,Be.RFreqLimited(ft(i[2])))}else _.startsWith(t,"EOS")?(i=t.split(","),this.evtEOS(dt(i[1]),dt(i[2]))):_.startsWith(t,"CS")?(i=t.split(","),this.evtCS(dt(i[1]),dt(i[2]))):_.startsWith(t,"OV")?(i=t.split(","),this.evtOV(dt(i[1]),dt(i[2]),dt(i[3]))):_.startsWith(t,"NOOP")?this.evtNOOP():_.startsWith(t,"CONERR")?(i=t.split(","),this.evtCONERR(dt(i[1]),gt(i[2]))):_.startsWith(t,"END")?(i=t.split(","),this.evtEND(dt(i[1]),gt(i[2]))):_.startsWith(t,"ERROR")?(i=t.split(","),this.evtERROR(dt(i[1]),gt(i[2]))):_.startsWith(t,"SYNC")?this.evtSYNC(dt(t.split(",")[1])):e=!1;return e},evtCtrlMessage:function(t){if(_.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(dt(t.split(",")[1]));else if(_.startsWith(t,"REQERR")){var e=t.split(",");this.evtREQERR(dt(e[1]),dt(e[2]),gt(e[3]))}else _.startsWith(t,"ERROR")&&(e=t.split(","),this.evtERROR(dt(e[1]),gt(e[2])))},evtTransportTimeout:function(){switch(this.traceEvent("transport.timeout"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m115(V.ws_unavailable);break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(V.ws_timeout);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(V.http_timeout);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m111(V.http_error,t);break;case 150:if(null!=(s=this.state.s_tr))switch(s){case 220:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(V.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,V.http_timeout));break;case 230:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(V.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,V.http_error));break;case 240:if(null!=(s=null!=(e=this.state.s_ws)?e.m:null))switch(s){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:0==this.options.sessionRecoveryTimeout?(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(V.ws_unavailable)):(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,V.ws_unavailable));break;case 502:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(V.ws_timeout)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,V.ws_timeout))}break;case 250:if(null!=(s=null!=(e=this.state.s_wp)?e.m:null))switch(s){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(z.RRC_transport_timeout));break;case 270:var e,s;if(null!=(s=this.state.s_h)&&710==s&&null!=(s=null!=(e=this.state.s_hs)?e.m:null))switch(s){case 800:this.disableHTTP_Streaming(),this.cause="http.streaming.unavailable",this.state.s_hs.m=801,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtForcePolling(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 801:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(V.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,V.http_timeout))}}}},evtTransportError:function(){switch(this.traceEvent("transport.error"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(V.ws_unavailable),this.evtRetryTimeout();break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(V.ws_error,t),this.schedule_evtRetryTimeout(t);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(V.http_error,t),this.schedule_evtRetryTimeout(t);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(V.http_error,t),this.schedule_evtRetryTimeout(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(V.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.clear_w(),this.state.s_tr=260,this.state.s_rec=1e3,this.state.traceState(),this.exit_w(),this.entry_rec(t,V.ws_error));break;case 220:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(V.http_error,t),this.schedule_evtRetryTimeout(t)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,V.http_error));break;case 230:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(V.http_error,t),this.schedule_evtRetryTimeout(t)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,V.http_error));break;case 240:switch(oe.sure(this.state.s_ws).m){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:0==this.options.sessionRecoveryTimeout?(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(V.ws_unavailable)):(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,V.ws_unavailable));break;case 502:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(V.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.cancel_evtTransportTimeout(),this.entry_rec(t,V.ws_error));break;case 503:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(V.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,V.ws_error))}break;case 250:switch(oe.sure(this.state.s_wp).m){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 602:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(V.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,V.ws_error))}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(z.RRC_transport_error));break;case 270:switch(oe.sure(this.state.s_h)){case 710:switch(oe.sure(this.state.s_hs).m){case 800:case 801:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(V.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,V.http_error));break;case 802:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(V.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,V.http_error))}break;case 720:switch(oe.sure(this.state.s_hp).m){case 900:case 901:case 902:case 903:case 904:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(V.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,V.http_error))}}}}},evtIdleTimeout:function(){if(this.traceEvent("idle.timeout"),null==(i=null!=(s=this.state.s_wp)?s.p:null))e=!1;else switch(i){case 610:case 611:case 613:e=!0;break;default:e=!1}if(e)if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.idle.timeout",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(V.idle_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.idle.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,V.idle_timeout)}else{var e,s,i;if(null==(i=null!=(s=this.state.s_hp)?s.m:null))e=!1;else switch(i){case 900:case 901:case 903:e=!0;break;default:e=!1}e&&(0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.idle.timeout",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(V.idle_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.idle.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,V.idle_timeout)))}},evtPollingTimeout:function(){var t;this.traceEvent("polling.timeout"),612==(null!=(t=this.state.s_wp)?t.p:null)?(this.sendBindWS_Polling(),this.state.s_wp.p=613,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(Le.plus(oe.sure(this.idleTimeout),this.options.retryDelay))):902==(null!=(t=this.state.s_hp)?t.m:null)&&(this.sendBindHTTP_Polling(),this.state.s_hp.m=903,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(Le.plus(oe.sure(this.idleTimeout),this.options.retryDelay)))},evtKeepaliveTimeout:function(){var t;this.traceEvent("keepalive.timeout"),310==(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=311,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):520==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=521,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):820==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=821,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout))},evtStalledTimeout:function(){var t;this.traceEvent("stalled.timeout"),311==(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=312,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):521==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=522,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):821==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=822,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout))},evtReconnectTimeout:function(){var t;if(this.traceEvent("reconnect.timeout"),312==(null!=(t=this.state.s_w)?t.k:null))if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_w(113),this.exit_w_to_m(),this.entry_m113(V.stalled_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled";var e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_w(),this.exit_w(),this.entry_rec(e,V.stalled_timeout)}else 522==(null!=(t=this.state.s_ws)?t.k:null)?0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(V.stalled_timeout)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled",e=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(e,V.stalled_timeout)):822==(null!=(t=this.state.s_hs)?t.k:null)&&(0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.stalled",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(V.stalled_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.stalled",e=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(e,V.stalled_timeout)))},evtRestartKeepalive:function(){var t;this.traceEvent("restart.keepalive"),null!=(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=310,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(oe.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=520,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(oe.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=820,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(oe.sure(this.keepaliveInterval)))},evtWSOK:function(){switch(this.traceEvent("WSOK"),Ds.isDebugEnabled()&&Ds.debug("WSOK"),this.state.s_m){case 121:this.state.s_m=122,this.state.traceState();break;case 150:if(null!=(e=this.state.s_tr))switch(e){case 240:null!=(e=null!=(t=this.state.s_ws)?t.m:null)&&501==e&&(this.state.s_ws.m=502,this.state.traceState());break;case 250:var t,e;null!=(e=null!=(t=this.state.s_wp)?t.m:null)&&601==e&&(this.sendBindWS_FirstPolling(),this.state.s_wp.m=602,this.state.s_wp.p=610,this.state.s_wp.c=620,this.state.s_wp.s=630,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtIdleTimeout(Le.plus(oe.sure(this.idleTimeout),this.options.retryDelay)))}}},evtCONERR:function(t,e){this.traceEvent("CONERR"),Ds.isDebugEnabled()&&Ds.debug("CONERR "+t+" "+e);var s=V.standardError(t,e),i=G.TC_standardError(t,e);if(122==this.state.s_m)switch(t){case 5:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t;var n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(130==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(140==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else{var r,a;if(502==(null!=(r=this.state.s_ws)?r.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else if(r=610==(null!=(a=this.state.s_wp)?a.p:null)||613==(null!=(a=this.state.s_wp)?a.p:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else if(r=800==(null!=(a=this.state.s_hs)?a.m:null)||801==(null!=(a=this.state.s_hs)?a.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else if(r=900==(null!=(a=this.state.s_hp)?a.m:null)||903==(null!=(a=this.state.s_hp)?a.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(1001==this.state.s_rec)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.conerr."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}},evtEND:function(t,e){this.traceEvent("END"),Ds.isDebugEnabled()&&Ds.debug("END "+t+" "+e);var s=V.standardError(t,e),i=G.TC_standardError(t,e);if(300==(null!=(a=this.state.s_w)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t;var n=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(V.standardError(t,e),n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(i)}else if(502==(null!=(a=this.state.s_ws)?a.m:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else if(510==(null!=(a=this.state.s_ws)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else if(a=610==(null!=(r=this.state.s_wp)?r.p:null)||613==(null!=(r=this.state.s_wp)?r.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else if(611==(null!=(a=this.state.s_wp)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else if(a=800==(null!=(r=this.state.s_hs)?r.m:null)||801==(null!=(r=this.state.s_hs)?r.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else if(810==(null!=(a=this.state.s_hs)?a.p:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else{var r,a;if(a=900==(null!=(r=this.state.s_hp)?r.m:null)||903==(null!=(r=this.state.s_hp)?r.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(V.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(901==(null!=(a=this.state.s_hp)?a.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(1001==this.state.s_rec)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.end."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}},evtERROR:function(t,e){this.traceEvent("ERROR"),Ds.isDebugEnabled()&&Ds.debug("ERROR "+t+" "+e);var s,i=G.TC_standardError(t,e);300==(null!=(s=this.state.s_w)?s.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(i)):510==(null!=(s=this.state.s_ws)?s.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)):620==(null!=(s=this.state.s_wp)?s.c:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)):1102==this.state.s_ctrl&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(i))},evtREQOK_withoutReqId:function(){this.traceEvent("REQOK"),Ds.isDebugEnabled()&&Ds.debug("REQOK"),1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState())},evtREQOK:function(t){this.traceEvent("REQOK"),Ds.isDebugEnabled()&&Ds.debug("REQOK "+t);var e=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1303,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),e=this.evtREQOK_TransportRegion(t),this.evtCheckBW()):e=this.evtREQOK_Forward(t),e&&this.evtREQOK_TransportRegion(t)},evtREQOK_Forward:function(t){return!0},evtREQOK_TransportRegion:function(t){var e;return 300==(null!=(e=this.state.s_w)?e.p:null)?(this.state.s_w.p=300,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):510==(null!=(e=this.state.s_ws)?e.p:null)?(this.state.s_ws.p=510,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):620==(null!=(e=this.state.s_wp)?e.c:null)?(this.state.s_wp.c=620,this.state.traceState(),this.doREQOK(t)):1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState(),this.doREQOK(t)),!1},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),Ds.isDebugEnabled()&&Ds.debug("REQERR "+t+" "+e+" "+s);var i=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1301,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtCheckBW()):i=this.evtREQERR_Forward(t,e,s),i&&this.evtREQERR_TransportRegion(t,e,s)},evtREQERR_Forward:function(t,e,s){return!0},evtREQERR_TransportRegion:function(t,e,s){var i,n=V.standardError(e,s),r=G.TC_standardError(e,s);if(300==(null!=(i=this.state.s_w)?i.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e;var a=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(V.standardError(e,s),a),this.schedule_evtRetryTimeout(a);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(r);break;default:this.state.s_w.p=300,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else if(510==(null!=(i=this.state.s_ws)?i.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e+")",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(r);break;default:this.state.s_ws.p=510,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else if(620==(null!=(i=this.state.s_wp)?i.c:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(r);break;default:this.state.s_wp.c=620,this.state.traceState(),this.doREQERR(t,e,s)}else if(1102==this.state.s_ctrl)switch(e){case 20:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.reqerr."+e,this.state.goto_m_from_ctrl(113),this.exit_ctrl_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(r);break;default:this.state.s_ctrl=1102,this.state.traceState(),this.doREQERR(t,e,s)}return!1},evtPROG:function(t){this.traceEvent("PROG");var e=V.prog_mismatch(this.rec_serverProg,t);if(Ds.isDebugEnabled()&&Ds.debug("PROG "+t),300==(null!=(s=this.state.s_w)?s.p:null))t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_w.p=300,this.state.traceState(),this.evtRestartKeepalive());else if(220==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=220,this.state.traceState());else if(230==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=230,this.state.traceState());else{var s;510==(null!=(s=this.state.s_ws)?s.p:null)?t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(e)):(this.state.s_ws.p=510,this.state.traceState(),this.evtRestartKeepalive()):611==(null!=(s=this.state.s_wp)?s.p:null)?t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(e)):(this.state.s_wp.p=611,this.state.traceState()):810==(null!=(s=this.state.s_hs)?s.p:null)?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(e)):(this.state.s_hs.p=810,this.state.traceState(),this.evtRestartKeepalive()):901==(null!=(s=this.state.s_hp)?s.m:null)?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(e)):(this.state.s_hp.m=901,this.state.traceState()):1001==this.state.s_rec&&(t>this.rec_clientProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(e)):(this.state.s_rec=1001,this.state.traceState(),this.doPROG(t)))}},evtLOOP:function(t){if(this.traceEvent("LOOP"),Ds.isDebugEnabled()&&Ds.debug("LOOP "+t),300==(null!=(e=this.state.s_w)?e.p:null))this.closeWS(),this.cause="ws.loop",this.state.clear_w(),this.state.s_tr=200,this.state.traceState(),this.exit_w(),this.evtSwitchTransport();else if(220==this.state.s_tr)this.closeHTTP(),this.cause="http.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else if(230==this.state.s_tr)this.closeHTTP(),this.cause="ttl.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else{var e;510==(null!=(e=this.state.s_ws)?e.p:null)?(this.closeWS(),this.cause="ws.loop",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.exit_ws(),this.evtSwitchTransport()):611==(null!=(e=this.state.s_wp)?e.p:null)?this.isSwitching()?(this.closeWS(),this.cause="ws.loop",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()):(this.doLOOP(t),this.state.s_wp.p=612,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):810==(null!=(e=this.state.s_hs)?e.p:null)?(this.closeHTTP(),this.cause="http.loop",this.state.s_hs.p=811,this.state.traceState(),this.evtSwitchTransport()):901==(null!=(e=this.state.s_hp)?e.m:null)?this.isSwitching()?(this.closeHTTP(),this.state.s_hp.m=904,this.state.traceState(),this.cancel_evtIdleTimeout(),this.evtSwitchTransport()):(this.doLOOP(t),this.closeHTTP(),this.state.s_hp.m=902,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):1001==this.state.s_rec&&(this.closeHTTP(),this.cause="recovery.loop",this.state.goto_200_from_rec(),this.exit_rec(),this.evtSwitchTransport())}},evtCONOK:function(t,e,s,i){if(this.traceEvent("CONOK"),Ds.isDebugEnabled()&&Ds.debug("CONOK "+t+" "+e+" "+s+" "+i),122==this.state.s_m)this.doCONOK_CreateWS(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_m=150,this.state.s_tr=210,this.state.s_w=new J(300,310,340),this.state.s_rhb=320,this.state.s_slw=330,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.evtStartSession(),this.schedule_evtKeepaliveTimeout(oe.sure(this.keepaliveInterval)),this.evtSelectRhb(),this.evtCheckTransport(),this.evtCheckBW();else if(130==this.state.s_m)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=220,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else if(140==this.state.s_m)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=230,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else{var n;502==(null!=(n=this.state.s_ws)?n.m:null)?(this.doCONOK_BindWS_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_ws.m=503,this.state.s_ws.p=510,this.state.s_ws.k=520,this.state.s_ws.s=550,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtKeepaliveTimeout(oe.sure(this.keepaliveInterval)),this.evtSelectRhb()):610==(null!=(n=this.state.s_wp)?n.p:null)?(this.doCONOK_BindWS_Polling(t,e,s,i),this.notifyStatus("CONNECTED:WS-POLLING"),this.state.s_wp.p=611,this.state.traceState()):613==(null!=(n=this.state.s_wp)?n.p:null)?(this.doCONOK_BindWS_Polling(t,e,s,i),this.state.s_wp.p=611,this.state.traceState()):800==(null!=(n=this.state.s_hs)?n.m:null)||801==(null!=(n=this.state.s_hs)?n.m:null)?(this.doCONOK_BindHTTP_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-STREAMING"),this.state.s_hs.m=802,this.state.s_hs.p=810,this.state.s_hs.k=820,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.schedule_evtKeepaliveTimeout(oe.sure(this.keepaliveInterval)),this.evtSelectRhb()):900==(null!=(n=this.state.s_hp)?n.m:null)?(this.doCONOK_BindHTTP_Polling(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-POLLING"),this.state.s_hp.m=901,this.state.traceState()):903==(null!=(n=this.state.s_hp)?n.m:null)&&(this.doCONOK_BindHTTP_Polling(t,e,s,i),this.state.s_hp.m=901,this.state.traceState())}},evtSERVNAME:function(t){this.traceEvent("SERVNAME"),Ds.isDebugEnabled()&&Ds.debug("SERVNAME "+t),this.state.inPushing()&&(this.doSERVNAME(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCLIENTIP:function(t){this.traceEvent("CLIENTIP"),Ds.isDebugEnabled()&&Ds.debug("CLIENTIP "+t),this.state.inPushing()&&(this.doCLIENTIP(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCONS:function(t){this.traceEvent("CONS"),Ds.isDebugEnabled()&&Ds.debug("CONS "+l.string(t)),this.state.inPushing()&&(this.doCONS(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtPROBE:function(){this.traceEvent("PROBE"),Ds.isDebugEnabled()&&Ds.debug("PROBE"),this.clientEventDispatcher.onServerKeepalive(),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtNOOP:function(){this.traceEvent("NOOP"),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtSYNC:function(t){this.traceEvent("SYNC"),Ds.isDebugEnabled()&&Ds.debug("SYNC "+t);var e,s,i=!0;(s=300==(null!=(e=this.state.s_w)?e.p:null)||510==(null!=(e=this.state.s_ws)?e.p:null),!s&&810!=(null!=(s=this.state.s_hs)?s.p:null))?(!!(s=220==this.state.s_tr||230==this.state.s_tr||611==(null!=(e=this.state.s_wp)?e.p:null))||901==(null!=(s=this.state.s_hp)?s.m:null)||1001==this.state.s_rec)&&(i=this.evtSYNC_PushingRegion(t)):(i=this.evtSYNC_PushingRegion(t),this.evtRestartKeepalive());i&&this.evtSYNC_PushingRegion(t)},evtSYNC_PushingRegion:function(t){var e=1e3*t;if(null!=this.state.s_slw){var s=this.state.s_slw;if(null!=s)switch(s){case 330:this.doSYNC(e),this.state.s_slw=331,this.state.traceState();break;case 331:var i=this.doSYNC_G(e);this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i);break;case 333:i=this.doSYNC_NG(e),this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i)}}return!1},evtMSGDONE:function(t,e,s){this.traceEvent("MSGDONE"),Ds.isDebugEnabled()&&Ds.debug("MSGDONE "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doMSGDONE(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMSGFAIL:function(t,e,s,i){this.traceEvent("MSGFAIL"),Ds.isDebugEnabled()&&Ds.debug("MSGFAIL "+t+" "+e+" "+s+" "+i),this.state.inPushing()&&(this.isFreshData()?(this.doMSGFAIL(t,e,s,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtU:function(t,e,s,i){this.traceEvent("U"),Ds.isDebugEnabled()&&Ds.debug(""+i),this.state.inPushing()&&(this.isFreshData()?(this.doU(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBOK:function(t,e,s){this.traceEvent("SUBOK"),Ds.isDebugEnabled()&&Ds.debug("SUBOK "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doSUBOK(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBCMD:function(t,e,s,i,n){this.traceEvent("SUBCMD"),Ds.isDebugEnabled()&&Ds.debug("SUBCMD "+t+" "+e+" "+s+" "+i+" "+n),this.state.inPushing()&&(this.isFreshData()?(this.doSUBCMD(t,e,s,i,n),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtUNSUB:function(t){this.traceEvent("UNSUB"),Ds.isDebugEnabled()&&Ds.debug("UNSUB "+t),this.state.inPushing()&&(this.isFreshData()?(this.doUNSUB(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtEOS:function(t,e){this.traceEvent("EOS"),Ds.isDebugEnabled()&&Ds.debug("EOS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doEOS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCS:function(t,e){this.traceEvent("CS"),Ds.isDebugEnabled()&&Ds.debug("CS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doCS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtOV:function(t,e,s){this.traceEvent("OV"),Ds.isDebugEnabled()&&Ds.debug("OV "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doOV(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCONF:function(t,e){this.traceEvent("CONF"),Ds.isDebugEnabled()&&Ds.debug("CONF "+t+" "+l.string(e)),this.state.inPushing()&&(this.isFreshData()?(this.doCONF(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCheckAvg:function(t){if(this.traceEvent("check.avg"),332==this.state.s_slw)switch(t._hx_index){case 0:this.state.s_slw=331,this.state.traceState();break;case 1:this.state.s_slw=333,this.state.traceState();break;case 2:this.disableStreaming(),this.cause="slow",this.state.s_slw=334,this.state.traceState(),this.evtForcePolling()}},evtSendPendingControls:function(){this.traceEvent("send.pending.controls");var t,e=this.getPendingControls();340!=(null!=(t=this.state.s_w)?t.s:null)||h.empty(e)?550!=(null!=(t=this.state.s_ws)?t.s:null)||h.empty(e)?630!=(null!=(t=this.state.s_wp)?t.s:null)||h.empty(e)||(this.sendPengingControlsWS(e),this.state.s_wp.s=630,this.state.traceState()):(this.sendPengingControlsWS(e),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):(this.sendPengingControlsWS(e),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat())},evtSendPendingMessages:function(){var t;this.traceEvent("send.pending.messages"),340==(null!=(t=this.state.s_w)?t.s:null)&&h.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesWS(),this.state.s_w.s=340,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)&&h.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesWS(),this.state.s_ws.s=550,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):630==(null!=(t=this.state.s_wp)?t.s:null)&&h.exists(this.messageManagers,(function(t){return t.isPending()}))&&(this.sendPendingMessagesWS(),this.state.s_wp.s=630,this.state.traceState(),this.genAckMessagesWS())},evtSelectRhb:function(){this.traceEvent("select.rhb"),320==this.state.s_rhb&&(0==this.rhb_grantedInterval?0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<oe.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(oe.sure(this.rhb_currentInterval))))},evtExtSetReverseHeartbeatInterval:function(){if(this.traceEvent("setReverseHeartbeatInterval"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 321:0!=this.options.reverseHeartbeatInterval&&(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval));break;case 322:0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState(),this.cancel_evtRhbTimeout()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState());break;case 323:this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<oe.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState()):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState())}}},evtRestartHeartbeat:function(){if(this.traceEvent("restart.heartbeat"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 322:this.state.s_rhb=322,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(oe.sure(this.rhb_currentInterval));break;case 323:this.state.s_rhb=323,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(oe.sure(this.rhb_currentInterval));break;case 324:0==this.rhb_grantedInterval?0!=this.options.reverseHeartbeatInterval?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.state.s_rhb=321,this.state.traceState()):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<oe.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(oe.sure(this.rhb_currentInterval)))}}},evtRhbTimeout:function(){this.traceEvent("rhb.timeout"),(322==this.state.s_rhb||323==this.state.s_rhb)&&(this.state.s_rhb=324,this.state.traceState(),this.cancel_evtRhbTimeout(),this.evtSendHeartbeat())},evtDisposeCtrl:function(){this.traceEvent("du:dispose.ctrl"),this.disposeCtrl()},evtStartRecovery:function(){this.traceEvent("start.recovery"),1e3==this.state.s_rec&&(this.recoverTs=a.now()/1e3,this.state.s_rec=1e3,this.state.traceState())},evtRecoveryTimeout:function(){this.traceEvent("recovery.timeout"),1e3==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRecoveryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtCheckRecoveryTimeout:function(t){if(this.traceEvent("check.recovery.timeout"),1002==this.state.s_rec){var e=this.options.retryDelay;if(Te.plus(this.connectTs,e)<Te.plus(this.recoverTs,this.options.sessionRecoveryTimeout)){this.cause="recovery.error";var s=Te.minus(a.now()/1e3,this.connectTs),i=e>we.toMillis(s)?Le.minus(e,we.toMillis(s)):Le.ZERO;this.state.s_rec=1003,this.state.traceState(),Os.isErrorEnabled()&&(i>0?Os.isErrorEnabled()&&Os.error("Retrying recovery in "+i+"ms. Cause: "+l.string(t)):Os.isErrorEnabled()&&Os.error("Retrying recovery. Cause: "+l.string(t))),this.schedule_evtRetryTimeout(i)}else this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.timeout",this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(V.recovery_timeout)}},evtCreate:function(){this.traceEvent("du:create"),(20==this.state.s_du||23==this.state.s_du)&&(this.state.s_du=21,this.state.traceState())},evtCheckTransport:function(){if(this.traceEvent("check.transport"),1300==this.state.s_swt)if(220==this.state.s_tr||230==this.state.s_tr||260==this.state.s_tr)this.state.s_swt=1301,this.state.traceState();else{var t=this.getBestForBinding();t==H.BFB_ws_streaming&&(210==this.state.s_tr||240==this.state.s_tr)||t==H.BFB_http_streaming&&270==this.state.s_tr&&710==this.state.s_h||t==H.BFB_ws_polling&&250==this.state.s_tr||t==H.BFB_http_polling&&270==this.state.s_tr&&720==this.state.s_h?(this.state.s_swt=1301,this.state.traceState()):(this.state.s_swt=1302,this.state.traceState(),this.evtSendControl(oe.sure(this.switchRequest)))}},evtCheckBW:function(){this.traceEvent("check.bw"),1200==this.state.s_bw&&(this.bw_requestedMaxBandwidth!=this.options.requestedMaxBandwidth&&this.options.realMaxBandwidth!=Ue.BWUnmanaged?(this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth,this.state.s_bw=1202,this.state.traceState(),this.evtSendControl(oe.sure(this.constrainRequest))):(this.state.s_bw=1201,this.state.traceState()))},evtCheckCtrlRequests:function(){if(this.traceEvent("check.ctrl.requests"),1100==this.state.s_ctrl){var t=this.getPendingControls();h.empty(t)?h.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):324==this.state.s_rhb?(this.sendHeartbeatHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):(this.state.s_ctrl=1101,this.state.traceState()):(this.sendPendingControlsHTTP(t),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay))}},evtCtrlDone:function(){this.traceEvent("ctrl.done"),1102==this.state.s_ctrl&&(this.closeCtrl(),this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtCtrlError:function(){if(this.traceEvent("ctrl.error"),1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}},evtCtrlTimeout:function(){if(this.traceEvent("ctrl.timeout"),null!=this.state.s_ctrl)if(1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}else 1103==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtSendControl:function(t){var e;this.traceEvent("send.control"),340==(null!=(e=this.state.s_w)?e.s:null)?(this.sendControlWS(t),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendControlWS(t),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendControlWS(t),this.state.s_wp.s=630,this.state.traceState()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSendHeartbeat:function(){var t;this.traceEvent("send.heartbeat"),340==(null!=(t=this.state.s_w)?t.s:null)?(this.sendHeartbeatWS(),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)?(this.sendHeartbeatWS(),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtStartSession:function(){this.traceEvent("du:start.session"),Os.isInfoEnabled()&&Os.info("Starting new session: "+this.sessionId),21==this.state.s_du&&(this.state.s_du=22,this.state.traceState())},evtEndSession:function(){Os.isInfoEnabled()&&Os.info("Destroying session: "+this.sessionId)},evtRetry:function(t,e){this.traceEvent("du:retry"),Os.isErrorEnabled()&&(null!=e&&e>0?Os.isErrorEnabled()&&Os.error("Retrying connection in "+e+"ms. Cause: "+Y(t)):Os.isErrorEnabled()&&Os.error("Retrying connection. Cause: "+Y(t)));var s=!0;switch(this.state.s_du){case 21:this.resetSequenceMap(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}s&&this.evtRetry_NextRegion()},evtRetry_NextRegion:function(){return!1},evtTerminate:function(t){if(this.traceEvent("du:terminate"),Os.isInfoEnabled()&&2==t._hx_index&&Os.isInfoEnabled()&&Os.info("Disconnected. Cause: Requested by user"),Os.isErrorEnabled())switch(t._hx_index){case 0:Os.isErrorEnabled()&&Os.error("Disconnected. Cause: "+t.code+" - "+t.msg);break;case 1:Os.isErrorEnabled()&&Os.error("Disconnected. Cause: "+t.error)}var e=!0;switch(this.state.s_du){case 20:case 21:case 23:this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}e&&this.evtTerminate_NextRegion()},evtTerminate_NextRegion:function(){return this.evtTerminate_NetworkReachabilityRegion()},evtTerminate_NetworkReachabilityRegion:function(){switch(this.state.s_nr){case 1410:case 1411:case 1412:var t=this.nr_reachabilityManager;this.nr_reachabilityManager=null,this.state.s_nr=1400,this.state.traceState(),null!=t&&t.stopListening()}return!1},evtRetryTimeout:function(){switch(this.traceEvent("retry.timeout"),this.state.s_m){case 110:this.notifyStatus("CONNECTING"),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 111:this.notifyStatus("CONNECTING"),this.delayCounter.increase(),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 112:this.delayCounter.increase(),this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 113:this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 115:this.state.s_m=116,this.state.traceState(),this.evtSelectCreate();break;case 150:1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))}},evtExtSetForcedTransport:function(){this.traceEvent("setForcedTransport"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtExtSetRequestedMaxBandwidth:function(){this.traceEvent("setRequestedMaxBandwidth"),1201==this.state.s_bw&&(this.state.s_bw=1200,this.state.traceState(),this.evtCheckBW())},evtForceSlowing:function(){this.traceEvent("force.slowing"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtForcePolling:function(){this.traceEvent("force.polling"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtSendMessage:function(t){var e;this.traceEvent("send.message"),340==(null!=(e=this.state.s_w)?e.s:null)?(this.sendMsgWS(t),this.state.s_w.s=340,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendMsgWS(t),this.state.s_ws.s=550,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendMsgWS(t),this.state.s_wp.s=630,this.state.traceState(),t.evtWSSent()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSwitchTransport:function(){this.traceEvent("switch.transport");var t=!0;1302!=this.state.s_swt&&1303!=this.state.s_swt||(this.state.s_swt=1300,this.state.traceState(),t=this.evtSwitchTransport_forwardToTransportRegion(),this.evtCheckTransport()),t&&this.evtSwitchTransport_forwardToTransportRegion()},evtSwitchTransport_forwardToTransportRegion:function(){var t,e=G.TC_otherError("Selected transport "+this.options.forcedTransport+" is not available");if(200==this.state.s_tr)switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_session(100),this.evtEndSession(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.s_tr=240,this.state.s_ws=new Z(500),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.s_tr=250,this.state.s_wp=new X(600),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_tr=270,this.state.s_h=710,this.state.s_hs=new tt(800),this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_tr=270,this.state.s_h=720,this.state.s_hp=new et(900),this.state.s_rhb=320,this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtIdleTimeout(Le.plus(oe.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(811==(null!=(t=this.state.s_hs)?t.p:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new Z(500),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new X(600),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_hs=new tt(800),this.state.traceState(),this.exit_hs(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.clear_hs(),this.state.s_h=720,this.state.s_hp=new et(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hs(),this.schedule_evtIdleTimeout(Le.plus(oe.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(904==(null!=(t=this.state.s_hp)?t.m:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new Z(500),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new X(600),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.clear_hp(),this.state.s_h=710,this.state.s_hs=new tt(800),this.state.traceState(),this.exit_hp(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_hp=new et(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hp(),this.schedule_evtIdleTimeout(Le.plus(oe.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}return!1},onFreshData:function(){if(this.rec_serverProg!=this.rec_clientProg)throw new ne("Assertion failure: rec_serverProg == rec_clientProg");this.rec_serverProg+=1,this.rec_clientProg+=1},onStaleData:function(){if(this.rec_serverProg>=this.rec_clientProg)throw new ne("Assertion failure: rec_serverProg < rec_clientProg");this.rec_serverProg+=1},isFreshData:function(){return this.rec_serverProg==this.rec_clientProg},openWS:function(t,e){var s=this,i=function(t){Ks((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtWSOpen()}))}))},n=function(t,e){Ks((function(){s.lock.synchronized((function(){if(!t.isDisposed())try{s.evtMessage(e)}catch(t){var i=g.caught(t);Os.isErrorEnabled()&&Os.error(i.get_message()+"\n"+i.details()),s.evtExtDisconnect(G.TC_standardError(61,i.get_message()))}}))}))},r=function(t,e){Ks((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtTransportError()}))}))};return this.wsFactory(t,e,i,n,r)},openWS_Create:function(){this.connectTs=a.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.ws=this.openWS(je.build(this.serverInstanceAddress,"lightstreamer"),this.options.httpExtraHeaders)},openWS_Bind:function(){this.connectTs=a.now()/1e3,this.ws=this.openWS(je.build(oe.sure(this.serverInstanceAddress),"lightstreamer"),this.getHeadersForRequestOtherThanCreate())},sendCreateWS:function(){var t=new ye;this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(Is),null!=this.sessionId&&t.LS_old_session(this.sessionId),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session create: "+l.string(t)),null!=this.details.password&&t.LS_password(this.details.password),oe.sure(this.ws).send("wsok"),oe.sure(this.ws).send("create_session\r\n"+t.getEncodedString())},sendBindWS_Streaming:function(){var t=new ye;t.LS_session(oe.sure(this.sessionId)),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session bind: "+l.string(t)),oe.sure(this.ws).send("wsok"),oe.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_FirstPolling:function(){var t=new ye;t.LS_session(oe.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session bind: "+l.string(t)),oe.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_Polling:function(){var t=new ye;t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session bind: "+l.string(t)),oe.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendDestroyWS:function(t){null==t&&(t="api");var e=new ye;e.LS_reqId(this.generateFreshReqId()),e.LS_op("destroy"),e.LS_close_socket(!0),e.LS_cause(t),Ds.isInfoEnabled()&&Ds.info("Sending session destroy: "+l.string(e)),oe.sure(this.ws).send("control\r\n"+e.getEncodedString())},sendHttpRequest:function(t,e,s){var i=this,n=function(t,e){Ks((function(){i.lock.synchronized((function(){if(!t.isDisposed())try{i.evtMessage(e)}catch(t){var s=g.caught(t);Os.isErrorEnabled()&&Os.error(s.get_message()+"\n"+s.details()),i.evtExtDisconnect(G.TC_standardError(61,s.get_message()))}}))}))},r=function(t,e){Ks((function(){i.lock.synchronized((function(){t.isDisposed()||i.evtTransportError()}))}))};return this.httpFactory(t,e.getEncodedString(),s,n,r,(function(t){}))},sendCreateHTTP:function(){var t=new ye;t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(Is),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session create: "+l.string(t)),null!=this.details.password&&t.LS_password(this.details.password),this.connectTs=a.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(je.build(this.serverInstanceAddress,"/lightstreamer"+xs+"/create_session.txt?LS_protocol="+ws),t,this.options.httpExtraHeaders)},sendBindHTTP_Streaming:function(){var t=new ye;t.LS_session(oe.sure(this.sessionId)),t.LS_content_length(this.options.contentLength),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session bind: "+l.string(t)),this.connectTs=a.now()/1e3,this.http=this.sendHttpRequest(je.build(oe.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+ws),t,this.getHeadersForRequestOtherThanCreate())},sendBindHTTP_Polling:function(){var t=new ye;t.LS_session(oe.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),this.rhb_grantedInterval=0,Ds.isInfoEnabled()&&Ds.info("Sending session bind: "+l.string(t)),this.connectTs=a.now()/1e3,this.http=this.sendHttpRequest(je.build(oe.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+ws),t,this.getHeadersForRequestOtherThanCreate())},sendCreateTTL:function(){var t=new ye;t.LS_ttl_millis("unlimited"),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(Is),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session create: "+l.string(t)),null!=this.details.password&&t.LS_password(this.details.password),this.connectTs=a.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(je.build(this.serverInstanceAddress,"/lightstreamer"+xs+"/create_session.txt?LS_protocol="+ws),t,this.options.httpExtraHeaders)},sendRecovery:function(){var t=new ye;t.LS_session(oe.sure(this.sessionId)),t.LS_recovery_from(this.rec_clientProg),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending session recovery: "+l.string(t)),this.connectTs=a.now()/1e3,this.http=this.sendHttpRequest(je.build(oe.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+ws),t,this.getHeadersForRequestOtherThanCreate())},disposeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},closeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},suspendWS_Streaming:function(){Os.isWarnEnabled()&&Os.warn("Websocket suspended"),this.suspendedTransports.insert("WS-STREAMING")},disableWS:function(){Os.isWarnEnabled()&&Os.warn("Websocket disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","WS-POLLING"])},disableHTTP_Streaming:function(){Os.isWarnEnabled()&&Os.warn("HTTP streaming disabled"),this.disabledTransports=this.disabledTransports.union(["HTTP-STREAMING"])},disableStreaming:function(){Os.isWarnEnabled()&&Os.warn("Streaming disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","HTTP-STREAMING"])},enableAllTransports:function(){Os.isInfoEnabled()&&(this.disabledTransports.count()>0||this.suspendedTransports.count()>0)&&Os.isInfoEnabled()&&Os.info("Transports enabled again."),this.disabledTransports=new be,this.suspendedTransports=new be},disposeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},closeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},disposeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},closeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},notifyStatus:function(t){var e=this.m_status;this.m_status=t,e!=t&&(Os.isInfoEnabled()&&Os.info("Status: "+t),this.clientEventDispatcher.onStatusChange(t))},getBestForCreating:function(){if(0==this.getBestForBinding()._hx_index)return U.BFC_none;var t=this.options.forcedTransport,e=this.suspendedTransports.union(this.disabledTransports.toArray()),s=this.options.httpExtraHeaders,i=null==s||h.empty(s);if(null==t)return i?e.contains("WS-STREAMING")?U.BFC_http:U.BFC_ws:U.BFC_http;switch(t){case"WS":case"WS-STREAMING":return i?e.contains("WS-STREAMING")?U.BFC_http:U.BFC_ws:U.BFC_http;default:return U.BFC_http}},getBestForBinding:function(){var t=this.options.forcedTransport,e=this.disabledTransports,s=this.options.httpExtraHeaders,i=null==s||h.empty(s),n=this.options.httpExtraHeadersOnSessionCreationOnly;if(null==t)return i||n?e.contains("WS-STREAMING")?e.contains("HTTP-STREAMING")?e.contains("WS-POLLING")?H.BFB_http_polling:H.BFB_ws_polling:H.BFB_http_streaming:H.BFB_ws_streaming:e.contains("HTTP-STREAMING")?H.BFB_http_polling:H.BFB_http_streaming;switch(t){case"HTTP":return e.contains("HTTP-STREAMING")?H.BFB_http_polling:H.BFB_http_streaming;case"HTTP-POLLING":return H.BFB_http_polling;case"HTTP-STREAMING":return e.contains("HTTP-STREAMING")?H.BFB_none:H.BFB_http_streaming;case"WS":return i||n?e.contains("WS-STREAMING")?e.contains("WS-POLLING")?H.BFB_none:H.BFB_ws_polling:H.BFB_ws_streaming:H.BFB_none;case"WS-POLLING":return i||n?e.contains("WS-POLLING")?H.BFB_none:H.BFB_ws_polling:H.BFB_none;case"WS-STREAMING":return i||n?e.contains("WS-STREAMING")?H.BFB_none:H.BFB_ws_streaming:H.BFB_none}},resetCurrentRetryDelay:function(){this.delayCounter.reset(this.options.retryDelay)},notifyServerErrorIfCauseIsError:function(t){switch(t._hx_index){case 0:this.clientEventDispatcher.onServerError(t.code,t.msg);break;case 1:this.clientEventDispatcher.onServerError(61,t.error)}},notifyServerError_CONERR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_END:function(t,e){0<t&&t<30||t>39?this.clientEventDispatcher.onServerError(39,e):this.clientEventDispatcher.onServerError(t,e)},notifyServerError_ERROR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_REQERR:function(t,e){11==t?this.clientEventDispatcher.onServerError(21,e):this.clientEventDispatcher.onServerError(t,e)},doCONOK:function(t,e,s,i,n){this.sessionId=t,this.details.setSessionId(t),this.requestLimit=e,null!=s?(this.keepaliveInterval=s,this.options.setKeepaliveInterval(s)):null!=i&&(this.idleTimeout=i,this.options.setIdleTimeout(i)),"*"==n||this.options.serverInstanceAddressIgnored||(n=je.completeControlLink(n,this.getServerAddress()),this.serverInstanceAddress=n,this.details.setServerInstanceAddress(n))},doCONOK_CreateWS:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doCONOK_CreateHTTP:function(t,e,s,i){this.doCONOK(t,e,null,null,i)},doCONOK_BindHTTP_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindHTTP_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doSERVNAME:function(t){this.details.setServerSocketName(t)},doCLIENTIP:function(t){this.details.setClientIp(t);var e=this.lastKnownClientIp;null!=e&&e!=t&&(Os.isInfoEnabled()&&Os.info("Client IP changed: "+e+" -> "+t),this.enableAllTransports()),this.lastKnownClientIp=t},doCONS:function(t){this.options.setRealMaxBandwidth(t)},doLOOP:function(t){this.options.setPollingInterval(t)},doPROG:function(t){if(t>this.rec_clientProg)throw new ne("Assertion failure: prog <= rec_clientProg");this.rec_serverProg=t},doMSGDONE:function(t,e,s){this.onFreshData();var i=this.messageManagers.filter((function(s){return s.sequence==t&&s.prog==e}));if(i.values.length-i.nRemoved>1)throw new ne("Assertion failure: messages.length <= 1");for(var n=new ie(i);n.hasNext();)n.next().evtMSGDONE(s)},doMSGFAIL:function(t,e,s,i){if(this.onFreshData(),39==s){var n=l.parseInt(i);if(null==n)throw new ne("Assertion failure: count != null");for(var r=e-n+1,a=e+1;r<a;){var o=this.messageManagers.filter(function(e){return function(s){return s.sequence==t&&s.prog==e[0]}}([r++]));if(o.values.length-o.nRemoved>1)throw new ne("Assertion failure: messages.length <= 1");for(var h=new ie(o);h.hasNext();)h.next().evtMSGFAIL(s,i)}}else{if(o=this.messageManagers.filter((function(s){return s.sequence==t&&s.prog==e})),o.values.length-o.nRemoved>1)throw new ne("Assertion failure: messages.length <= 1");for(h=new ie(o);h.hasNext();)h.next().evtMSGFAIL(s,i)}},doU:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtU(e,s):new It(t,this).evtU(e,s)},doSUBOK:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtSUBOK(e,s):new It(t,this).evtSUBOK(e,s)},doSUBCMD:function(t,e,s,i,n){this.onFreshData();var r=this.subscriptionManagers._innerMap.h[t];null!=r?r.evtSUBCMD(e,s,i,n):new It(t,this).evtSUBCMD(e,s,i,n)},doUNSUB:function(t){this.onFreshData();var e=this.subscriptionManagers._innerMap.h[t];null!=e&&e.evtUNSUB()},doEOS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtEOS(e):new It(t,this).evtEOS(e)},doCS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtCS(e):new It(t,this).evtCS(e)},doOV:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtOV(e,s):new It(t,this).evtOV(e,s)},doCONF:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtCONF(e):new It(t,this).evtCONF(e)},doREQOK:function(t){for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();)e.get(s.next()).evtREQOK(t);this.subscriptionManagers._orderedKeys.compact();for(var i=new ie(this.messageManagers);i.hasNext();)i.next().evtREQOK(t);this.messageManagers.compact()},doREQERR:function(t,e,s){for(var i=this.subscriptionManagers,n=i.keys();n.hasNext();)i.get(n.next()).evtREQERR(t,e,s);this.subscriptionManagers._orderedKeys.compact();for(var r=new ie(this.messageManagers);r.hasNext();)r.next().evtREQERR(t,e,s);this.messageManagers.compact()},doSYNC:function(t){this.slw_refTime=a.now()/1e3,this.slw_avgDelayMs=-t},doSYNC_G:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?K.SCR_bad:K.SCR_not_good:(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?K.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),K.SCR_good))},doSYNC_NG:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?K.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),K.SCR_good)):(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?K.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),K.SCR_not_good))},diffTimeSync:function(t){return Te.minus(a.now()/1e3,this.slw_refTime)-t},slowAvg:function(t){return this.slw_avgDelayMs*this.slw_m+t*(1-this.slw_m)},schedule_evtTransportTimeout:function(t){this.transportTimer=this.createTimer("transport.timeout",t,fs(this,this.evtTransportTimeout))},schedule_evtRetryTimeout:function(t){this.retryTimer=this.createTimer("retry.timeout",t,fs(this,this.evtRetryTimeout))},schedule_evtRecoveryTimeout:function(t){this.recoveryTimer=this.createTimer("recovery.timeout",t,fs(this,this.evtRecoveryTimeout))},schedule_evtIdleTimeout:function(t){this.idleTimer=this.createTimer("idle.timeout",t,fs(this,this.evtIdleTimeout))},schedule_evtPollingTimeout:function(t){this.pollingTimer=this.createTimer("polling.timeout",t,fs(this,this.evtPollingTimeout))},schedule_evtCtrlTimeout:function(t){this.ctrlTimer=this.createTimer("ctrl.timeout",t,fs(this,this.evtCtrlTimeout))},schedule_evtKeepaliveTimeout:function(t){this.keepaliveTimer=this.createTimer("keepalive.timeout",t,fs(this,this.evtKeepaliveTimeout))},schedule_evtStalledTimeout:function(t){this.stalledTimer=this.createTimer("stalled.timeout",t,fs(this,this.evtStalledTimeout))},schedule_evtReconnectTimeout:function(t){this.reconnectTimer=this.createTimer("reconnect.timeout",t,fs(this,this.evtReconnectTimeout))},schedule_evtRhbTimeout:function(t){this.rhbTimer=this.createTimer("rhb.timeout",t,fs(this,this.evtRhbTimeout))},createTimer:function(t,e,s){var i=this;return this.timerFactory(t,e,(function(t){i.lock.synchronized((function(){t.isCanceled()||s()}))}))},cancel_evtTransportTimeout:function(){null!=this.transportTimer&&(this.transportTimer.cancel(),this.transportTimer=null)},cancel_evtRetryTimeout:function(){null!=this.retryTimer&&(this.retryTimer.cancel(),this.retryTimer=null)},cancel_evtKeepaliveTimeout:function(){null!=this.keepaliveTimer&&(this.keepaliveTimer.cancel(),this.keepaliveTimer=null)},cancel_evtStalledTimeout:function(){null!=this.stalledTimer&&(this.stalledTimer.cancel(),this.stalledTimer=null)},cancel_evtReconnectTimeout:function(){null!=this.reconnectTimer&&(this.reconnectTimer.cancel(),this.reconnectTimer=null)},cancel_evtRhbTimeout:function(){null!=this.rhbTimer&&(this.rhbTimer.cancel(),this.rhbTimer=null)},cancel_evtIdleTimeout:function(){null!=this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},cancel_evtPollingTimeout:function(){null!=this.pollingTimer&&(this.pollingTimer.cancel(),this.pollingTimer=null)},cancel_evtCtrlTimeout:function(){null!=this.ctrlTimer&&(this.ctrlTimer.cancel(),this.ctrlTimer=null)},cancel_evtRecoveryTimeout:function(){null!=this.recoveryTimer&&(this.recoveryTimer.cancel(),this.recoveryTimer=null)},waitingInterval:function(t,e){var s=Te.minus(a.now()/1e3,e);return s<t?t-s:0},exit_tr:function(){this.evtEndSession()},entry_m111:function(t,e){this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m112:function(t){var e=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m113:function(t){var e=this.randomPause(this.options.firstRetryMaxDelay);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m115:function(t){this.evtRetry(t),this.evtRetryTimeout()},entry_rec:function(t,e){Os.isErrorEnabled()&&Os.error("Recovering connection in "+t+" ms. Cause: "+Y(e)),this.evtStartRecovery(),this.schedule_evtRecoveryTimeout(t)},exit_w:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_ws:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_wp:function(){this.cancel_evtTransportTimeout(),this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout()},exit_hs:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_hp:function(){this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout(),this.cancel_evtRhbTimeout()},exit_ctrl:function(){this.cancel_evtCtrlTimeout(),this.evtDisposeCtrl()},exit_rec:function(){this.cancel_evtRecoveryTimeout(),this.cancel_evtTransportTimeout(),this.cancel_evtRetryTimeout()},exit_keepalive_unit:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout()},exit_w_to_m:function(){this.exit_w(),this.exit_tr()},exit_ws_to_m:function(){this.exit_ws(),this.exit_tr()},exit_wp_to_m:function(){this.exit_wp(),this.exit_tr()},exit_hs_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_tr()},exit_hs_to_rec:function(){this.exit_ctrl(),this.exit_hs()},exit_hp_to_m:function(){this.exit_ctrl(),this.exit_hp(),this.exit_tr()},exit_hp_to_rec:function(){this.exit_ctrl(),this.exit_hp()},exit_ctrl_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_hp(),this.exit_tr()},exit_rec_to_m:function(){this.exit_rec(),this.exit_tr()},randomPause:function(t){return this.randomGenerator(t)},generateFreshReqId:function(){return this.m_nextReqId+=1,this.m_nextReqId},generateFreshSubId:function(){return this.m_nextSubId+=1,this.m_nextSubId},genAbortSubscriptions:function(){for(var t=this.subscriptionManagers,e=t.keys();e.hasNext();)t.get(e.next()).evtExtAbort();this.subscriptionManagers._orderedKeys.compact()},genAckMessagesWS:function(){for(var t=new ie(this.messageManagers.filter((function(t){return t.isPending()})));t.hasNext();)t.next().evtWSSent()},genAbortMessages:function(){for(var t=new ie(this.messageManagers);t.hasNext();)t.next().evtAbort();this.messageManagers.compact()},resetSequenceMap:function(){this.sequenceMap.h=Object.create(null)},isSwitching:function(){return 150==this.state.s_m&&(1302==this.state.s_swt||1303==this.state.s_swt)},encodeSwitch:function(t){var e=new ye;return this.swt_lastReqId=this.generateFreshReqId(),e.LS_reqId(this.swt_lastReqId),e.LS_op("force_rebind"),t&&e.LS_close_socket(!0),null!=this.cause&&(e.LS_cause(this.cause),this.cause=null),Ds.isInfoEnabled()&&Ds.info("Sending transport switch: "+l.string(e)),e.getEncodedString()},encodeConstrain:function(){var t=new ye;this.bw_lastReqId=this.generateFreshReqId(),t.LS_reqId(this.bw_lastReqId),t.LS_op("constrain");var e=oe.sure(this.bw_requestedMaxBandwidth);switch(e._hx_index){case 0:t.LS_requested_max_bandwidth_Float(e.bw);break;case 1:t.LS_requested_max_bandwidth("unlimited")}return Ds.isInfoEnabled()&&Ds.info("Sending bandwidth constrain: "+l.string(t)),t.getEncodedString()},getPendingControls:function(){var t=[];oe.sure(this.switchRequest).isPending()&&t.push(oe.sure(this.switchRequest)),oe.sure(this.constrainRequest).isPending()&&t.push(oe.sure(this.constrainRequest));for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next());i.isPending()&&t.push(i)}return t},sendControlWS:function(t){oe.sure(this.ws).send(t.encodeWS())},sendMsgWS:function(t){oe.sure(this.ws).send(t.encodeWS())},sendPengingControlsWS:function(t){this.sendBatchWS(this.prepareBatchWS("control",t,oe.sure(this.requestLimit)))},sendPendingMessagesWS:function(){for(var t=[],e=new ie(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchWS(this.prepareBatchWS("msg",t,oe.sure(this.requestLimit)))},sendBatchWS:function(t){for(var e=0;e<t.length;){var s=t[e++];oe.sure(this.ws).send(s)}},sendHeartbeatWS:function(){Ds.isInfoEnabled()&&Ds.info("Heartbeat request"),oe.sure(this.ws).send("heartbeat\r\n\r\n")},sendPendingControlsHTTP:function(t){this.sendBatchHTTP(this.prepareBatchHTTP(t,oe.sure(this.requestLimit)),"control")},sendPendingMessagesHTTP:function(){for(var t=[],e=new ie(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchHTTP(this.prepareBatchHTTP(t,oe.sure(this.requestLimit)),"msg")},sendHeartbeatHTTP:function(){Ds.isInfoEnabled()&&Ds.info("Heartbeat request"),this.sendBatchHTTP("\r\n","heartbeat")},sendBatchHTTP:function(t,e){var s=this;this.ctrl_connectTs=a.now()/1e3;var i=je.build(oe.sure(this.serverInstanceAddress),"/lightstreamer/"+e+".txt?LS_protocol="+ws+"&LS_session="+this.sessionId),n=this.getHeadersForRequestOtherThanCreate(),r=function(t,e){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlMessage(e)}))},o=function(t,e){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlError()}))},h=function(t){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlDone()}))};this.ctrl_http=this.ctrlFactory(i,t,n,r,o,h)},prepareBatchWS:function(t,e,s){if(e.length<=0)throw new ne("Assertion failure: pendings.length > 0");for(var i=[],n=0,r=e[0].encode(!0);n<e.length;){var a=new bt;for(a.addSubRequest(t),a.addSubRequest(r),++n;n<e.length&&(r=e[n].encode(!0),a.addSubRequestOnlyIfBodyIsLessThan(r,s));)++n;i.push(a.getBody())}return i},prepareBatchHTTP:function(t,e){if(t.length<=0)throw new ne("Assertion failure: pendings.length > 0");var s=new bt,i=0,n=t[0].encode(!1);for(s.addSubRequest(n),i=1;i<t.length&&(n=t[i].encode(!1),s.addSubRequestOnlyIfBodyIsLessThan(n,e));)++i;return s.getBody()},getHeadersForRequestOtherThanCreate:function(){return this.options.httpExtraHeadersOnSessionCreationOnly?null:this.options.httpExtraHeaders},getServerAddress:function(){var t=this.details.serverAddress;return null!=t?t:oe.sure(this.defaultServerAddress)},relateSubManager:function(t){if(null!=this.subscriptionManagers._innerMap.h[t.subId])throw new ne("Assertion failure: subscriptionManagers[subManager.subId] == null");this.subscriptionManagers.set(t.subId,t)},unrelateSubManager:function(t){this.subscriptionManagers.remove(t.subId)},isRelatedWithSubManager:function(t){return h.has(this.subscriptionManagers,t)},relateMsgManager:function(t){this.messageManagers.values.push(new se(t))},unrelateMsgManager:function(t){this.messageManagers.remove(t)},getAndSetNextMsgProg:function(t){var e=this.sequenceMap.h[t];return null==e&&(e=1),this.sequenceMap.h[t]=e+1,e},onPropertyChange:function(t){this.clientEventDispatcher.onPropertyChange(t)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("event: "+t+" "+this.state.toString())},connect:function(){var t=this.details.getServerAddress();if(null==t)throw new ne("Configure the server address before trying to connect");Ms.isInfoEnabled()&&Ms.info("Connection requested: details: "+l.string(this.details)+" options: "+l.string(this.options)+" env: "+l.string(Jt.instance)),this.defaultServerAddress=t,this.evtExtConnect()},disconnect:function(){Ms.isInfoEnabled()&&Ms.info("Disconnection requested"),this.evtExtDisconnect(G.TC_api)},getStatus:function(){return this.m_status},sendMessage:function(t,e,s,i,n){if(n||!this.state.inDisconnected()&&!this.state.inRetryUnit())if(null!=e){if(!new r("^[a-zA-Z0-9_]*$","").match(e))throw new b("The given sequence name is not valid. Use only alphanumeric characters plus underscore or null");var a=new nt(t,e,s,i,n,this);Ms.isInfoEnabled()&&Ms.info("Message sending requested: "+l.string(a)),a.evtExtSendMessage()}else a=new nt(t,"UNORDERED_MESSAGES",s,i,n,this),Ms.isInfoEnabled()&&Ms.info("Message sending requested: "+l.string(a)),a.evtExtSendMessage();else{if(Ms.isInfoEnabled()){var o=new as;o.h.text=t,o.h.sequence=null!=e?e:"UNORDERED_MESSAGES",o.h.timeout=null==s?"null":""+s,o.h.enqueueWhileDisconnected=null==n?"null":""+n,Ms.isInfoEnabled()&&Ms.info("Message sending requested: "+(null==o?"null":as.stringify(o.h)))}if(Fs.isWarnEnabled()&&Fs.warn("Message "+(null!=e?e:"UNORDERED_MESSAGES")+" "+t+" aborted"),null!=i){var h=new it;h.addListener(i),h.onAbort(t,!1)}}},subscribeExt:function(t,e){if(null==e&&(e=!1),t.isActive())throw new ne("Cannot subscribe to an active Subscription");if(null==t.fetchItems()&&null==t.getItemGroup())throw new b("Specify property 'items' or 'itemGroup'");if(null==t.fetchFields()&&null==t.getFieldSchema())throw new b("Specify property 'fields' or 'fieldSchema'");var s=new Rt(t,this);Ms.isInfoEnabled()&&Ms.info((e?"Internal subscription":"Subscription")+" requested: subId: "+s.subId+" "+l.string(t)),s.evtExtSubscribe()},unsubscribe:function(t){var e=t.fetch_subManager();if(null!=e){if(!this.isRelatedWithSubManager(e))throw new b("The Subscription is not subscribed to this Client");Ms.isInfoEnabled()&&Ms.info("Unsubscription requested: subId: "+e.subId+" "+l.string(t)),e.evtExtUnsubscribe()}},getSubscriptions:function(){for(var t=[],e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next()),n=i instanceof Rt?i:null;if(null!=n){var r=n.m_subscription;r.isActive()&&!r.isInternal()&&t.push(r)}}return t},__class__:B};var U=i["com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum"]={__ename__:!0,__constructs__:null,BFC_ws:{_hx_name:"BFC_ws",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:s},BFC_http:{_hx_name:"BFC_http",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:s},BFC_none:{_hx_name:"BFC_none",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:s}};U.__constructs__=[U.BFC_ws,U.BFC_http,U.BFC_none];var H=i["com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum"]={__ename__:!0,__constructs__:null,BFB_none:{_hx_name:"BFB_none",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_ws_streaming:{_hx_name:"BFB_ws_streaming",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_ws_polling:{_hx_name:"BFB_ws_polling",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_http_streaming:{_hx_name:"BFB_http_streaming",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_http_polling:{_hx_name:"BFB_http_polling",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s}};H.__constructs__=[H.BFB_none,H.BFB_ws_streaming,H.BFB_ws_polling,H.BFB_http_streaming,H.BFB_http_polling];var K=i["com.lightstreamer.client.internal._ClientMachine.SyncCheckResult"]={__ename__:!0,__constructs__:null,SCR_good:{_hx_name:"SCR_good",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:s},SCR_not_good:{_hx_name:"SCR_not_good",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:s},SCR_bad:{_hx_name:"SCR_bad",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:s}};K.__constructs__=[K.SCR_good,K.SCR_not_good,K.SCR_bad];var V=i["com.lightstreamer.client.internal._ClientMachine.RetryCause"]={__ename__:!0,__constructs__:null,standardError:(e=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s}},e._hx_name="standardError",e.__params__=["code","msg"],e),ws_unavailable:{_hx_name:"ws_unavailable",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},ws_error:{_hx_name:"ws_error",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},http_error:{_hx_name:"http_error",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},idle_timeout:{_hx_name:"idle_timeout",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},stalled_timeout:{_hx_name:"stalled_timeout",_hx_index:5,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},ws_timeout:{_hx_name:"ws_timeout",_hx_index:6,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},http_timeout:{_hx_name:"http_timeout",_hx_index:7,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},recovery_timeout:{_hx_name:"recovery_timeout",_hx_index:8,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},prog_mismatch:(e=function(t,e){return{_hx_index:9,expected:t,actual:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s}},e._hx_name="prog_mismatch",e.__params__=["expected","actual"],e),page_frozen:{_hx_name:"page_frozen",_hx_index:10,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s}};V.__constructs__=[V.standardError,V.ws_unavailable,V.ws_error,V.http_error,V.idle_timeout,V.stalled_timeout,V.ws_timeout,V.http_timeout,V.recovery_timeout,V.prog_mismatch,V.page_frozen];var G=i["com.lightstreamer.client.internal._ClientMachine.TerminationCause"]={__ename__:!0,__constructs__:null,TC_standardError:(e=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:s}},e._hx_name="TC_standardError",e.__params__=["code","msg"],e),TC_otherError:(e=function(t){return{_hx_index:1,error:t,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:s}},e._hx_name="TC_otherError",e.__params__=["error"],e),TC_api:{_hx_name:"TC_api",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:s}};G.__constructs__=[G.TC_standardError,G.TC_otherError,G.TC_api];var z=i["com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause"]={__ename__:!0,__constructs__:null,RRC_transport_timeout:{_hx_name:"RRC_transport_timeout",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:s},RRC_transport_error:{_hx_name:"RRC_transport_error",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:s}};function Y(t){switch(t._hx_index){case 0:return t.code+" - "+t.msg;case 1:return"Websocket transport not available";case 2:return"Websocket error";case 3:return"HTTP error";case 4:return"idleTimeout expired";case 5:return"stalledTimeout expired";case 6:return"Websocket connect timeout expired";case 7:return"HTTP connect timeout expired";case 8:return"sessionRecoveryTimeout expired";case 9:return"Recovery counter mismatch: expected "+t.expected+" but found "+t.actual;case 10:return"page frozen"}}z.__constructs__=[z.RRC_transport_timeout,z.RRC_transport_error];var Q=function(){};Q.__name__=!0,Q.__isInterface__=!0,Q.prototype={__class__:Q};var j=function(t){this.client=t};j.__name__=!0,j.__interfaces__=[Q],j.prototype={isPending:function(){return 150==this.client.state.s_m&&1302==this.client.state.s_swt},encode:function(t){return this.client.encodeSwitch(t)},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:j};var $=function(t){this.client=t};$.__name__=!0,$.__interfaces__=[Q],$.prototype={isPending:function(){return 1202==this.client.state.s_bw},encode:function(t){return this.client.encodeConstrain()},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:$};var J=function(t,e,s){this.p=t,this.k=e,this.s=s};J.__name__=!0,J.prototype={toString:function(){return"<w_p="+this.p+" w_k="+this.k+" w_s="+this.s+">"},__class__:J};var Z=function(t){this.m=t};Z.__name__=!0,Z.prototype={toString:function(){var t="<ws_m="+this.m;return null!=this.p&&(t+=" ws_p="+this.p),null!=this.k&&(t+=" ws_k="+this.k),null!=this.s&&(t+=" ws_s="+this.s),t+=">"},__class__:Z};var X=function(t){this.m=t};X.__name__=!0,X.prototype={toString:function(){var t="<wp_m="+this.m;return null!=this.p&&(t+=" wp_p="+this.p),null!=this.c&&(t+=" wp_c="+this.c),null!=this.s&&(t+=" wp_s="+this.s),t+=">"},__class__:X};var tt=function(t){this.m=t};tt.__name__=!0,tt.prototype={toString:function(){var t="<hs_m="+this.m;return null!=this.p&&(t+=" hs_p="+this.p),null!=this.k&&(t+=" hs_k="+this.k),t+=">"},__class__:tt};var et=function(t){this.m=t};et.__name__=!0,et.prototype={toString:function(){return"<hp_m="+this.m+">"},__class__:et};var st=function(){this.s_m=100,this.s_du=20,this.s_nr=1400};st.__name__=!0,st.prototype={goto_m_from_w:function(t){this.clear_w(),this.goto_m_from_session(t)},goto_m_from_ws:function(t){this.clear_ws(),this.goto_m_from_session(t)},goto_rec_from_w:function(){this.clear_w(),this.goto_rec()},goto_rec_from_ws:function(){this.clear_ws(),this.goto_rec()},goto_m_from_wp:function(t){this.clear_wp(),this.goto_m_from_session(t)},goto_rec_from_wp:function(){this.clear_wp(),this.goto_rec()},goto_m_from_hs:function(t){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_m_from_rec:function(t){this.s_tr=null,this.goto_m_from_session(t)},goto_rec_from_hs:function(){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_m_from_hp:function(t){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_rec_from_hp:function(){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_rec:function(){this.s_tr=260,this.s_rec=1e3,this.traceState()},goto_m_from_session:function(t){this.s_tr=null,this.s_swt=null,this.s_bw=null,this.s_m=t,this.traceState()},goto_m_from_ctrl:function(t){this.clear_hs(),this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_200_from_rec:function(){this.s_rec=null,this.s_tr=200,this.traceState()},clear_w:function(){this.s_w=null,this.s_rhb=null,this.s_slw=null},clear_ws:function(){this.s_ws=null,this.s_rhb=null,this.s_slw=null},clear_wp:function(){this.s_wp=null},clear_hs:function(){this.s_hs=null,this.s_rhb=null,this.s_slw=null},clear_hp:function(){this.s_hp=null,this.s_rhb=null},isSwitching:function(){return 150==this.s_m&&(1302==this.s_swt||1303==this.s_swt)},inPushing:function(){return!!this.inStreaming()||this.inPolling()},inStreaming:function(){var t,e;return!!(e=300==(null!=(t=this.s_w)?t.p:null)||510==(null!=(t=this.s_ws)?t.p:null))||810==(null!=(e=this.s_hs)?e.p:null)},inPolling:function(){var t;if(220!=this.s_tr&&230!=this.s_tr){var e=this.s_wp;t=611==(null!=e?e.p:null)}else t=!0;return!!(!!t||901==(null!=(t=this.s_hp)?t.m:null))||1001==this.s_rec},inRetryUnit:function(){switch(this.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:return!0;default:return!1}},inDisconnected:function(){return 100==this.s_m},toString:function(){var t="<m="+this.s_m;return t+=" du="+this.s_du,null!=this.s_tr&&(t+=" tr="+this.s_tr),null!=this.s_w&&(t+=" "+l.string(this.s_w)),null!=this.s_ws&&(t+=" "+l.string(this.s_ws)),null!=this.s_wp&&(t+=" "+l.string(this.s_wp)),null!=this.s_hs&&(t+=" "+l.string(this.s_hs)),null!=this.s_hp&&(t+=" "+l.string(this.s_hp)),null!=this.s_rec&&(t+=" rec="+this.s_rec),null!=this.s_h&&(t+=" h="+this.s_h),null!=this.s_ctrl&&(t+=" ctrl="+this.s_ctrl),null!=this.s_swt&&(t+=" swt="+this.s_swt),null!=this.s_bw&&(t+=" bw="+this.s_bw),null!=this.s_rhb&&(t+=" rhb="+this.s_rhb),null!=this.s_slw&&(t+=" slw="+this.s_slw),t+=" nr="+this.s_nr,t+=">"},traceState:function(){Ns.isTraceEnabled()&&Ns.trace("goto: "+this.toString())},__class__:st};var it=function(){I.call(this)};it.__name__=!0,it.__super__=I,it.prototype=n(I.prototype,{onAbort:function(t,e){this.dispatchToAll((function(s){null!=s.onAbort&&s.onAbort(t,e)}))},onDeny:function(t,e,s){this.dispatchToAll((function(i){null!=i.onDeny&&i.onDeny(t,e,s)}))},onDiscarded:function(t){this.dispatchToAll((function(e){null!=e.onDiscarded&&e.onDiscarded(t)}))},onError:function(t){this.dispatchToAll((function(e){null!=e.onError&&e.onError(t)}))},onProcessed:function(t,e){this.dispatchToAll((function(s){null!=s.onProcessed&&s.onProcessed(t,e)}))},__class__:it});var nt=function(t,e,s,i,n,r){this.eventDispatcher=new it,this.txt=t,this.sequence=e,this.prog="UNORDERED_MESSAGES"!=e||null!=i?r.getAndSetNextMsgProg(e):-1,this.maxWait=s,this.delegate=i,null!=i&&this.eventDispatcher.addListener(i),this.enqueueWhileDisconnected=n,this.client=r,this.s_m=null!=i?10:"UNORDERED_MESSAGES"!=e?20:30,r.relateMsgManager(this)};nt.__name__=!0,nt.__interfaces__=[Q],nt.prototype={finalize:function(){this.client.unrelateMsgManager(this)},evtExtSendMessage:function(){switch(this.traceEvent("sendMessage"),this.s_m){case 10:this.goto(11),this.client.evtSendMessage(this);break;case 20:this.goto(21),this.client.evtSendMessage(this);break;case 30:this.goto(31),this.client.evtSendMessage(this)}},evtMSGFAIL:function(t,e){switch(this.traceEvent("MSGFAIL"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGFAIL(t,e),this.finalize(),this.goto(14)}},evtMSGDONE:function(t){switch(this.traceEvent("MSGDONE"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGDONE(t),this.finalize(),this.goto(13)}},evtREQOK:function(t){switch(this.traceEvent("REQOK"),this.s_m){case 11:t==this.lastReqId&&this.goto(12);break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(22));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(33))}},evtREQERR:function(t,e,s){switch(this.traceEvent("REQERR"),this.s_m){case 11:t==this.lastReqId&&(this.doREQERR(e,s),this.finalize(),this.goto(14));break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(23));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(34))}},evtAbort:function(){switch(this.traceEvent("abort"),this.s_m){case 11:case 12:this.doAbort(),this.finalize(),this.goto(15);break;case 21:Fs.isWarnEnabled()&&Fs.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(24);break;case 31:Fs.isWarnEnabled()&&Fs.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(35)}},evtWSSent:function(){this.traceEvent("ws.sent"),31==this.s_m&&(this.finalize(),this.goto(32))},isPending:function(){return 11==this.s_m||21==this.s_m||31==this.s_m},encode:function(t){return this.encodeMsg(t)},encodeWS:function(){return"msg\r\n"+this.encode(!0)},doMSGDONE:function(t){this.fireOnProcessed(t)},doMSGFAIL:function(t,e){38==t||39==t?this.fireOnDiscarded():t<=0?this.fireOnDeny(t,e):32!=t&&33!=t&&this.fireOnError()},doREQERR:function(t,e){32!=t&&33!=t&&this.fireOnError()},doAbort:function(){this.fireOnAbort()},encodeMsg:function(t){var e="UNORDERED_MESSAGES"!=this.sequence,s=null!=this.delegate,i=new ye;return this.lastReqId=this.client.generateFreshReqId(),i.LS_reqId(this.lastReqId),i.LS_message(this.txt),e&&s?(i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):!e&&s?i.LS_msg_prog(this.prog):e&&!s?(i.LS_outcome(!1),i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):e||s||(i.LS_outcome(!1),t&&i.LS_ack(!1)),Ds.isInfoEnabled()&&Ds.info("Sending message: "+l.string(i)),i.getEncodedString()},fireOnProcessed:function(t){Fs.isInfoEnabled()&&Fs.info("Message "+this.sequence+":"+this.prog+" processed"),this.eventDispatcher.onProcessed(this.txt,t)},fireOnDiscarded:function(){Fs.isWarnEnabled()&&Fs.warn("Message "+this.sequence+":"+this.prog+" discarded"),this.eventDispatcher.onDiscarded(this.txt)},fireOnDeny:function(t,e){Fs.isWarnEnabled()&&Fs.warn("Message "+this.sequence+":"+this.prog+" denied: "+t+" - "+e),this.eventDispatcher.onDeny(this.txt,t,e)},fireOnError:function(){Fs.isWarnEnabled()&&Fs.warn("Message "+this.sequence+":"+this.prog+" failed"),this.eventDispatcher.onError(this.txt)},fireOnAbort:function(){Fs.isWarnEnabled()&&Fs.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.eventDispatcher.onAbort(this.txt,!1)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("msg#"+t+"("+this.sequence+":"+this.prog+") in "+this.s_m)},goto:function(t){this.s_m=t,Ns.isTraceEnabled()&&Ns.trace("msg#goto("+this.sequence+":"+this.prog+") "+this.s_m)},toString:function(){var t=te._new();return te.set(t,"text",this.txt),te.set(t,"sequence",this.sequence),te.set(t,"prog",this.prog),te.set(t,"timeout",this.maxWait),te.set(t,"enqueueWhileDisconnected",this.enqueueWhileDisconnected),as.stringify(t.h)},__class__:nt};var rt=function(t,e,s){this.items=new rs,this.s_m=1,this.lock=e.lock,this.client=e,this.subscription=t,this.m_subId=s};rt.__name__=!0,rt.prototype={finalize:function(){},evtAbort:function(){this.traceEvent("abort"),1==this.s_m?(this.doAbort(),this.goto(1)):2==this.s_m&&(this.doAbort(),this.goto(1),this.genDisposeItems())},evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUB(t,e),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF(t),this.goto(2))},evtOnCS:function(t){this.traceEvent("onCS"),2==this.s_m&&(this.doCS(t),this.goto(2))},evtOnEOS:function(t){this.traceEvent("onEOS"),2==this.s_m&&(this.doEOS(t),this.goto(2))},evtUpdate:function(t,e){this.traceEvent("update"),2==this.s_m&&(this.doUpdate(t,e),this.goto(2))},evtUnsubscribe:function(){this.traceEvent("unsubscribe"),1==this.s_m?(this.finalize(),this.goto(3)):2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtOnUNSUB:function(){this.traceEvent("onUNSUB"),2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtDispose:function(){this.traceEvent("dispose"),1!=this.s_m&&2!=this.s_m||(this.finalize(),this.goto(3),this.genDisposeItems())},evtSetRequestedMaxFrequency:function(t){},getValue:function(t,e){var s=this.items.h[t];return null!=s?s.getValue(e):null},getCommandValue:function(t,e,s){throw new ne("Unsupported operation")},createItem:function(t){throw new ne("Abstract method")},doSUB:function(t,e){var s=this.subscription.fetchItems(),i=this.subscription.fetchFields();if(null!=s&&t!=s.length)throw new ne("Assertion failure: items != null ? nItems == items.length : true");if(null!=i&&e!=i.length)throw new ne("Assertion failure: fields != null ? nFields == fields.length : true")},doUpdate:function(t,e){this.selectItem(t).evtUpdate(e)},doEOS:function(t){this.selectItem(t).evtOnEOS()},doCS:function(t){this.selectItem(t).evtOnCS()},doCONF:function(t){this.realMaxFrequency=t,this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},doAbort:function(){this.realMaxFrequency=null},genDisposeItems:function(){for(var t=this.items.copy(),e=t.keys();e.hasNext();)t.get(e.next()).evtDispose(this)},selectItem:function(t){var e=this.items.h[t];return null==e&&(e=this.createItem(t),this.items.h[t]=e),e},unrelate:function(t){this.items.remove(t)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("sub#mod#"+t+"("+this.m_subId+") in "+this.s_m)},goto:function(t){this.s_m=t,Ns.isTraceEnabled()&&Ns.trace("sub#mod#goto("+this.m_subId+") "+this.s_m)},__class__:rt};var at=function(t,e,s){rt.call(this,t,e,s)};at.__name__=!0,at.__super__=rt,at.prototype=n(rt.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD(t,e,s,i),this.goto(2))},getCommandValue:function(t,e,s){var i=this.items.h[t];return null!=i?i.getCommandValue(e,s):null},doSUBCMD:function(t,e,s,i){var n=this.subscription.fetchItems(),r=this.subscription.fetchFields();if(null!=n&&t!=n.length)throw new ne("Assertion failure: items != null ? nItems == items.length : true");if(null!=r&&e!=r.length)throw new ne("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=r&&s-1!=r.indexOf("command"))throw new ne('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=r&&i-1!=r.indexOf("key"))throw new ne('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true')},__class__:at});var ot=function(t,e,s){at.call(this,t,e,s)};ot.__name__=!0,ot.__super__=at,ot.prototype=n(at.prototype,{createItem:function(t){return new Dt(t,this.subscription,this.client,this.m_subId)},__class__:ot});var ht=function(t,e,s){at.call(this,t,e,s)};ht.__name__=!0,ht.__super__=at,ht.prototype=n(at.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD2Level(t,e,s,i,n),this.goto(2))},evtSetRequestedMaxFrequency:function(t){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:this.doSetRequestedMaxFrequency(t),this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},evtOnRealMaxFrequency2LevelAdded:function(t){this.traceEvent("onRealMaxFrequency2LevelAdded"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},evtOnRealMaxFrequency2LevelRemoved:function(){this.traceEvent("onRealMaxFrequency2LevelRemoved"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsRemoved(),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF2Level(t),this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},createItem:function(t){return new Nt(t,this.subscription,this,this.client,this.m_subId)},doSUBCMD2Level:function(t,e,s,i,n){var r=this.subscription.fetchItems(),a=this.subscription.fetchFields();if(null!=r&&t!=r.length)throw new ne("Assertion failure: items != null ? nItems == items.length : true");if(null!=a&&e!=a.length)throw new ne("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=a&&s-1!=a.indexOf("command"))throw new ne('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=a&&i-1!=a.indexOf("key"))throw new ne('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true');this.requestedMaxFrequency=n},doSetRequestedMaxFrequency:function(t){this.requestedMaxFrequency=t},genSetRequestedMaxFrequency:function(){for(var t=this.items,e=t.keys();e.hasNext();)W.__cast(t.get(e.next()),Nt).evtSetRequestedMaxFrequency()},doCONF2Level:function(t){this.realMaxFrequency=t},maxFreq:function(t,e){var s;if(null==t)s=e;else switch(t._hx_index){case 0:var i=t.freq;if(null==e)s=t;else switch(e._hx_index){case 0:s=Be.RFreqLimited(Math.max(i,e.freq));break;case 1:s=e}break;case 1:s=t}return s},doAggregateFrequenciesWhenFreqIsAdded:function(t){var e=this.maxFreq(this.aggregateRealMaxFrequency,t),s=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=e,Qe(s,e)||this.subscription.fireOnRealMaxFrequency(e,this.m_subId)},doAggregateFrequenciesWhenFreqIsRemoved:function(){for(var t=this.realMaxFrequency,e=!1,s=this.items,i=s.keys();i.hasNext();){for(var n=W.__cast(s.get(i.next()),Nt).keys.h,r=Object.keys(n),a=r.length,o=0;o<a;)if((t=this.maxFreq(t,W.__cast(n[r[o++]],Wt).realMaxFrequency))==Be.RFreqUnlimited){e=!0;break}if(e)break}var h=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=t,Qe(h,t)||this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},__class__:ht});var ct=function(t,e,s){rt.call(this,t,e,s)};ct.__name__=!0,ct.__super__=rt,ct.prototype=n(rt.prototype,{createItem:function(t){return new Ot(t,this.subscription,this.client,this.m_subId)},__class__:ct});var lt=function(t,e,s){rt.call(this,t,e,s)};lt.__name__=!0,lt.__super__=rt,lt.prototype=n(rt.prototype,{createItem:function(t){return new Pt(t,this.subscription,this.client,this.m_subId)},__class__:lt});var ut=function(t,e,s){rt.call(this,t,e,s)};ut.__name__=!0,ut.__super__=rt,ut.prototype=n(rt.prototype,{createItem:function(t){return new kt(t,this.subscription,this.client,this.m_subId)},__class__:ut});var _t=function(t,e,s){this.subId=t,this.itemIdx=e,this.values=s};function dt(t){return oe.sure(l.parseInt(t))}function ft(t){return oe.sure(parseFloat(t))}function mt(t){for(var e=pt(t,",")+1,s=pt(t,",",e)+1,i=pt(t,",",s)+1,n=dt(t.substring(e,s-1)),r=dt(t.substring(s,i-1)),a=new rs,o=i-1,h=1;o<t.length;){var c=t.indexOf("|",o+1);-1==c&&(c=t.length);var l=t.substring(o+1,c);if(""==l)a.h[h]=xe.unchanged,++h;else if("#"==l)a.h[h]=xe.changed(null),++h;else if("$"==l)a.h[h]=xe.changed(""),++h;else if("^"==l.charAt(0)){if("P"==l.charAt(1))throw new ne("JSONPatch compression is not supported by the client");if("T"==l.charAt(1)){var u=gt(l.substring(2));a.h[h]=xe.diffPatch(u),++h}else for(var _=dt(l.substring(1)),d=0;d<_;)++d,a.h[h]=xe.unchanged,++h}else{var f=xe.changed(gt(l));a.h[h]=f,++h}o=c}return new _t(n,r,a)}function pt(t,e,s){var i=t.indexOf(e,s);if(-1==i)throw new ne("string not found");return i}function gt(t){for(var e=St.ofString(t,yt.UTF8),s=0,i=0;s<e.length;)37==e.b[s]?(e.b[i++]=(vt(e.b[s+1])<<4)+vt(e.b[s+2]),s+=3):e.b[i++]=e.b[s++];return e.getString(0,i,yt.UTF8)}function vt(t){var e=0;return(e=t-97+10)<=9&&(e=t-65+10)<=9&&(e=t-48),e}_t.__name__=!0,_t.prototype={__class__:_t};var St=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};St.__name__=!0,St.ofString=function(t,e){if(e==yt.RawNative){for(var s=new Uint8Array(t.length<<1),i=0,n=t.length;i<n;){var r=i++,a=t.charCodeAt(r);s[r<<1]=255&a,s[r<<1|1]=a>>8}return new St(s.buffer)}var o=[];for(r=0;r<t.length;)55296<=(a=t.charCodeAt(r++))&&a<=56319&&(a=a-55232<<10|1023&t.charCodeAt(r++)),a<=127?o.push(a):a<=2047?(o.push(192|a>>6),o.push(128|63&a)):a<=65535?(o.push(224|a>>12),o.push(128|a>>6&63),o.push(128|63&a)):(o.push(240|a>>18),o.push(128|a>>12&63),o.push(128|a>>6&63),o.push(128|63&a));return new St(new Uint8Array(o).buffer)},St.prototype={getString:function(t,e,s){if(t<0||e<0||t+e>this.length)throw g.thrown(cs.OutsideBounds);null==s&&(s=yt.UTF8);var i="",n=this.b,r=t,a=t+e;switch(s._hx_index){case 0:for(;r<a;)if((l=n[r++])<128){if(0==l)break;i+=String.fromCodePoint(l)}else if(l<224){var o=(63&l)<<6|127&n[r++];i+=String.fromCodePoint(o)}else if(l<240){var h=(31&l)<<12|(127&n[r++])<<6|127&n[r++];i+=String.fromCodePoint(h)}else{var c=(15&l)<<18|(127&n[r++])<<12|(127&n[r++])<<6|127&n[r++];i+=String.fromCodePoint(c)}break;case 1:for(;r<a;){var l=n[r++]|n[r++]<<8;i+=String.fromCodePoint(l)}}return i},__class__:St};var yt=i["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:s},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:s}};yt.__constructs__=[yt.UTF8,yt.RawNative];var bt=function(){this.body=""};bt.__name__=!0,bt.isEmpty=function(t){return 0==t.length},bt.lengthOfBytes=function(t){return St.ofString(t,yt.UTF8).length},bt.prototype={getByteSize:function(){return bt.lengthOfBytes(this.body)},getBody:function(){return this.body},addSubRequest:function(t){bt.isEmpty(this.body)?this.body=t:this.body+="\r\n"+t},addSubRequestOnlyIfBodyIsLessThan:function(t,e){return bt.isEmpty(this.body)&&bt.lengthOfBytes(t)<=e?(this.body=t,!0):bt.lengthOfBytes(this.body)+bt.EOL_LEN+bt.lengthOfBytes(t)<=e&&(this.body+="\r\n"+t,!0)},__class__:bt};var Et=function(){this.attempt=1,this._currentRetryDelay=0};Et.__name__=!0,Et.prototype={get_currentRetryDelay:function(){return this._currentRetryDelay},increase:function(){this.attempt>10?this._currentRetryDelay<6e4&&(2*this._currentRetryDelay<6e4?this._currentRetryDelay*=2:this._currentRetryDelay=6e4):this.attempt+=1},reset:function(t){this.attempt=1,this._currentRetryDelay=t},__class__:Et};var wt=function(){};wt.__name__=!0,wt.__isInterface__=!0,wt.__interfaces__=[Q],wt.prototype={__class__:wt};var Tt=function(t){this.subId=t,this.s_m=1};Tt.__name__=!0,Tt.prototype={toString:function(){var t="<m="+this.s_m;return null!=this.s_s&&(t+=" s="+this.s_s),null!=this.s_c&&(t+=" c="+this.s_c),t+=">"},traceState:function(){Ns.isTraceEnabled()&&Ns.trace("sub#goto("+this.subId+") "+this.toString())},__class__:Tt};var Rt=function(t,e){var s;switch(this.lock=e.lock,this.subId=e.generateFreshSubId(),t.fetch_mode()){case"COMMAND":s=Rt.is2LevelCommand(t)?new ht(t,e,this.subId):new ot(t,e,this.subId);break;case"DISTINCT":s=new ct(t,e,this.subId);break;case"MERGE":s=new lt(t,e,this.subId);break;case"RAW":s=new ut(t,e,this.subId)}this.m_strategy=s,this.state=new Tt(this.subId),this.m_client=e,this.m_subscription=t,this.m_client.relateSubManager(this),this.m_subscription.relate(this)};Rt.__name__=!0,Rt.__interfaces__=[wt],Rt.is2LevelCommand=function(t){return"COMMAND"==t.fetch_mode()&&(null!=t.getCommandSecondLevelFields()||null!=t.getCommandSecondLevelFieldSchema())},Rt.prototype={finalize:function(){this.m_strategy.evtDispose(),this.m_client.unrelateSubManager(this),this.m_subscription.unrelate(this)},evtExtSubscribe:function(){this.traceEvent("subscribe"),1==this.state.s_m&&(this.doSetActive(),this.doSubscribe(),this.state.s_m=2,this.state.traceState(),this.genSendControl())},evtExtUnsubscribe:function(){this.traceEvent("unsubscribe"),2==this.state.s_m?(this.doSetInactive(),this.finalize(),this.state.s_m=30,this.state.traceState()):3==this.state.s_m?(this.doUnsubscribe(),this.doSetInactive(),this.state.s_m=5,this.state.traceState(),this.genSendControl()):10==this.state.s_s&&(this.doUnsubscribe(),this.m_subscription.setInactive(),this.notifyOnUnsubscription(),this.state.s_m=5,this.state.s_s=null,this.state.s_c=null,this.state.traceState(),this.genSendControl())},evtExtAbort:function(){this.traceEvent("abort"),2==this.state.s_m?(this.state.s_m=2,this.state.traceState()):3==this.state.s_m?(this.doAbort(),this.doSetActive(),this.state.s_m=2,this.state.traceState()):10==this.state.s_s?(this.doAbort(),this.doSetActive(),this.notifyOnUnsubscription(),this.state.s_s=null,this.state.s_c=null,this.state.s_m=2,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.doSetInactive(),this.notifyOnSubscriptionError(e,s),this.finalize(),this.state.s_m=30,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(We.extEquals(this.m_reqMaxFrequency,this.m_subscription.fetch_requestedMaxFrequency())?(this.state.s_c=21,this.state.traceState()):(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.state.s_m=3,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(this.doREQOKConfigure(),this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},checkItems:function(t,e){return null==t||t==e},checkFields:function(t,e){return null==t||t==e},checkItemsAndFields:function(t,e,s,i){return!!this.checkItems(t,s)&&this.checkFields(e,i)},evtSUBOK:function(t,e){if(this.traceEvent("SUBOK"),2==this.state.s_m||3==this.state.s_m){var s,i=null!=(s=this.m_subscription.fetch_items())?s.length:null,n=null!=(s=this.m_subscription.fetch_fields())?s.length:null;this.checkItemsAndFields(i,n,t,e)?(this.doSUBOK(t,e),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(i,n,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtSUBCMD:function(t,e,s,i){if(this.traceEvent("SUBCMD"),2==this.state.s_m||3==this.state.s_m){var n,r=null!=(n=this.m_subscription.fetch_items())?n.length:null,a=null!=(n=this.m_subscription.fetch_fields())?n.length:null;this.checkItemsAndFields(r,a,t,e)?(this.doSUBCMD(t,e,i,s),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(r,a,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtUNSUB:function(){this.traceEvent("UNSUB"),10==this.state.s_s?(this.doUNSUB(),this.doSetInactive(),this.notifyOnUnsubscription(),this.finalize(),this.state.s_m=31,this.state.s_s=null,this.state.s_c=null,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtU:function(t,e){this.traceEvent("U"),10==this.state.s_s&&(this.doU(t,e),this.state.s_s=10,this.state.traceState())},evtEOS:function(t){this.traceEvent("EOS"),10==this.state.s_s&&(this.doEOS(t),this.state.s_s=10,this.state.traceState())},evtCS:function(t){this.traceEvent("CS"),10==this.state.s_s&&(this.doCS(t),this.state.s_s=10,this.state.traceState())},evtOV:function(t,e){this.traceEvent("OV"),10==this.state.s_s&&(this.doOV(t,e),this.state.s_s=10,this.state.traceState())},evtCONF:function(t){this.traceEvent("CONF"),10==this.state.s_s&&(this.doCONF(t),this.state.s_s=10,this.state.traceState())},evtCheckFrequency:function(){this.traceEvent("check.frequency"),20==this.state.s_c&&(We.extEquals(this.m_subscription.fetch_requestedMaxFrequency(),this.m_currentMaxFrequency)?(this.state.s_c=21,this.state.traceState()):(this.doConfigure(),this.state.s_c=22,this.state.traceState(),this.genSendControl()))},evtExtConfigure:function(){this.traceEvent("configure"),21==this.state.s_c&&(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},isPending:function(){return 2==this.state.s_m||5==this.state.s_m||22==this.state.s_c},encode:function(t){if(2==this.state.s_m)return this.encodeAdd(t);if(5==this.state.s_m)return this.encodeDelete(t);if(22==this.state.s_c)return this.encodeReconf(t);throw new ne("Can't encode request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},getValue:function(t,e){return this.m_strategy.getValue(t,e)},getCommandValue:function(t,e,s){return this.m_strategy.getCommandValue(t,e,s)},encodeAdd:function(t){var e=new ye;this.m_lastAddReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastAddReqId),e.LS_op("add"),e.LS_subId(this.subId),e.LS_mode(this.m_subscription.fetch_mode());var s=this.m_subscription.getItemGroup(),i=this.m_subscription.fetchItems();null!=s?e.LS_group(s):null!=i&&e.LS_group(i.join(" "));var n=this.m_subscription.getFieldSchema(),r=this.m_subscription.fetchFields();null!=n?e.LS_schema(n):null!=r&&e.LS_schema(r.join(" "));var a=this.m_subscription.getDataAdapter();null!=a&&e.LS_data_adapter(a);var o=this.m_subscription.getSelector();null!=o&&e.LS_selector(o);var h=this.m_subscription.fetch_requestedSnapshot();if(null!=h)switch(h._hx_index){case 0:e.LS_snapshot(!0);break;case 1:e.LS_snapshot(!1);break;case 2:e.LS_snapshot_Int(h.len)}var c=this.m_currentMaxFrequency;if(null!=c)switch(c._hx_index){case 0:e.LS_requested_max_frequency_Float(c.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}var u=this.m_subscription.fetch_requestedBufferSize();if(null!=u)switch(u._hx_index){case 0:e.LS_requested_buffer_size_Int(u.size);break;case 1:e.LS_requested_buffer_size("unlimited")}return t&&e.LS_ack(!1),Ds.isInfoEnabled()&&Ds.info("Sending Subscription add: "+l.string(e)),e.getEncodedString()},encodeDelete:function(t){var e=new ye;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),Ds.isInfoEnabled()&&Ds.info("Sending Subscription delete: "+l.string(e)),e.getEncodedString()},encodeReconf:function(t){var e=new ye;this.m_lastReconfReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastReconfReqId),e.LS_subId(this.subId),e.LS_op("reconf");var s=this.m_reqMaxFrequency;if(null!=s)switch(s._hx_index){case 0:e.LS_requested_max_frequency_Float(s.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}return Ds.isInfoEnabled()&&Ds.info("Sending Subscription configuration: "+l.string(e)),e.getEncodedString()},doSetActive:function(){this.m_subscription.setActive()},doSetInactive:function(){this.m_subscription.setInactive()},doSubscribe:function(){this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency()},doUnsubscribe:function(){this.m_strategy.evtUnsubscribe(),this.m_subscription.unrelate(this)},doAbort:function(){this.m_lastAddReqId=null,this.m_lastDeleteReqId=null,this.m_lastReconfReqId=null,this.m_reqMaxFrequency=null,this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtAbort()},genSendControl:function(){this.m_client.evtSendControl(this)},notifyOnSubscription:function(){this.m_subscription.fireOnSubscription(this.subId)},notifyOnUnsubscription:function(){this.m_subscription.fireOnUnsubscription(this.subId)},notifyOnSubscriptionError:function(t,e){this.m_subscription.fireOnSubscriptionError(this.subId,t,e)},notifyOnSubscriptionError_CountMismatch:function(t,e,s,i){this.checkItems(t,s)?this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+e+" fields but got "+i):this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+t+" items but got "+s)},doConfigure:function(){this.m_reqMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtSetRequestedMaxFrequency(this.m_reqMaxFrequency)},doREQOKConfigure:function(){this.m_currentMaxFrequency=this.m_reqMaxFrequency},doSUBOK:function(t,e){this.m_subscription.setSubscribed(this.subId,t,e),this.m_strategy.evtOnSUB(t,e,null,null,null)},doSUBCMD:function(t,e,s,i){this.m_subscription.setSubscribedCMD(this.subId,t,e,s,i),this.m_strategy.evtOnSUB(t,e,s,i,this.m_currentMaxFrequency)},doUNSUB:function(){this.m_strategy.evtOnUNSUB()},doU:function(t,e){if(t>oe.sure(this.m_subscription.fetch_nItems()))throw new ne("Assertion failure: itemIdx <= m_subscription.fetch_nItems().sure()");this.m_strategy.evtUpdate(t,e)},doEOS:function(t){this.m_strategy.evtOnEOS(t),this.m_subscription.fireOnEndOfSnapshot(t,this.subId)},doCS:function(t){this.m_strategy.evtOnCS(t),this.m_subscription.fireOnClearSnapshot(t,this.subId)},doOV:function(t,e){this.m_subscription.fireOnLostUpdates(t,e,this.subId)},doCONF:function(t){this.m_strategy.evtOnCONF(t)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("sub#"+t+"("+this.subId+") in "+l.string(this.state))},__class__:Rt};var It=function(t,e){this.s_m=1,this.subId=t,this.lock=e.lock,this.m_client=e,e.relateSubManager(this)};It.__name__=!0,It.__interfaces__=[wt],It.prototype={finalize:function(){this.m_client.unrelateSubManager(this)},evtExtAbort:function(){this.traceEvent("abort"),2==this.s_m&&(this.finalize(),this.goto(3))},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtSUBOK:function(t,e){this.traceEvent("SUBOK"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtSUBCMD:function(t,e,s,i){this.traceEvent("SUBCMD"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtUNSUB:function(){this.traceEvent("UNSUB"),2==this.s_m&&(this.finalize(),this.goto(3))},evtU:function(t,e){this.traceEvent("U"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtEOS:function(t){this.traceEvent("EOS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCS:function(t){this.traceEvent("CS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtOV:function(t,e){this.traceEvent("OV"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCONF:function(t){this.traceEvent("CONF"),1==this.s_m&&(this.goto(2),this.genSendControl())},isPending:function(){return 2==this.s_m},encode:function(t){if(this.isPending())return this.encodeDelete(t);throw new ne("Can't encode unsubscription request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},genSendControl:function(){this.m_client.evtSendControl(this)},encodeDelete:function(t){var e=new ye;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),e.LS_cause("zombie"),Ds.isInfoEnabled()&&Ds.info("Sending Subscription delete: "+l.string(e)),e.getEncodedString()},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("zsub#"+t+"("+this.subId+") in "+this.s_m)},goto:function(t){this.s_m=t,Ns.isTraceEnabled()&&Ns.trace("zsub#goto("+this.subId+") "+this.s_m)},__class__:It};var Ct=function(){};Ct.__name__=!0,Ct.__interfaces__=[w],Ct.prototype={__class__:Ct};var xt=function(t,e,s,i){this.m_subId=i,this.itemIdx=t,this.subscription=e,this.client=s,this.lock=s.lock};xt.__name__=!0,xt.prototype={finalize:function(){},evtUpdate:function(t){this.fatalError()},evtOnEOS:function(){this.fatalError()},evtOnCS:function(){this.fatalError()},evtDispose:function(t){this.fatalError()},getValue:function(t){return null!=this.currValues?Ht.toString(this.currValues.h[t]):null},getCommandValue:function(t,e){throw new ne("Unsupported operation")},fatalError:function(){throw new ne("Unsupported operation")},doFirstUpdate:function(t){this.doUpdate(t,!1)},doUpdate0:function(t){this.doUpdate(t,!1)},doFirstSnapshot:function(t){this.doUpdate(t,!0)},doSnapshot:function(t){this.doUpdate(t,!0)},doUpdate:function(t,e){var s=this.currValues;this.currValues=Kt(s,t);var i=Vt(s,this.currValues),n=new qt(this.itemIdx,this.subscription,this.currValues,i,e);this.subscription.fireOnItemUpdate(n,this.m_subId)},__class__:xt};var Lt=function(t,e,s,i){this.keys=new as,xt.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};Lt.__name__=!0,Lt.__super__=xt,Lt.prototype=n(xt.prototype,{finalize:function(){},unrelate:function(t){var e=this.keys;Object.prototype.hasOwnProperty.call(e.h,t)&&delete e.h[t]},evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){throw new ne("Unsupported method")},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),this.genDisposeKeys(),t.unrelate(this.itemIdx)}},getCommandValue:function(t,e){var s=this.keys.h[t];return null!=s?s.getCommandValue(e):null},createKey:function(t){throw new ne("Abstract method")},doUpdate:function(t,e){this.currValues=Kt(this.currValues,t),this.selectKey().evtUpdate(this.currValues,e)},genDisposeKeys:function(){for(var t=as.createCopy(this.keys.h).h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtDispose()},selectKey:function(){var t=this.currValues,e=this.subscription.getKeyPosition(),s=Ht.toString(t.h[e]);return null==(e=this.keys.h[s])&&(e=this.createKey(s),this.keys.h[s]=e),e},goto:function(t){this.s_m=t,Ns.isTraceEnabled()&&Ns.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Lt});var Dt=function(t,e,s,i){Lt.call(this,t,e,s,i)};Dt.__name__=!0,Dt.__super__=Lt,Dt.prototype=n(Lt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys()}},createKey:function(t){return new At(t,this)},__class__:Dt});var Nt=function(t,e,s,i,n){Lt.call(this,t,e,i,n),this.strategy=s};Nt.__name__=!0,Nt.__super__=Lt,Nt.prototype=n(Lt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys(),this.genOnRealMaxFrequency2LevelRemoved()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},createKey:function(t){return new Wt(t,this)},genSetRequestedMaxFrequency:function(){for(var t=this.keys.h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtSetRequestedMaxFrequency()},genOnRealMaxFrequency2LevelRemoved:function(){this.strategy.evtOnRealMaxFrequency2LevelRemoved()},__class__:Nt});var Ot=function(t,e,s,i){xt.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};Ot.__name__=!0,Ot.__super__=xt,Ot.prototype=n(xt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ns.isTraceEnabled()&&Ns.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Ot});var Mt=function(){};Mt.__name__=!0,Mt.__isInterface__=!0,Mt.prototype={__class__:Mt};var Pt=function(t,e,s,i){this.s_m=1,xt.call(this,t,e,s,i)};Pt.__name__=!0,Pt.__super__=xt,Pt.prototype=n(xt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.subscription.hasSnapshot()?(this.doSnapshot(t),this.goto(2)):(this.doFirstUpdate(t),this.goto(3));break;case 2:case 3:this.doUpdate0(t),this.goto(3)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(4),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ns.isTraceEnabled()&&Ns.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Pt});var kt=function(t,e,s,i){this.s_m=1,xt.call(this,t,e,s,i)};kt.__name__=!0,kt.__super__=xt,kt.prototype=n(xt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ns.isTraceEnabled()&&Ns.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ns.isTraceEnabled()&&Ns.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:kt});var Ft=function(t,e,s,i,n){var r=e.fetch_items(),a=e.fetch_fields(),o=e.fetch_fields2();this.m_itemIdx=t,this.m_items=Gt(r),this.m_nFields=oe.sure(e.fetch_nFields()),this.m_fields=Gt(a),this.m_fields2=Gt(o),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n};Ft.__name__=!0,Ft.__super__=Ct,Ft.prototype=n(Ct.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(l.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(l.string(t))},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(this.getFieldNameFromIdx(s),s,Ht.toString(this.m_newValues.h[s]))}catch(t){var i=g.caught(t);Ms.isErrorEnabled()&&Ms.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(this.getFieldNameFromIdx(i),i,Ht.toString(n))}catch(t){var r=g.caught(t);Ms.isErrorEnabled()&&Ms.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){return Ht.toString(this.m_newValues.h[t])},getValueName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new ne(As);var e=this.getFieldIdxFromName(t);if(null==e)throw new b(Bs);return Ht.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){return this.m_changedFields.contains(t)},isValueChangedName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new ne(As);var e=this.getFieldIdxFromName(t);if(null==e)throw new b(Bs);return this.m_changedFields.contains(e)},getFieldNameFromIdx:function(t){return t<=this.m_nFields?null!=this.m_fields?this.m_fields.h[t]:null:null!=this.m_fields2?this.m_fields2.h[t-this.m_nFields]:null},getFieldIdxFromName:function(t){var e,s,i=this.m_fields;return null!=i&&null!=(s=zt(oe.sure(i),t))?s:null!=(e=this.m_fields2)&&null!=(s=zt(oe.sure(e),t))?this.m_nFields+oe.sure(s):null},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameFromIdx(i),a=null!=r?r:null==i?"null":""+i,o=l.string(n);i>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:Ft});var qt=function(t,e,s,i,n){var r=e.fetch_items(),a=e.fetch_fields();this.m_itemIdx=t,this.m_items=Gt(r),this.m_nFields=oe.sure(e.fetch_nFields()),this.m_fields=Gt(a),null!=a&&a.length!=this.m_nFields&&ks.isErrorEnabled()&&ks.error("Expected "+this.m_nFields+" field names but got "+a.length+": "+l.string(a)),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n};qt.__name__=!0,qt.__super__=Ct,qt.prototype=n(Ct.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(l.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(l.string(t))},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(null!=this.m_fields?this.m_fields.h[s]:null,s,Ht.toString(this.m_newValues.h[s]))}catch(t){var i=g.caught(t);Ms.isErrorEnabled()&&Ms.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(null!=this.m_fields?this.m_fields.h[i]:null,i,Ht.toString(n))}catch(t){var r=g.caught(t);Ms.isErrorEnabled()&&Ms.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new b(Ws);return Ht.toString(this.m_newValues.h[t])},getValueName:function(t){var e=this.getFieldIdxFromName(t);return Ht.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new b(Ws);return this.m_changedFields.contains(t)},isValueChangedName:function(t){var e=this.getFieldIdxFromName(t);return this.m_changedFields.contains(e)},getFieldNameOrNullFromIdx:function(t){return null!=this.m_fields?this.m_fields.h[t]:null},getFieldIdxFromName:function(t){if(null==this.m_fields)throw new ne(As);var e=zt(this.m_fields,t);if(null==e)throw new b(Bs);return e},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameOrNullFromIdx(i),a=null!=r?r:null==i?"null":""+i,o=l.string(n);i>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:qt});var At=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};At.__name__=!0,At.__interfaces__=[Mt],At.prototype={finalize:function(){this.currKeyValues=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:this.isDelete(t)?(this.doLightDelete(t,e),this.finalize(),this.goto(3)):(this.doFirstUpdate(t,e),this.goto(2));break;case 2:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(3)):(this.doUpdate(t,e),this.goto(2))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3)}},evtSetRequestedMaxFrequency:function(){},getCommandValue:function(t){return null!=this.currKeyValues?Ht.toString(this.currKeyValues.h[t]):null},doFirstUpdate:function(t,e){var s=oe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[i]=Ut.StringVal("ADD");var n=new be(new o(1,s+1));this.fireOnItemUpdate(new qt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=Ut.StringVal("UPDATE");var n=Vt(i,this.currKeyValues);this.fireOnItemUpdate(new qt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e))},doLightDelete:function(t,e){this.currKeyValues=null;var s=new be(t.keys()),i=new qt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},doDelete:function(t,e){this.currKeyValues=null;var s=new be(t.keys()).subtracting([this.item.subscription.getKeyPosition()]),i=new qt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},nullify:function(t){for(var e=new rs,s=t,i=s.keys();i.hasNext();){var n=i.next(),r=s.get(n),a=n==this.item.subscription.getCommandPosition()||n==this.item.subscription.getKeyPosition();e.h[n]=a?r:null}return e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==Ht.toString(t.h[e])},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(Ns.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;Ns.isTraceEnabled()&&Ns.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:At};var Wt=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};Wt.__name__=!0,Wt.__interfaces__=[Mt],Wt.prototype={finalize:function(){this.currKeyValues=null,this.currKey2Values=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:if(this.isDelete(t))this.doLightDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved();else{var s=this.create2LevelSubscription();null!=s?(this.doFirstUpdate(t,e),this.subscription2Level=s,this.goto(4),this.item.strategy.client.subscribeExt(s,!0)):(this.doFirstUpdate(t,e),this.notify2LevelIllegalArgument(),this.goto(3))}break;case 3:this.isDelete(t)?(this.doDelete1LevelOnly(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(3));break;case 4:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(4));break;case 5:this.isDelete(t)?(this.doDeleteExt(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate1Level(t,e),this.goto(5))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(10);break;case 4:case 5:this.doUnsubscribe(),this.finalize(),this.goto(12)}},evtOnSubscriptionError2Level:function(t,e){this.traceEvent("onSubscriptionError2Level"),4==this.s_m&&(this.notify2LevelSubscriptionError(t,e),this.goto(3))},evtUpdate2Level:function(t){switch(this.traceEvent("update2Level"),this.s_m){case 4:case 5:this.doUpdate2Level(t),this.goto(5)}},evtOnUnsubscription2Level:function(){switch(this.traceEvent("onUnsubscription2Level"),this.s_m){case 4:case 5:this.doUnsetRealMaxFrequency(),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelRemoved()}},evtOnItemLostUpdates2Level:function(t){switch(this.traceEvent("onItemLostUpdates2Level"),this.s_m){case 4:case 5:this.goto(this.s_m),this.notify2LevelLostUpdates(t)}},evtOnRealMaxFrequency2Level:function(t){switch(this.traceEvent("onRealMaxFrequency2Level"),this.s_m){case 4:case 5:this.doSetRealMaxFrequency(t),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelAdded()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 4:case 5:this.doChangeRequestedMaxFrequency(),this.goto(this.s_m)}},getCommandValue:function(t){if(null!=(e=this.currKeyValues)&&null!=e.h[t])return Ht.toString(e.h[t]);var e=this.currKey2Values,s=this.item.subscription.fetch_nFields();return null!=e&&null!=s?e.h[t-s]:null},doFirstUpdate:function(t,e){var s=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[s]=Ut.StringVal("ADD");var i=Vt(null,this.currKeyValues);this.fireOnItemUpdate(new Ft(this.item.itemIdx,this.item.subscription,this.currKeyValues,i,e))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=Ut.StringVal("UPDATE");var n=Vt(i,this.currKeyValues);this.fireOnItemUpdate(new Ft(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e))},doUpdate2Level:function(t){var e=this.item.subscription.getCommandPosition(),s=oe.sure(this.item.subscription.fetch_nFields()),i=oe.sure(this.currKeyValues).copy();this.currKeyValues.h[e]=Ut.StringVal("UPDATE"),this.currKey2Values=Yt(t);for(var n=oe.sure(this.currKeyValues).copy(),r=(h=this.currKey2Values).keys();r.hasNext();){var a=r.next(),o=h.get(a);n.h[a+s]=null==o?null:Ut.StringVal(o)}var h,c=new be;for(Ht.toString(i.h[e])!=Ht.toString(this.currKeyValues.h[e])&&c.insert(e),r=(h=Qt(t)).keys();r.hasNext();)a=r.next(),h.get(a),c.insert(a+s);var l=t.isSnapshot();this.fireOnItemUpdate(new Ft(this.item.itemIdx,this.item.subscription,n,c,l))},doUpdate1Level:function(t,e){var s=this.item.subscription.getCommandPosition(),i=oe.sure(this.item.subscription.fetch_nFields()),n=oe.sure(this.currKeyValues);this.currKeyValues=t,this.currKeyValues.h[s]=Ut.StringVal("UPDATE");for(var r=oe.sure(this.currKeyValues).copy(),a=oe.sure(this.currKey2Values),o=a.keys();o.hasNext();){var h=o.next(),c=a.get(h);r.h[h+i]=null==c?null:Ut.StringVal(c)}for(var l=new be,u=1,_=i+1;u<_;){var d=u++;Ht.toString(n.h[d])!=Ht.toString(r.h[d])&&l.insert(d)}this.fireOnItemUpdate(new Ft(this.item.itemIdx,this.item.subscription,r,l,e))},doDelete:function(t,e){var s=oe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new be(new o(1,s+1)).subtracting([i]),a=new rs,h=1,c=s+1;h<c;)a.h[h++]=null;a.h[i]=Ut.StringVal(this.keyName),a.h[n]=Ut.StringVal("DELETE");var l=new Ft(this.item.itemIdx,this.item.subscription,a,r,e);this.item.unrelate(this.keyName);var u=oe.sure(this.subscription2Level);u.removeListener(oe.sure(this.listener2Level)),oe.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(u),this.fireOnItemUpdate(l)},doDeleteExt:function(t,e){var s=oe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition(),r=s+h.count(oe.sure(this.currKey2Values));this.currKeyValues=null,this.currKey2Values=null;for(var a=new be(new o(1,r+1)).subtracting([i]),c=new rs,l=1,u=r+1;l<u;)c.h[l++]=null;c.h[i]=Ut.StringVal(this.keyName),c.h[n]=Ut.StringVal("DELETE");var _=new Ft(this.item.itemIdx,this.item.subscription,c,a,e);this.item.unrelate(this.keyName);var d=oe.sure(this.subscription2Level);d.removeListener(oe.sure(this.listener2Level)),oe.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(d),this.fireOnItemUpdate(_)},doLightDelete:function(t,e){var s=oe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new be(new o(1,s+1)),a=new rs,h=1,c=s+1;h<c;)a.h[h++]=null;a.h[i]=t.h[i],a.h[n]=t.h[n],this.fireOnItemUpdate(new Ft(this.item.itemIdx,this.item.subscription,a,r,e))},doDelete1LevelOnly:function(t,e){var s=oe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new be(new o(1,s+1)).subtracting([i]),a=new rs,h=1,c=s+1;h<c;)a.h[h++]=null;a.h[i]=t.h[i],a.h[n]=t.h[n],this.fireOnItemUpdate(new Ft(this.item.itemIdx,this.item.subscription,a,r,e))},doChangeRequestedMaxFrequency:function(){oe.sure(this.subscription2Level).setRequestedMaxFrequency(We.toString(this.item.strategy.requestedMaxFrequency))},doSetRealMaxFrequency:function(t){this.realMaxFrequency=t},doUnsetRealMaxFrequency:function(){this.realMaxFrequency=null},genOnRealMaxFrequency2LevelAdded:function(){this.item.strategy.evtOnRealMaxFrequency2LevelAdded(this.realMaxFrequency)},genOnRealMaxFrequency2LevelRemoved:function(){this.item.strategy.evtOnRealMaxFrequency2LevelRemoved()},doUnsubscribe:function(){if(null==this.subscription2Level)throw new ne("Assertion failure: subscription2Level != null");if(null==this.listener2Level)throw new ne("Assertion failure: listener2Level != null");var t=this.subscription2Level;t.removeListener(this.listener2Level),this.listener2Level.disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(t)},notify2LevelIllegalArgument:function(){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,14,"The received key value is not a valid name for an Item",this.item.m_subId,this.item.itemIdx)},notify2LevelSubscriptionError:function(t,e){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,t,e,this.item.m_subId,this.item.itemIdx)},notify2LevelLostUpdates:function(t){this.item.subscription.fireOnLostUpdates2Level(this.keyName,t,this.item.m_subId,this.item.itemIdx)},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},create2LevelSubscription:function(){this.listener2Level=new Bt(this);var t=this.item.subscription,e=new N("MERGE",null,null),s=[this.keyName];if(!Ve.allValidNames(s))return null;e.setItems(s.slice());var i=t.getCommandSecondLevelFields();return null!=i?e.setFields(i):e.setFieldSchema(t.getCommandSecondLevelFieldSchema()),e.setDataAdapter(t.getCommandSecondLevelDataAdapter()),e.setRequestedSnapshot(qe.toString(Fe.SnpYes)),e.setRequestedMaxFrequency(We.toString(this.item.strategy.requestedMaxFrequency)),e.addListener(oe.sure(this.listener2Level)),e.setInternal(),e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==Ht.toString(t.h[e])},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(Ns.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;Ns.isTraceEnabled()&&Ns.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:Wt};var Bt=function(t){this.m_disabled=!1,this.key=t};Bt.__name__=!0,Bt.__interfaces__=[T],Bt.prototype={disable:function(){var t=this;this.key.lock.synchronized((function(){return t.m_disabled=!0}))},synchronized:function(t){var e=this;this.key.lock.synchronized((function(){e.m_disabled||t()}))},onSubscriptionError:function(t,e){var s=this;this.synchronized((function(){s.key.evtOnSubscriptionError2Level(t,e)}))},onItemUpdate:function(t){var e=this;this.synchronized((function(){e.key.evtUpdate2Level(t)}))},onItemLostUpdates:function(t,e,s){var i=this;this.synchronized((function(){i.key.evtOnItemLostUpdates2Level(s)}))},onRealMaxFrequency:function(t){var e=this;this.synchronized((function(){var s,i=e.key;if(null==t)s=null;else if(null==t){var n=parseFloat(t);s=isNaN(n)?null:Be.RFreqLimited(n)}else"unlimited"==t?s=Be.RFreqUnlimited:(n=parseFloat(t),s=isNaN(n)?null:Be.RFreqLimited(n));i.evtOnRealMaxFrequency2Level(s)}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.key.evtOnUnsubscription2Level()}))},onClearSnapshot:function(t,e){},onCommandSecondLevelItemLostUpdates:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onEndOfSnapshot:function(t,e){},onListenEnd:function(t){},onListenStart:function(t){},onSubscription:function(){},__class__:Bt};var Ut=i["com.lightstreamer.client.internal.update.CurrFieldVal"]={__ename__:!0,__constructs__:null,StringVal:(e=function(t){return{_hx_index:0,string:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:s}},e._hx_name="StringVal",e.__params__=["string"],e)};Ut.__constructs__=[Ut.StringVal];var Ht=function(){};function Kt(t,e){if(null!=t){for(var s=new rs,i=(h=e).keys();i.hasNext();){var n=i.next();switch((c=h.get(n))._hx_index){case 0:s.h[n]=t.h[n];break;case 1:var r=c.val;s.h[n]=null==r?null:Ut.StringVal(r);break;case 2:var a=t.h[n];if(null==a)throw new ne("Cannot apply the TLCP-diff to the field "+n+" because the field is null");if(0==a._hx_index){var o=Ut.StringVal(new Je(a.string,c.patch).decode());s.h[n]=o}}}return s}var h;for(s=new rs,i=(h=e).keys();i.hasNext();){var c;switch(n=i.next(),(c=h.get(n))._hx_index){case 0:throw new ne("Cannot set the field "+n+" because the first update is UNCHANGED");case 1:r=c.val,s.h[n]=null==r?null:Ut.StringVal(r);break;case 2:throw new ne("Cannot set the field "+n+" because the first update is a TLCP-diff")}}return s}function Vt(t,e){if(null!=t){for(var s=new be,i=(r=e).keys();i.hasNext();){var n=i.next();r.get(n),Ht.toString(t.h[n])!=Ht.toString(e.h[n])&&s.insert(n)}return s}var r;for(s=new be,i=(r=e).keys();i.hasNext();)n=i.next(),r.get(n),s.insert(n);return s}function Gt(t){if(null!=t){for(var e=new rs,s=0;s<t.length;){var i=t[s++];e.h[s-1+1]=i}return e}return null}function zt(t,e){for(var s=1,i=h.count(t)+1;s<i;){var n=s++;if(t.h[n]==e)return n}return null}function Yt(t){var e=new rs;return t.forEachField((function(t,s,i){e.h[s]=i})),e}function Qt(t){var e=new rs;return t.forEachChangedField((function(t,s,i){e.h[s]=i})),e}Ht.__name__=!0,Ht.toString=function(t){return null==t?null:0===t._hx_index?t.string:void 0};var jt=function(){};jt.__name__=!0,jt.prototype={submit:function(t){Ks(t)},schedule:function(t,e){return new $t(Us(t,e))},stop:function(){},__class__:jt};var $t=function(t){this.handle=t};$t.__name__=!0,$t.prototype={isCanceled:function(){return null==this.handle},cancel:function(){null!=this.handle&&(Hs(this.handle),this.handle=null)},__class__:$t};var Jt=function(){this.hasMicroTasks=void 0!==t.queueMicrotask,this.hasWorkers="undefined"!=typeof Worker};Jt.__name__=!0,Jt.prototype={toString:function(){return"{ hasWorkers: "+l.string(this.hasWorkers)+", hasMicroTasks: "+l.string(this.hasMicroTasks)+" }"},__class__:Jt};var Zt=function(){};Zt.__name__=!0,Zt.__isInterface__=!0,Zt.prototype={__class__:Zt};var Xt=function(t,e,s,i,n,r,a){this.isCanceled=!1,this.reader=new Ee;var o=this;if(Ls.isDebugEnabled()&&Ls.debug("HTTP sending: "+t+" "+e+" headers("+(null==s?"null":as.stringify(s.h))+")"),this.xhr=new XMLHttpRequest,this.xhr.open("POST",t),this.xhr.withCredentials=i,null!=s)for(var h=s.h,c=Object.keys(h),l=c.length,u=0;u<l;){var _=c[u++];this.xhr.setRequestHeader(_,h[_])}this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xhr.send(e),this.xhr.onreadystatechange=function(){if(!o.isCanceled){var t=o.xhr.readyState;if(2==t){var e=o.xhr.status;0==e||e>=200&&e<300||(Ls.isDebugEnabled()&&Ls.debug("HTTP event: error(HTTP code "+e+")"),r(o,"Unexpected HTTP code: "+e),o.xhr.abort())}else if(t>2){for(var s=3==t?o.reader.extractNewData(o.xhr.responseText,!1):o.reader.extractNewData(o.xhr.responseText,!0),i=0;i<s.length;){var h=s[i];if(++i,o.isCanceled)return;""!=h&&(Ls.isDebugEnabled()&&Ls.debug("HTTP event: text("+h+")"),n(o,h))}4==t&&(Ls.isDebugEnabled()&&Ls.debug("HTTP event: complete"),a(o))}}},this.xhr.onerror=function(){o.isCanceled||(Ls.isDebugEnabled()&&Ls.debug("HTTP event: error(Network error)"),r(o,"Network error"))}};Xt.__name__=!0,Xt.__interfaces__=[Zt],Xt.prototype={dispose:function(){Ls.isDebugEnabled()&&Ls.debug("HTTP disposing"),this.isCanceled=!0,this.xhr.abort()},isDisposed:function(){return this.isCanceled},__class__:Xt};var te={_new:function(){return new as},set:function(t,e,s){null!=s&&(t.h[e]=null==s?"null":l.string(s))}},ee=function(){this.values=[],this.nRemoved=0};ee.__name__=!0,ee.prototype={get_length:function(){return this.values.length-this.nRemoved},compact:function(){this.nRemoved>this.values.length/2&&(this.nRemoved=0,this.values=this.copy().values)},push:function(t){this.values.push(new se(t))},remove:function(t){for(var e=0,s=this.values.length;e<s;){var i=e++;if(this.values[i].item==t&&this.values[i].isValid){this.nRemoved++,this.values[i].isValid=!1;break}}},filter:function(t){for(var e=new ee,s=new ie(this);s.hasNext();){var i=s.next();t(i)&&e.values.push(new se(i))}return e},map:function(t){for(var e=new ee,s=new ie(this);s.hasNext();){var i=t(s.next());e.values.push(new se(i))}return e},exists:function(t){return h.exists(this,t)},find:function(t){return h.find(this,t)},contains:function(t){return h.has(this,t)},iterator:function(){return new ie(this)},copy:function(){for(var t=new ee,e=new ie(this);e.hasNext();){var s=e.next();t.values.push(new se(s))}return t},toString:function(){for(var t=0,e=this.values.length-this.nRemoved,s="[",i=new ie(this);i.hasNext();)s+=l.string(i.next())+(t!=e-1?", ":""),++t;return s+"]"},__class__:ee};var se=function(t){this.isValid=!0,this.item=t};se.__name__=!0,se.prototype={__class__:se};var ie=function(t){this.a=t,this.index=0};ie.__name__=!0,ie.prototype={hasNext:function(){for(var t=this.index,e=this.a.values.length;t<e;)if(this.a.values[t++].isValid)return!0;return!1},next:function(){for(var t=this.index,e=this.a.values.length;t<e;){var s=t++;if(this.a.values[s].isValid)return this.index=s+1,this.a.values[s].item}throw new g("No such element")},__class__:ie};var ne=function(t,e,s){g.call(this,t,e,s),this.__skipStack++};ne.__name__=!0,ne.__super__=g,ne.prototype=n(g.prototype,{__class__:ne});var re={fromHaxeMap:function(t){return re.fromMapToDynamicAccess(t)},toHaxeMap:function(t){return re.toHaxe(t)},fromMapToDynamicAccess:function(t){for(var e={},s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var a=i[r++];e[a]=s[a]}return e},toHaxe:function(t){for(var e=new as,s=c.fields(t),i=0;i<s.length;){var n=s[i++];e.h[n]=t[n]}return e},toDynamicAccess:function(t){return c.copy(t)}},ae={fromHaxeArray:function(t){return t.slice()},toHaxeArray:function(t){return ae.copy(t,t)},_new:function(t){return t.slice()},toHaxe:function(t){return ae.copy(t,t)},copy:function(t,e){for(var s=[],i=0,n=e.length;i<n;)s[i]=e[i],++i;return s}},oe=function(){};oe.__name__=!0,oe.sure=function(t){if(null==t)throw g.thrown("null pointer in .sure() call");return t},oe.or=function(t,e){return null==t?e:t};var he=function(){};he.__name__=!0,he.__isInterface__=!0,he.prototype={__class__:he};var ce=function(){this._innerMap=new rs,this._orderedKeys=new ee};ce.__name__=!0,ce.__interfaces__=[he],ce.prototype={compact:function(){this._orderedKeys.compact()},set:function(t,e){this._innerMap.h.hasOwnProperty(t)||this._orderedKeys.values.push(new se(t)),this._innerMap.h[t]=e},get:function(t){return this._innerMap.h[t]},exists:function(t){return this._innerMap.h.hasOwnProperty(t)},remove:function(t){var e=this._innerMap.remove(t);return e&&this._orderedKeys.remove(t),e},keys:function(){return new ie(this._orderedKeys)},iterator:function(){return new le(this)},keyValueIterator:function(){return new us(this)},copy:function(){var t=new ce;return t._orderedKeys=this._orderedKeys.copy(),t._innerMap=this._innerMap.copy(),t},get_length:function(){var t=this._orderedKeys;return t.values.length-t.nRemoved},get_orderedKeys:function(){return this._orderedKeys},keysCopy:function(){return this._orderedKeys.copy()},clear:function(){this._orderedKeys=new ee,this._innerMap=new rs},toString:function(){for(var t=0,e=this._orderedKeys,s=e.values.length-e.nRemoved,i="[",n=new ie(this._orderedKeys);n.hasNext();){var r=n.next();i+=r+" => "+l.string(this._innerMap.h[r])+(t!=s-1?", ":""),++t}return i+"]"},__class__:ce};var le=function(t){this.map=t,this.it=new ie(t._orderedKeys)};le.__name__=!0,le.prototype={hasNext:function(){return this.it.hasNext()},next:function(){var t=this.map,e=this.it.next();return t._innerMap.h[e]},__class__:le};var ue=function(){};ue.__name__=!0,ue.__isInterface__=!0,ue.prototype={__class__:ue};var _e=function(){};_e.__name__=!0,_e.__isInterface__=!0,_e.prototype={__class__:_e};var de=i["com.lightstreamer.internal.ReachabilityStatus"]={__ename__:!0,__constructs__:null,RSReachable:{_hx_name:"RSReachable",_hx_index:0,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:s},RSNotReachable:{_hx_name:"RSNotReachable",_hx_index:1,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:s}};de.__constructs__=[de.RSReachable,de.RSNotReachable];var fe=function(){};fe.__name__=!0,fe.__isInterface__=!0,fe.prototype={__class__:fe};var me=i["com.lightstreamer.internal.PageState"]={__ename__:!0,__constructs__:null,Frozen:{_hx_name:"Frozen",_hx_index:0,__enum__:"com.lightstreamer.internal.PageState",toString:s},Resumed:{_hx_name:"Resumed",_hx_index:1,__enum__:"com.lightstreamer.internal.PageState",toString:s}};me.__constructs__=[me.Frozen,me.Resumed];var pe=function(){};pe.__name__=!0,pe.__isInterface__=!0,pe.prototype={__class__:pe};var ge=function(t){this.connectionOptions=t.connectionOptions};ge.__name__=!0,ge.__interfaces__=[pe],ge.prototype={createWsClient:function(t,e,s,i,n){return new $e(t,s,i,n)},createHttpClient:function(t,e,s,i,n,r){return new Xt(t,e,s,this.connectionOptions.isCookieHandlingRequired(),i,n,r)},createCtrlClient:function(t,e,s,i,n,r){return this.createHttpClient(t,e,s,i,n,r)},createReachabilityManager:function(t){return new ve},createTimer:function(t,e,s){return new Re(t,e,s)},randomMillis:function(t){return l.random(t)},createPageLifecycleFactory:function(t){return new M(t)},__class__:ge};var ve=function(){};ve.__name__=!0,ve.__interfaces__=[fe],ve.prototype={startListening:function(t){m.get_supported()&&(window.ononline=function(){t(de.RSReachable)},window.onoffline=function(){t(de.RSNotReachable)})},stopListening:function(){m.get_supported()&&(window.ononline=null,window.onoffline=null)},__class__:ve};var Se=function(t,e){this.key=t,this.val=e};Se.__name__=!0,Se.prototype={toEncodedPair:function(){var t=this.key,e=encodeURIComponent(t)+"=";return t=this.val,e+encodeURIComponent(t)},toString:function(){return this.key+"="+this.val},__class__:Se};var ye=function(){this.params=[]};ye.__name__=!0,ye.prototype={LS_reqId:function(t){this.addParamAny("LS_reqId",t)},LS_message:function(t){this.addParamString("LS_message",t)},LS_sequence:function(t){this.addParamString("LS_sequence",t)},LS_msg_prog:function(t){this.addParamAny("LS_msg_prog",t)},LS_max_wait:function(t){this.addParamAny("LS_max_wait",t)},LS_outcome:function(t){this.addParamBool("LS_outcome",t)},LS_ack:function(t){this.addParamBool("LS_ack",t)},LS_op:function(t){this.addParamString("LS_op",t)},LS_subId:function(t){this.addParamAny("LS_subId",t)},LS_mode:function(t){this.addParamString("LS_mode",t)},LS_group:function(t){this.addParamString("LS_group",t)},LS_schema:function(t){this.addParamString("LS_schema",t)},LS_data_adapter:function(t){this.addParamString("LS_data_adapter",t)},LS_requested_max_frequency:function(t){this.addParamString("LS_requested_max_frequency",t)},LS_requested_max_frequency_Float:function(t){this.addParamAny("LS_requested_max_frequency",t)},LS_requested_buffer_size:function(t){this.addParamString("LS_requested_buffer_size",t)},LS_requested_buffer_size_Int:function(t){this.addParamAny("LS_requested_buffer_size",t)},LS_cause:function(t){this.addParamString("LS_cause",t)},LS_keepalive_millis:function(t){this.addParamAny("LS_keepalive_millis",t)},LS_inactivity_millis:function(t){this.addParamAny("LS_inactivity_millis",t)},LS_requested_max_bandwidth:function(t){this.addParamString("LS_requested_max_bandwidth",t)},LS_requested_max_bandwidth_Float:function(t){this.addParamAny("LS_requested_max_bandwidth",t)},LS_adapter_set:function(t){this.addParamString("LS_adapter_set",t)},LS_user:function(t){this.addParamString("LS_user",t)},LS_password:function(t){this.addParamString("LS_password",t)},LS_cid:function(t){this.addParamString("LS_cid",t)},LS_old_session:function(t){this.addParamString("LS_old_session",t)},LS_session:function(t){this.addParamString("LS_session",t)},LS_send_sync:function(t){this.addParamBool("LS_send_sync",t)},LS_polling:function(t){this.addParamBool("LS_polling",t)},LS_polling_millis:function(t){this.addParamAny("LS_polling_millis",t)},LS_idle_millis:function(t){this.addParamAny("LS_idle_millis",t)},LS_content_length:function(t){this.addParamAny("LS_content_length",t)},LS_ttl_millis:function(t){this.addParamString("LS_ttl_millis",t)},LS_recovery_from:function(t){this.addParamAny("LS_recovery_from",t)},LS_close_socket:function(t){this.addParamBool("LS_close_socket",t)},LS_selector:function(t){this.addParamString("LS_selector",t)},LS_snapshot:function(t){this.addParamBool("LS_snapshot",t)},LS_snapshot_Int:function(t){this.addParamAny("LS_snapshot",t)},addParamString:function(t,e){this.params.push(new Se(t,e))},addParamAny:function(t,e){this.addParamString(t,""+(null==e?"null":l.string(e)))},addParamBool:function(t,e){this.addParamString(t,e?"true":"false")},getEncodedString:function(){for(var t=this.params,e=new Array(t.length),s=0,i=t.length;s<i;){var n=s++;e[n]=t[n].toEncodedPair()}return e.join("&")},toString:function(){return this.params.join(" ")},__class__:ye};var be=function(t){if(this.values=[],null!=t)for(;t.hasNext();)this.insert(t.next())};be.__name__=!0,be.prototype={count:function(){return this.values.length},insert:function(t){-1==this.values.indexOf(t)&&this.values.push(t)},contains:function(t){return-1!=this.values.indexOf(t)},remove:function(t){a.remove(this.values,t)},removeAll:function(){this.values.splice(0,this.values.length)},copy:function(){return new be(this.iterator())},union:function(t){for(var e=new be,s=0,i=this.values;s<i.length;)e.insert(i[s++]);for(s=0;s<t.length;)e.insert(t[s++]);return e},subtracting:function(t){for(var e=new be,s=0,i=this.values;s<i.length;){var n=i[s];++s,-1==t.indexOf(n)&&e.insert(n)}return e},iterator:function(){return new ls(this.values)},toArray:function(){return this.values},__class__:be};var Ee=function(){this.progress=0};Ee.__name__=!0,Ee.prototype={extractNewData:function(t,e){var s;if(e)s=t.length;else{if((s=t.lastIndexOf("\r\n"))<0)return[];s+=2}if(s<=this.progress)return[];var i=t.substring(this.progress,s);return this.progress=s,i.split("\r\n")},streamProgress:function(t){return this.extractNewData(t,!1)},streamComplete:function(t){return this.extractNewData(t,!0)},__class__:Ee};var we={_new:function(t){return t},toMillis:function(t){return t},toLong:function(t){return t}},Te={_new:function(t){return t},now:function(){return a.now()/1e3},plus:function(t,e){return 1e3*t+e},minus:function(t,e){return 1e3*(t-e)},toFloat:function(t){return t}},Re=function(t,e,s){var i=this;this.task=new $t(Us((function(){s(i)}),e))};Re.__name__=!0,Re.__interfaces__=[_e],Re.prototype={cancel:function(){this.task.cancel()},isCanceled:function(){return null==this.task.handle},__class__:Re};var Ie=v;function Ce(){var t=Vs.shift();if(null!=t)try{t()}catch(t){var e=g.caught(t);Ns.isErrorEnabled()&&Ns.error("Timer callback failed\n"+e.details())}else Ns.isErrorEnabled()&&Ns.error("Timer callback not found")}var xe=i["com.lightstreamer.internal.FieldValue"]={__ename__:!0,__constructs__:null,unchanged:{_hx_name:"unchanged",_hx_index:0,__enum__:"com.lightstreamer.internal.FieldValue",toString:s},changed:(e=function(t){return{_hx_index:1,val:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:s}},e._hx_name="changed",e.__params__=["val"],e),diffPatch:(e=function(t){return{_hx_index:2,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:s}},e._hx_name="diffPatch",e.__params__=["patch"],e)};xe.__constructs__=[xe.unchanged,xe.changed,xe.diffPatch];var Le={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new b("value must be greater than zero");return t},fromIntGtEq0:function(t){if(t<0)throw new b("value must be greater than or equal to zero");return t},gti:function(t,e){return t>e},gt:function(t,e){return t>e},lt:function(t,e){return t<e},plus:function(t,e){return t+e},minus:function(t,e){return t-e},toInt:function(t){return t}},De={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new b("value must be greater than zero");return t}},Ne={fromString:function(t){if(null==t)return null;switch(t){case"HTTP":return"HTTP";case"HTTP-POLLING":return"HTTP-POLLING";case"HTTP-STREAMING":return"HTTP-STREAMING";case"WS":return"WS";case"WS-POLLING":return"WS-POLLING";case"WS-STREAMING":return"WS-STREAMING";default:throw new b("The given value is not valid. Use one of: HTTP-STREAMING, HTTP-POLLING, WS-STREAMING, WS-POLLING, WS, HTTP or null")}}},Oe=i["com.lightstreamer.internal.RequestedMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(e=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:s}},e._hx_name="BWLimited",e.__params__=["bw"],e),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:s}};Oe.__constructs__=[Oe.BWLimited,Oe.BWUnlimited];var Me=function(){};Me.__name__=!0,Me.fromString=function(t){var e;if("unlimited"==t.toLowerCase())return Oe.BWUnlimited;if(e=parseFloat(t),!isNaN(e)&&e>0)return Oe.BWLimited(e);throw new b('The given value is a not valid value for RequestedMaxBandwidth. Use a positive number or the string "unlimited"')},Me.toString=function(t){switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited"}};var Pe=i["com.lightstreamer.internal.RequestedBufferSize"]={__ename__:!0,__constructs__:null,BSLimited:(e=function(t){return{_hx_index:0,size:t,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:s}},e._hx_name="BSLimited",e.__params__=["size"],e),BSUnlimited:{_hx_name:"BSUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:s}};Pe.__constructs__=[Pe.BSLimited,Pe.BSUnlimited];var ke=function(){};ke.__name__=!0,ke.fromString=function(t){if(null==t)return null;var e;if("unlimited"==t.toLowerCase())return Pe.BSUnlimited;if(null!=(e=l.parseInt(t))&&e>0)return Pe.BSLimited(e);throw new b("The given value is not valid for this setting; use null, 'unlimited' or a positive integer instead")},ke.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.size;return null==e?"null":""+e;case 1:return"unlimited"}},ke.extEquals=function(t,e){return null==t?null==e:null!=e&&d.enumEq(t,e)};var Fe=i["com.lightstreamer.internal.RequestedSnapshot"]={__ename__:!0,__constructs__:null,SnpYes:{_hx_name:"SnpYes",_hx_index:0,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:s},SnpNo:{_hx_name:"SnpNo",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:s},SnpLength:(e=function(t){return{_hx_index:2,len:t,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:s}},e._hx_name="SnpLength",e.__params__=["len"],e)};Fe.__constructs__=[Fe.SnpYes,Fe.SnpNo,Fe.SnpLength];var qe=function(){};qe.__name__=!0,qe.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"no":return Fe.SnpNo;case"yes":return Fe.SnpYes;default:if(null!=(e=l.parseInt(t))&&e>0)return Fe.SnpLength(e);throw new b("The given value is not valid for this setting; use null, 'yes', 'no' or a positive number instead")}},qe.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:return"yes";case 1:return"no";case 2:var e=t.len;return null==e?"null":""+e}};var Ae=i["com.lightstreamer.internal.RequestedMaxFrequency"]={__ename__:!0,__constructs__:null,FreqLimited:(e=function(t){return{_hx_index:0,max:t,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:s}},e._hx_name="FreqLimited",e.__params__=["max"],e),FreqUnlimited:{_hx_name:"FreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:s},FreqUnfiltered:{_hx_name:"FreqUnfiltered",_hx_index:2,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:s}};Ae.__constructs__=[Ae.FreqLimited,Ae.FreqUnlimited,Ae.FreqUnfiltered];var We=function(){};We.__name__=!0,We.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"unfiltered":return Ae.FreqUnfiltered;case"unlimited":return Ae.FreqUnlimited;default:if(e=parseFloat(t),!isNaN(e)&&e>0)return Ae.FreqLimited(e);throw new b("The given value is not valid for this setting; use null, 'unlimited', 'unfiltered' or a positive number instead")}},We.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.max;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unfiltered"}},We.extEquals=function(t,e){return null==t?null==e:null!=e&&d.enumEq(t,e)};var Be=i["com.lightstreamer.internal.RealMaxFrequency"]={__ename__:!0,__constructs__:null,RFreqLimited:(e=function(t){return{_hx_index:0,freq:t,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:s}},e._hx_name="RFreqLimited",e.__params__=["freq"],e),RFreqUnlimited:{_hx_name:"RFreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:s}};Be.__constructs__=[Be.RFreqLimited,Be.RFreqUnlimited];var Ue=i["com.lightstreamer.internal.RealMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(e=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:s}},e._hx_name="BWLimited",e.__params__=["bw"],e),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:s},BWUnmanaged:{_hx_name:"BWUnmanaged",_hx_index:2,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:s}};Ue.__constructs__=[Ue.BWLimited,Ue.BWUnlimited,Ue.BWUnmanaged];var He=function(){};He.__name__=!0,He.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unmanaged"}},He.eq=function(t,e){return null==t?null==e:null!=e&&d.enumEq(t,e)};var Ke={fromString:function(t){switch(t){case"COMMAND":return"COMMAND";case"DISTINCT":return"DISTINCT";case"MERGE":return"MERGE";case"RAW":return"RAW";default:throw new b("The given value is not a valid subscription mode. Admitted values are MERGE, DISTINCT, RAW, COMMAND")}}},Ve={_new:function(t){return t},getPos:function(t,e){var s=t.indexOf(e);return-1!=s?s+1:-1},allValidNames:function(t){return!h.exists(t,(function(t){return new r("^$| |^\\d+$","").match(t)}))},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new b("Item List is empty");if(Ve.allValidNames(t))return t;throw new b("Item List is invalid")}},Ge={_new:function(t){return t},getPos:function(t,e){var s=t.indexOf(e);return-1!=s?s+1:-1},hasKeyField:function(t){return-1!=t.indexOf("key")},hasCommandField:function(t){return-1!=t.indexOf("command")},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new b("Field List is empty");if(h.exists(t,(function(t){return new r("^$| ","").match(t)})))throw new b("Field List is invalid");return t}},ze={};function Ye(t){if(null==t)return"null";switch(t._hx_index){case 0:return""+t.freq;case 1:return"unlimited"}}function Qe(t,e){return null==t?null==e:null!=e&&d.enumEq(t,e)}ze._new=function(t){return t},ze.fromString=function(t){if(null==t)return null;if(""==t)throw new b("The value is empty");return t};var je=function(t,e){var s=t.indexOf("://");-1!=s?(this._protocol=t.substring(0,s)+":",t=t.substring(s+3)):this._protocol="";var i=t.indexOf("/");-1!=i?(this._pathname=t.substring(i),t=t.substring(0,i)):this._pathname="/";var n=this.extractPortStart(t);-1!=n?(this._port=t.substring(n),this._hostname=t.substring(0,n-1)):(this._port="",this._hostname=t),null!=e&&this.set_pathname(e)};je.__name__=!0,je.build=function(t,e){if(null!=e){var s=_.endsWith(t,"/"),i=_.startsWith(e,"/");t+=s?i?e.substring(1):e:i?e:"/"+e}return t},je.completeControlLink=function(t,e){var s=new je(e),i=new je(t);return""==i.get_protocol()&&i.set_protocol(s.get_protocol()),""==i.get_port()&&i.set_port(s.get_port()),i.get_href()},je.prototype={get_protocol:function(){return this._protocol},set_protocol:function(t){return""==t||_.endsWith(t,":")||(t+=":"),this._protocol=t,this._protocol},get_hostname:function(){return this._hostname},set_hostname:function(t){return this._hostname=t,this._hostname},get_port:function(){return this._port},set_port:function(t){return this._port=t,this._port},get_pathname:function(){return this._pathname},set_pathname:function(t){return _.startsWith(t,"/")||(t="/"+t),this._pathname=t,this._pathname},get_href:function(){var t=this._hostname;return""!=this._protocol&&(t=this._protocol+"//"+t),""!=this._port&&(t+=":"+this._port),""!=this.get_pathname()&&(t+=this._pathname),t},toString:function(){return this.get_href()},extractPortStart:function(t){var e=t.indexOf(":");return e<=-1?-1:t.indexOf("]")>-1?(e=t.indexOf("]:"))<=-1?-1:e+2:e!=t.lastIndexOf(":")?-1:e+1},__class__:je};var $e=function(t,e,s,i){this.isCanceled=!1;var n=this;_.startsWith(t,"https://")?t=_.replace(t,"https://","wss://"):_.startsWith(t,"http://")&&(t=_.replace(t,"http://","ws://")),Ls.isDebugEnabled()&&Ls.debug("WS connecting: "+t),this.ws=new WebSocket(t,Ts),this.ws.onopen=function(){n.isCanceled||(Ls.isDebugEnabled()&&Ls.debug("WS event: open"),e(n))},this.ws.onmessage=function(t){if(!n.isCanceled)for(var e=0,i=t.data.split("\r\n");e<i.length;){var r=i[e];if(++e,n.isCanceled)return;""!=r&&(Ls.isDebugEnabled()&&Ls.debug("WS event: text("+r+")"),s(n,r))}},this.ws.onerror=function(){n.isCanceled||(Ls.isDebugEnabled()&&Ls.debug("WS event: error(Network error)"),i(n,"Network error"),n.ws.close())},this.ws.onclose=function(t){if(!n.isCanceled){var e="unexpected disconnection: "+t.code+" - "+t.reason;Ls.isDebugEnabled()&&Ls.debug("WS event: error("+e+")"),i(n,e),n.ws.close()}}};$e.__name__=!0,$e.__interfaces__=[ue],$e.prototype={send:function(t){Ls.isDebugEnabled()&&Ls.debug("WS sending: "+t),this.ws.send(t)},dispose:function(){Ls.isDebugEnabled()&&Ls.debug("WS disposing"),this.isCanceled=!0,this.ws.close()},isDisposed:function(){return this.isCanceled},__class__:$e};var Je=function(t,e){this.buf=new u,this.basePos=0,this.diffPos=0,this.diff=e,this.base=t};Je.__name__=!0,Je.apply=function(t,e){return new Je(t,e).decode()},Je.prototype={decode:function(){try{for(;this.diffPos!=this.diff.length&&(this.applyCopy(),this.diffPos!=this.diff.length)&&(this.applyAdd(),this.diffPos!=this.diff.length);)this.applyDel();return this.buf.b}catch(t){throw new g("Bad TLCP-diff",g.caught(t))}},applyCopy:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.base,this.basePos,t),this.basePos+=t)},applyAdd:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.diff,this.diffPos,t),this.diffPos+=t)},applyDel:function(){var t=this.decodeVarint();t>0&&(this.basePos+=t)},decodeVarint:function(){for(var t=0;;){var e=this.charAt(this.diff,this.diffPos);if(this.diffPos+=1,e>=97&&e<123)return 26*t+(e-97);if(!(e>=65&&e<91))throw new g("The code point "+e+" is not in the range A-Z");t=26*t+(e-65)}},appendToBuf:function(t,e,s){if(!(e+s<=t.length))throw new g("Index out of range: startIndex="+e+" count="+s+" length="+t.length);this.buf.b+=null==s?a.substr(t,e,null):a.substr(t,e,s)},charAt:function(t,e){if(e<t.length)return a.cca(t.charAt(e),0);throw new g("Index out of range: pos="+e+" length="+t.length)},__class__:Je};var Ze=R.LSConsoleLogLevel=function(){};Ze.__name__=!0,Ze.prototype={__class__:Ze};var Xe=R.LSConsoleLoggerProvider=function(t){this.level=t};Xe.__name__=!0,Xe.__interfaces__=[y],Xe.prototype={getLogger:function(t){return new ts(this.level,t)},__class__:Xe};var ts=function(t,e){this.level=t,this.category=e,this.traceEnabled=t<=Ze.TRACE,this.debugEnabled=t<=Ze.DEBUG,this.infoEnabled=t<=Ze.INFO,this.warnEnabled=t<=Ze.WARN,this.errorEnabled=t<=Ze.ERROR,this.fatalEnabled=t<=Ze.FATAL};ts.__name__=!0,ts.__super__=P,ts.prototype=n(P.prototype,{printLog:function(e){t.console.log(e)},format:function(t,e){return a.dateStr(new Date)+"|"+t+"|"+this.category+"|"+e},logFatal:function(e){t.console.log(e)},logError:function(e){t.console.log(e)},logWarn:function(e){t.console.log(e)},logInfo:function(e){t.console.log(e)},logDebug:function(e){t.console.log(e)},logTrace:function(e){t.console.log(e)},fatal:function(e,s){if(this.fatalEnabled){var i=this.format("FATAL",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},error:function(e,s){if(this.errorEnabled){var i=this.format("ERROR",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},warn:function(e,s){if(this.warnEnabled){var i=this.format("WARN ",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},info:function(e,s){if(this.infoEnabled){var i=this.format("INFO ",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},debug:function(e,s){if(this.debugEnabled){var i=this.format("DEBUG",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},trace:function(e,s){if(this.traceEnabled){var i=this.format("TRACE",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},isFatalEnabled:function(){return this.fatalEnabled},isErrorEnabled:function(){return this.errorEnabled},isWarnEnabled:function(){return this.warnEnabled},isInfoEnabled:function(){return this.infoEnabled},isDebugEnabled:function(){return this.debugEnabled},isTraceEnabled:function(){return this.traceEnabled},__class__:ts});var es=i["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:s},Module:(e=function(t){return{_hx_index:1,m:t,__enum__:"haxe.StackItem",toString:s}},e._hx_name="Module",e.__params__=["m"],e),FilePos:(e=function(t,e,i,n){return{_hx_index:2,s:t,file:e,line:i,column:n,__enum__:"haxe.StackItem",toString:s}},e._hx_name="FilePos",e.__params__=["s","file","line","column"],e),Method:(e=function(t,e){return{_hx_index:3,classname:t,method:e,__enum__:"haxe.StackItem",toString:s}},e._hx_name="Method",e.__params__=["classname","method"],e),LocalFunction:(e=function(t){return{_hx_index:4,v:t,__enum__:"haxe.StackItem",toString:s}},e._hx_name="LocalFunction",e.__params__=["v"],e)};es.__constructs__=[es.CFunction,es.Module,es.FilePos,es.Method,es.LocalFunction];var ss={toString:function(t){for(var e=new u,s=0,i=t;s<i.length;){var n=i[s++];e.b+="\nCalled from ",ss.itemToString(e,n)}return e.b},subtract:function(t,e){for(var s=-1,i=-1;++i<t.length;){for(var n=0,r=e.length;n<r;)if(ss.equalItems(t[i],e[n++])){if(s<0&&(s=i),++i>=t.length)break}else s=-1;if(s>=0)break}return s>=0?t.slice(0,s):t},equalItems:function(t,e){if(null==t)return null==e;switch(t._hx_index){case 0:return null!=e&&0==e._hx_index;case 1:return null!=e&&1==e._hx_index&&t.m==e.m;case 2:return null!=e&&2==e._hx_index&&t.file==e.file&&t.line==e.line&&t.column==e.column&&ss.equalItems(t.s,e.s);case 3:return null!=e&&3==e._hx_index&&t.classname==e.classname&&t.method==e.method;case 4:return null!=e&&4==e._hx_index&&t.v==e.v}},itemToString:function(t,e){switch(e._hx_index){case 0:t.b+="a C function";break;case 1:var s=e.m;t.b=(t.b+="module ")+(null==s?"null":""+s);break;case 2:s=e.s;var i=e.file,n=e.line,r=e.column;null!=s&&(ss.itemToString(t,s),t.b+=" ("),t.b=(t.b+=null==i?"null":""+i)+" line ",t.b+=null==n?"null":""+n,null!=r&&(t.b=(t.b+=" column ")+(null==r?"null":""+r)),null!=s&&(t.b+=")");break;case 3:s=e.classname,i=e.method,t.b=(t.b+=l.string(null==s?"<unknown>":s))+".",t.b+=null==i?"null":""+i;break;case 4:s=e.v,t.b=(t.b+="local function #")+(null==s?"null":""+s)}}},is=function(){};is.__name__=!0,is.toHaxe=function(t,e){if(null==e&&(e=0),null==t)return[];if("string"==typeof t){var s=t.split("\n");"Error"==s[0]&&s.shift();for(var i=[],n=0,r=s.length;n<r;){var a=n++;if(!(e>a)){var o=s[a],h=o.match(/^    at ([$A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=h){var c=h[1].split(".");"$hxClasses"==c[0]&&c.shift();var u=c.pop(),d=h[2],f=l.parseInt(h[3]),m=l.parseInt(h[4]);i.push(es.FilePos("Anonymous function"==u?es.LocalFunction():"Global code"==u?null:es.Method(c.join("."),u),d,f,m))}else i.push(es.Module(_.trim(o)))}}return i}return e>0&&Array.isArray(t)?t.slice(e):t},is.normalize=function(t,e){if(null==e&&(e=0),Array.isArray(t)&&e>0)return t.slice(e);if("string"==typeof t){switch(t.substring(0,6)){case"Error\n":case"Error:":++e}return is.skipLines(t,e)}return t},is.skipLines=function(t,e,s){for(null==s&&(s=0);;){if(!(e>0))return t.substring(s);if((s=t.indexOf("\n",s))<0)return"";e=--e,s+=1}};var ns=function(t,e,s){g.call(this,String(t),e,s),this.value=t,this.__skipStack++};ns.__name__=!0,ns.__super__=g,ns.prototype=n(g.prototype,{__class__:ns});var rs=function(){this.h={}};rs.__name__=!0,rs.__interfaces__=[he],rs.prototype={get:function(t){return this.h[t]},remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(+e);return new ls(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},copy:function(){for(var t=new rs,e=this.keys();e.hasNext();){var s=e.next();t.h[s]=this.h[s]}return t},__class__:rs};var as=function(){this.h=Object.create(null)};as.__name__=!0,as.__interfaces__=[he],as.createCopy=function(t){var e=new as;for(var s in t)e.h[s]=t[s];return e},as.stringify=function(t){var e="[",s=!0;for(var i in t)s?s=!1:e+=",",e+=i+" => "+l.string(t[i]);return e+"]"},as.prototype={get:function(t){return this.h[t]},keys:function(){return new os(this.h)},iterator:function(){return new hs(this.h)},__class__:as};var os=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};os.__name__=!0,os.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.keys[this.current++]},__class__:os};var hs=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};hs.__name__=!0,hs.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.h[this.keys[this.current++]]},__class__:hs};var cs=i["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:s},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:s},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:s},Custom:(e=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:s}},e._hx_name="Custom",e.__params__=["e"],e)};cs.__constructs__=[cs.Blocked,cs.Overflow,cs.OutsideBounds,cs.Custom];var ls=function(t){this.current=0,this.array=t};ls.__name__=!0,ls.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:ls};var us=function(t){this.map=t,this.keys=t.keys()};us.__name__=!0,us.prototype={hasNext:function(){return this.keys.hasNext()},next:function(){var t=this.keys.next();return{value:this.map.get(t),key:t}},__class__:us};var _s=function(t,e,s){g.call(this,t,s),this.pos=e,this.__skipStack++};function ds(t){return t instanceof Array?new ls(t):t.iterator()}function fs(e,s){return null==s?null:(null==s.__id__&&(s.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:i=e.hx__closures__[s.__id__],null==i&&(i=s.bind(e),e.hx__closures__[s.__id__]=i),i);var i}_s.__name__=!0,_s.__super__=g,_s.prototype=n(g.prototype,{__class__:_s}),t.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(a.now=performance.now.bind(performance)),null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__=!0,Array.__name__=!0,Date.prototype.__class__=Date,Date.__name__="Date";var ms={},ps={},gs=Number,vs=Boolean,Ss={},ys={};W.__toStr={}.toString;var bs,Es=!m.get_supported()||"http:"!=(null!=(bs=t.location)?bs.protocol:null)&&"https:"!=(null!=(bs=t.location)?bs.protocol:null)?null:p.fromString(t.location.protocol+"//"+t.location.hostname+(""!=t.location.port?":"+t.location.port:"")+"/"),ws="TLCP-2.5.0",Ts=ws+".lightstreamer.com",Rs="9.2.0 build 20240416-n4r",Is="mgQkwtwdysogQz2BJ4Ji kOj2Bg",Cs="javascript_client",xs="";x.LIB_NAME=Cs,x.LIB_VERSION=Rs,q.lock=new F,q.logInstances=new as,q.emptyLogger=new k;var Ls=q.getLogger("lightstreamer.stream"),Ds=q.getLogger("lightstreamer.protocol"),Ns=q.getLogger("lightstreamer.internal"),Os=q.getLogger("lightstreamer.session"),Ms=q.getLogger("lightstreamer.actions"),Ps=q.getLogger("lightstreamer.reachability"),ks=q.getLogger("lightstreamer.subscriptions"),Fs=q.getLogger("lightstreamer.messages");q.getLogger("lightstreamer.cookies");var qs=q.getLogger("lightstreamer.page");B.frz_globalPageLifecycle=M.newLoggingInstance(),bt.EOL_LEN=bt.lengthOfBytes("\r\n");var As="The Subscription was initiated using a Field Schema: the field names are not available",Ws="The field position is out of bounds",Bs="The field name is unknown";Jt.instance=new Jt;var Us=Jt.instance.hasWorkers?Ie.setTimeout:t.setTimeout,Hs=Jt.instance.hasWorkers?Ie.clearTimeout:t.clearTimeout,Ks=Jt.instance.hasMicroTasks?t.queueMicrotask:function(t){Vs.push(t),Us(Ce,0)},Vs=[];Le.ZERO=0,Ne.WS="WS",Ne.WS_STREAMING="WS-STREAMING",Ne.WS_POLLING="WS-POLLING",Ne.HTTP="HTTP",Ne.HTTP_STREAMING="HTTP-STREAMING",Ne.HTTP_POLLING="HTTP-POLLING",Ke.Merge="MERGE",Ke.Distinct="DISTINCT",Ke.Command="COMMAND",Ke.Raw="RAW",Je.VARINT_RADIX=26,Ze.TRACE=0,Ze.DEBUG=10,Ze.INFO=20,Ze.WARN=30,Ze.ERROR=40,Ze.FATAL=50}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0);var I=R.LSLightstreamerClient,C=R.LSSubscription,x=R.LSConsoleLogLevel,L=R.LSConsoleLoggerProvider,D=function(t){this.delegate=t};D.prototype={setContentLength:function(t){this.delegate.setContentLength(t)},getContentLength:function(){return this.delegate.getContentLength()},setIdleTimeout:function(t){this.delegate.setIdleTimeout(t)},getIdleTimeout:function(){return this.delegate.getIdleTimeout()},setKeepaliveInterval:function(t){this.delegate.setKeepaliveInterval(t)},getKeepaliveInterval:function(){return this.delegate.getKeepaliveInterval()},setRequestedMaxBandwidth:function(t){this.delegate.setRequestedMaxBandwidth(t)},getRequestedMaxBandwidth:function(){return this.delegate.getRequestedMaxBandwidth()},getRealMaxBandwidth:function(){return this.delegate.getRealMaxBandwidth()},setPollingInterval:function(t){this.delegate.setPollingInterval(t)},getPollingInterval:function(){return this.delegate.getPollingInterval()},setReconnectTimeout:function(t){this.delegate.setReconnectTimeout(t)},getReconnectTimeout:function(){return this.delegate.getReconnectTimeout()},setStalledTimeout:function(t){this.delegate.setStalledTimeout(t)},getStalledTimeout:function(){return this.delegate.getStalledTimeout()},setRetryDelay:function(t){this.delegate.setRetryDelay(t)},getRetryDelay:function(){return this.delegate.getRetryDelay()},setFirstRetryMaxDelay:function(t){this.delegate.setFirstRetryMaxDelay(t)},getFirstRetryMaxDelay:function(){return this.delegate.getFirstRetryMaxDelay()},setSlowingEnabled:function(t){this.delegate.setSlowingEnabled(t)},isSlowingEnabled:function(){return this.delegate.isSlowingEnabled()},setForcedTransport:function(t){this.delegate.setForcedTransport(t)},getForcedTransport:function(){return this.delegate.getForcedTransport()},setServerInstanceAddressIgnored:function(t){this.delegate.setServerInstanceAddressIgnored(t)},isServerInstanceAddressIgnored:function(){return this.delegate.isServerInstanceAddressIgnored()},setCookieHandlingRequired:function(t){this.delegate.setCookieHandlingRequired(t)},isCookieHandlingRequired:function(){return this.delegate.isCookieHandlingRequired()},setReverseHeartbeatInterval:function(t){this.delegate.setReverseHeartbeatInterval(t)},getReverseHeartbeatInterval:function(){return this.delegate.getReverseHeartbeatInterval()},setHttpExtraHeaders:function(t){this.delegate.setHttpExtraHeaders(t)},getHttpExtraHeaders:function(){return this.delegate.getHttpExtraHeaders()},setHttpExtraHeadersOnSessionCreationOnly:function(t){this.delegate.setHttpExtraHeadersOnSessionCreationOnly(t)},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.delegate.isHttpExtraHeadersOnSessionCreationOnly()},setSessionRecoveryTimeout:function(t){this.delegate.setSessionRecoveryTimeout(t)},getSessionRecoveryTimeout:function(){return this.delegate.getSessionRecoveryTimeout()}};var N=function(t){this.delegate=t};N.prototype={setServerAddress:function(t){this.delegate.setServerAddress(t)},getServerAddress:function(){return this.delegate.getServerAddress()},setAdapterSet:function(t){this.delegate.setAdapterSet(t)},getAdapterSet:function(){return this.delegate.getAdapterSet()},setUser:function(t){this.delegate.setUser(t)},getUser:function(){return this.delegate.getUser()},setPassword:function(t){this.delegate.setPassword(t)},getServerInstanceAddress:function(){return this.delegate.getServerInstanceAddress()},getServerSocketName:function(){return this.delegate.getServerSocketName()},getSessionId:function(){return this.delegate.getSessionId()},getClientIp:function(){return this.delegate.getClientIp()}};var O=function(t,e){this.delegate=new I(t,e),this.connectionOptions=new D(this.delegate.connectionOptions),this.connectionDetails=new N(this.delegate.connectionDetails)};O.setLoggerProvider=function(t){I.setLoggerProvider(t)},O.LIB_NAME=I.LIB_NAME,O.LIB_VERSION=I.LIB_VERSION,O.prototype={connect:function(){this.delegate.connect()},disconnect:function(){this.delegate.disconnect()},getStatus:function(){return this.delegate.getStatus()},sendMessage:function(t,e,s,i,n){this.delegate.sendMessage(t,e,s,i,n)},getSubscriptions:function(){return this.delegate.getSubscriptionWrappers()},subscribe:function(t){this.delegate.subscribe(t.delegate)},unsubscribe:function(t){this.delegate.unsubscribe(t.delegate)},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()}};var M=function(t,e,s){this.delegate=new C(t,e,s,this)};M.prototype={isActive:function(){return this.delegate.isActive()},isSubscribed:function(){return this.delegate.isSubscribed()},setItems:function(t){this.delegate.setItems(t)},getItems:function(){return this.delegate.getItems()},setItemGroup:function(t){this.delegate.setItemGroup(t)},getItemGroup:function(){return this.delegate.getItemGroup()},setFields:function(t){this.delegate.setFields(t)},getFields:function(){return this.delegate.getFields()},setFieldSchema:function(t){this.delegate.setFieldSchema(t)},getFieldSchema:function(){return this.delegate.getFieldSchema()},getMode:function(){return this.delegate.getMode()},setDataAdapter:function(t){this.delegate.setDataAdapter(t)},getDataAdapter:function(){return this.delegate.getDataAdapter()},setSelector:function(t){this.delegate.setSelector(t)},getSelector:function(){return this.delegate.getSelector()},setRequestedMaxFrequency:function(t){this.delegate.setRequestedMaxFrequency(t)},getRequestedMaxFrequency:function(){return this.delegate.getRequestedMaxFrequency()},setRequestedBufferSize:function(t){this.delegate.setRequestedBufferSize(t)},getRequestedBufferSize:function(){return this.delegate.getRequestedBufferSize()},setRequestedSnapshot:function(t){this.delegate.setRequestedSnapshot(t)},getRequestedSnapshot:function(){return this.delegate.getRequestedSnapshot()},setCommandSecondLevelFields:function(t){this.delegate.setCommandSecondLevelFields(t)},getCommandSecondLevelFields:function(){return this.delegate.getCommandSecondLevelFields()},setCommandSecondLevelFieldSchema:function(t){this.delegate.setCommandSecondLevelFieldSchema(t)},getCommandSecondLevelFieldSchema:function(){return this.delegate.getCommandSecondLevelFieldSchema()},setCommandSecondLevelDataAdapter:function(t){this.delegate.setCommandSecondLevelDataAdapter(t)},getCommandSecondLevelDataAdapter:function(){return this.delegate.getCommandSecondLevelDataAdapter()},getValue:function(t,e){return this.delegate.getValue(t,e)},getCommandValue:function(t,e,s){return this.delegate.getCommandValue(t,e,s)},getKeyPosition:function(){return this.delegate.getKeyPosition()},getCommandPosition:function(){return this.delegate.getCommandPosition()},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()}};var P=function(){};P.TRACE=x.TRACE,P.DEBUG=x.DEBUG,P.INFO=x.INFO,P.WARN=x.WARN,P.ERROR=x.ERROR,P.FATAL=x.FATAL;var k=function(t){this.delegate=new L(t)};return k.prototype.getLogger=function(t){return this.delegate.getLogger(t)},t.ClientListener=b,t.ClientMessageListener=E,t.ConsoleLogLevel=P,t.ConsoleLoggerProvider=k,t.ItemUpdate=w,t.LightstreamerClient=O,t.Logger=S,t.LoggerProvider=y,t.Subscription=M,t.SubscriptionListener=T,t}({}),s);if("function"==typeof define&&define.amd)define("lightstreamer",["module"],(function(t){var e=t.config().ns?t.config().ns+"/":"";define(e+"LightstreamerClient",(function(){return i.LightstreamerClient})),define(e+"Subscription",(function(){return i.Subscription})),define(e+"ConsoleLogLevel",(function(){return i.ConsoleLogLevel})),define(e+"ConsoleLoggerProvider",(function(){return i.ConsoleLoggerProvider})),define(e+"Logger",(function(){return i.Logger})),define(e+"LoggerProvider",(function(){return i.LoggerProvider})),define(e+"ClientListener",(function(){return i.ClientListener})),define(e+"ClientMessageListener",(function(){return i.ClientMessageListener})),define(e+"ItemUpdate",(function(){return i.ItemUpdate})),define(e+"SubscriptionListener",(function(){return i.SubscriptionListener}))})),require(["lightstreamer"]);else{var n=function(t,e){if(!t)return e;for(var s=t.split("."),i=e||window,n=0;n<s.length;n++){var r=s[n],a=i[r];a&&"object"==typeof a||(a=i[r]={}),i=a}return i}(function(){if("undefined"==typeof window||void 0===window.document)return null;for(var t=window.document.getElementsByTagName("script"),e=0,s=t.length;e<s;e++)if("data-lightstreamer-ns"in t[e].attributes)return t[e].attributes["data-lightstreamer-ns"].value;return null}(),t);n.LightstreamerClient=i.LightstreamerClient,n.Subscription=i.Subscription,n.ConsoleLogLevel=i.ConsoleLogLevel,n.ConsoleLoggerProvider=i.ConsoleLoggerProvider,n.Logger=i.Logger,n.LoggerProvider=i.LoggerProvider,n.ClientListener=i.ClientListener,n.ClientMessageListener=i.ClientMessageListener,n.ItemUpdate=i.ItemUpdate,n.SubscriptionListener=i.SubscriptionListener}}("undefined"!=typeof self?self:this);
//# sourceMappingURL=lightstreamer.min.js.map
