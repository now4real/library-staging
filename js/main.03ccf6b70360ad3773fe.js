!function e(s,r,o){function u(n,t){if(!r[n]){if(!s[n]){var i="function"==typeof require&&require;if(!t&&i)return i(n,!0);if(a)return a(n,!0);throw(t=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",t}i=r[n]={exports:{}},s[n][0].call(i.exports,function(t){return u(s[n][1][t]||t)},i,i.exports,e,s,r,o)}return r[n].exports}for(var a="function"==typeof require&&require,t=0;t<o.length;t++)u(o[t]);return u}({1:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});t=t(3);function e(){}e.S="CORE",e.O=t.P.Warn,e.T=Number("5"),e.C=Number("6"),e.N=void 0,e._=void 0,e.I=void 0,e.A=void 0,e.R="https",e.U="443",e.L="FELS",e.j="n4rCommon",e.F=["now4real.com","localhost:3000","localtest.me:3000"],e.G="shared-public-sandbox.test",e.J=!0,e.H=140,e.V=0,e.q=3e3,e.B=18e4,e.K=15e3,e.X=8e3,e.$=1e3,e.Z="n4rSitePreferences",e.tt="noRe",e.nt="noReMain",e.it="email",e.et="emailMain",e.st=20,e.rt=1e3,e.ot=1200,i.default=e},{3:3}],2:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.ut=i.ct=i.ht=i.lt=void 0;t=t(3),i.lt=t.P.Debug,i.ht=t.P.Info,i.ct=t.P.Warn,i.ut=t.P.Error,e.ft="presenceForeground",e.dt="presenceTyping",e.vt="messageUserList",e.wt="messageEvent",e.gt="events",e.bt="key",e.Et="command",e.St="ADD",e.UPDATE="UPDATE",e.Ot="DELETE",e.Pt="http",e.Tt="https",e.Ct="localhost",e.Dt="CONNECTED",e.DISCONNECTED="DISCONNECTED",e.Nt="DISCONNECTED:WILL-RETRY",e._t="DISCONNECTED:TRYING-RECOVERY",e.yt="code",e.Mt="message",e.It="on",e.At="off",e.Rt="yes",e.Ut="no",e.xt="page",e.kt="site",e.Lt="\t",e.jt="/",e.Ft="g.invalid",e.Gt="n4rAuth",e.Jt="n4rFels",e.Ht="translate.goog",e.Vt="MODERATOR",e.Wt="GUEST",e.EMAIL="EMAIL",e.qt="group.invalid",e.Bt="master.invalid",e.Yt="resolve",e.zt="reject",e.Kt="SITE_CONFIGURATION_CHANGED",e.Xt="SITE_NOT_ACTIVE",e.$t="REQUESTED_SNAPSHOT",t=e;function e(){}i.default=t},{3:3}],3:[function(t,n,i){var e;Object.defineProperty(i,"t",{value:!0}),i.Qt=i.Zt=i.tn=i.nn=i.en=i.P=i.sn=void 0,(e=i.sn||(i.sn={}))[e.FACEBOOK=0]="FACEBOOK",e[e.GOOGLE=1]="GOOGLE",e[e.LINKEDIN=2]="LINKEDIN",e[e.TWITTER=3]="TWITTER",(e=i.P||(i.P={}))[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warn=3]="Warn",e[e.Error=4]="Error",e[e.Off=5]="Off",(e=i.en||(i.en={}))[e.MESSAGE_SEND=0]="MESSAGE_SEND",e[e.MESSAGE_GET=1]="MESSAGE_GET",e[e.MESSAGE_DELETE=2]="MESSAGE_DELETE",e[e.MESSAGE_EDIT=3]="MESSAGE_EDIT",e[e.CHAT_FLUSH=4]="CHAT_FLUSH",e[e.CHAT_ENABLE=5]="CHAT_ENABLE",e[e.MUTE_USER_GET=6]="MUTE_USER_GET",e[e.MUTE_USER_SET=7]="MUTE_USER_SET",e[e.DELETE_PASSWORD=8]="DELETE_PASSWORD",e[e.GET_AUTH_INFO=9]="GET_AUTH_INFO",e[e.REPORT_CHAT_MESSAGE=10]="REPORT_CHAT_MESSAGE",e[e.USER_PREFERENCE_SET=11]="USER_PREFERENCE_SET",e[e.LOG=12]="LOG",e[e.USER_CONSENT_SET=13]="USER_CONSENT_SET",e[e.JWT_REFRESH=14]="JWT_REFRESH",e[e.POLL_NEW=15]="POLL_NEW",e[e.POLL_CLOSE=16]="POLL_CLOSE",e[e.POLL_VOTE_SET=17]="POLL_VOTE_SET",e[e.POLL_VOTE_GET=18]="POLL_VOTE_GET",(e=i.nn||(i.nn={}))[e.Success=0]="Success",e[e.Generic=-1]="Generic",e[e.Unauthorized=-2]="Unauthorized",e[e.IllegalArgument=-3]="IllegalArgument",e[e.TemporarilyUnavailable=-4]="TemporarilyUnavailable",e[e.UnsupportedClient=-5]="UnsupportedClient",e[e.UnsupportedBrowser=-6]="UnsupportedBrowser",e[e.AuthenticationExpired=-7]="AuthenticationExpired",(e=i.tn||(i.tn={}))[e.WrongCredentials=1]="WrongCredentials",e[e.AllowedSessionCountReached=7]="AllowedSessionCountReached",e[e.SessionCountLimitReached=8]="SessionCountLimitReached",e[e.ServerTooBusy=9]="ServerTooBusy",e[e.ServerBlocked=10]="ServerBlocked",(e=i.Zt||(i.Zt={})).SOCIAL="Social",e.JWT="JWT",e.READ_ONLY="Read-only",e.N4R="N4R",e.NO_REGISTRATION="NoRe",e.EMAIL="Email",(e=i.Qt||(i.Qt={})).PageShowing="page_showing",e.PageHiding="page_hiding",e.ConnectionStatus="connection_status",e.Authentication="authentication",e.Load="load",e.LoadError="load_error",e.UserUpdated="user_updated"},{}],4:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.rn=void 0;var e=t(42),t=t(43);i.rn=new e.default(t.on.CREDIT_EXHAUSTED,"The credits for this site have been exhausted or this site was disabled. Please check your Now4real dashboard at dashboard.now4real.com to upgrade your plan and/or re-enable Now4real")},{42:42,43:43}],5:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});t=t(39);i.default=new t.default},{39:39}],6:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var o=t(34),u=t(2),a=t(42),c=t(43),e=t(29),s=t(38),h=t(4);function r(t,n,i){void 0===i&&(i=!1),this.un=t,this.an=n,this.cn=i}r.prototype.parse=function(t){t=JSON.parse(t);return{status:t.s,master:t.m,group:t.g,logo:t.l,version:t.v,siteKey:t.k,auth:t.a,whiteLabel:t.w,conf:t.c}},r.prototype.check=function(){var r=this;return new Promise(function(e,s){r.fetch(r.un).then(function(t){var n=t.hn,t=t.responseText;o.default(u.lt,"Obtained",n,t);try{var i=r.parse(t);0===i.status?s(h.rn):(r.current=i,e(i))}catch(t){s(new a.default(c.on.TECHNICAL_PROBLEM,t.message))}}).catch(function(t){o.default(u.lt,t.statusCode),403!==t.statusCode||r.cn?s(t):(t=r.parse('{"s":1,"v":-1}'),r.current=t,e(t))})})},r.prototype.ln=function(t){var n=this;return t?(t=this.parse(JSON.stringify(t)),this.current=t,Promise.resolve(t)):s.retry(function(){return n.check()},{dn:"statusCode",vn:"*",wn:3,delay:5e3}).catch(function(t){throw t.statusCode?new a.default(c.on.TECHNICAL_PROBLEM,t.statusCode.toString()):t})},r.prototype.fetch=function(t){return e.default.mn(this.an+"/conf/"+encodeURIComponent(t)+"/json")},r.prototype.get=function(){return this.current},r.prototype.pn=function(){var t=this.current;return{s:t.status,m:t.master,g:t.group,l:t.logo,v:t.version,k:t.siteKey,a:t.auth,w:t.whiteLabel,c:t.conf}},r.prototype.update=function(t){try{return this.current=this.parse(t),this.current}catch(t){o.default(u.ut,"Conf update error",t)}},i.default=r},{2:2,29:29,34:34,38:38,4:4,42:42,43:43}],7:[function(t,n,i){function e(){}Object.defineProperty(i,"t",{value:!0}),e.gn=!1,e.sid=null,e.bn=null,e.En=null,e.Sn=null,i.default=e},{}],8:[function(t,n,i){var s=this&&this.__spreadArrays||function(){for(var t=0,n=0,i=arguments.length;n<i;n++)t+=arguments[n].length;for(var e=Array(t),s=0,n=0;n<i;n++)for(var r=arguments[n],o=0,u=r.length;o<u;o++,s++)e[s]=r[o];return e},r=(Object.defineProperty(i,"t",{value:!0}),t(40));function e(t){if(this.On=!1,this.Pn=[],this.metadata={},this.prefix=t.prefix,this.context=t.context,this.category=t.category,this.Tn=t.Cn,this.mode=t.Dn,this.Nn=t.Nn,this.hidden=t._n||!1,this.yn=t.yn||!1,this.Mn=t.Mn||!1,void 0!==this.context){var n="";switch(this.context){case 0:n="p";break;case 1:n="s";break;case 2:n=2===this.category?"w|"+this.Tn[0]:"w";break;case 3:n=this.Nn}this.id=this.prefix+"|"+n}else this.id=this.prefix;this.Mn&&(this.id=this.id+="|"+this.Tn.join(",")),this.In=t.In?r.An(t.In):null}e.prototype.toString=function(){return this.id},e.prototype.Rn=function(){return this.Pn},e.prototype.Un=function(t){-1===this.Pn.indexOf(t)&&this.Pn.push(t)},e.prototype.xn=function(t){t=this.Pn.indexOf(t);-1<t&&this.Pn.splice(t,1)},e.prototype.kn=function(t){this.snapshot=r.An(this.In),t[this.name]=this.snapshot,this.On=!0},e.prototype.Ln=function(t,n){var i=this.snapshot;if(null==t)i=t;else if(r.isArray(t))r.isArray(i)?i.splice.apply(i,s([0,i.length],t)):i=t;else if(r.jn(t))if(r.jn(i)){for(var e in t)i[e]=t[e];for(var e in i)e in t||delete i[e]}else i=t;else i=t;this.snapshot=i,n[this.name]=i},e.prototype.Fn=function(t){this.Ln(void 0,t),this.On=!1},e.prototype.Gn=function(t){this.Ln(this.In,t)},e.prototype.Jn=function(t){this.listener=t},e.prototype.Hn=function(){this.listener=void 0},e.prototype.Vn=function(){return this.hidden},e.prototype.Wn=function(){return this.On},e.prototype.qn=function(){return this.yn},e.prototype.Bn=function(){return void 0!==this.Nn},e.prototype.Yn=function(){return 3===this.context},e.prototype.zn=function(t,n){this.metadata[t]=n},e.prototype.getMetadata=function(t,n){return void 0===n&&(n=void 0),this.metadata.hasOwnProperty(t)?this.metadata[t]:n},e.prototype.Kn=function(t){return this.metadata.hasOwnProperty(t)},e.prototype.Xn=function(t){return!!this.metadata.hasOwnProperty(t)&&(delete this.metadata[t],!0)},i.default=e},{40:40}],9:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var s=t(8),e=t(2),r=t(43),o=t(34),u=t(2);function a(){var t;this.$n=["p"],this.Qn=["ml","md","mlm","cd","mh","gr","cb","mv","mc","me","mr"],this.Zn=["t","p"],this.ti=[e.default.bt,e.default.Et,"u","i","p","r","s","d","e"],this.ni=[e.default.bt,e.default.Et,"n","i","p","r","b","bf","bb"],this.ii=[e.default.bt,"d","p"],this.ei=["c"],this.si=[e.default.bt,e.default.Et,"i","t","c","p"],this.ri=["c","h"],this.oi=[e.default.bt,e.default.Et],this.ui=["q","o","v","t","m","b"],this.ai=["q","m","b","c"],this.ci={value:null},this.hi=[],this.li={},this.fi=[],this.di=[],this.vi=null,this.wi={status:null},this.mi={status:"NOT_AUTHENTICATED"},this.pi={messageMaxLength:null,messageMaxLengthModerator:null,messageMaxLengthGuest:null,messageDurationValue:null,messageDurationUnit:null,chatStatus:null,clickableLinks:null,gifsStatus:null,chatbotEnabled:null,listChatMessagesInitialCount:null,messageEditDuration:null,messageDeleteDuration:null},this.gi=[r.bi.COUNTER_PAGE_VIEWERS,r.bi.COUNTER_PAGE_CHATTERS,r.bi.COUNTER_CHAT_TYPING],this.Ei=((t={})[r.bi.CONNECTION_STATUS]=new s.default({category:0,In:this.wi,prefix:"_cs",yn:!0}),t[r.bi.LOGIN_STATUS]=new s.default({category:0,In:this.mi,prefix:"_ls",yn:!0}),t[r.bi.AUTHORIZATION]=new s.default({category:0,In:{},prefix:"_a",yn:!0}),t[r.bi.PARAMETERS]=new s.default({category:9,In:this.pi,prefix:"Par",yn:!0,Cn:this.Qn,Dn:"MERGE"}),t[e.default.gt]=new s.default({category:10,prefix:"E",yn:!1,Cn:this.Zn,Dn:"DISTINCT"}),t[e.default.ft]=new s.default({category:1,context:0,_n:!0,prefix:"PF",Cn:this.$n,Dn:"RAW"}),t[e.default.dt]=new s.default({category:1,context:0,_n:!0,prefix:"PT",Cn:this.$n,Dn:"RAW"}),t[e.default.vt]=new s.default({category:7,_n:!0,prefix:"Mu",Cn:this.ni,Dn:"COMMAND"}),t[e.default.wt]=new s.default({category:8,_n:!0,prefix:"Me",Cn:this.ii,Dn:"DISTINCT"}),t[r.bi.RANKING_PAGE_VIEWERS]=new s.default({category:4,context:0,In:this.hi,prefix:"RF",Cn:this.si,Dn:"COMMAND"}),t[r.bi.RANKING_PAGE_CHATTERS]=new s.default({category:4,context:0,In:this.hi,prefix:"RA",Cn:this.si,Dn:"COMMAND"}),t.RANKING_SITE_VIEWERS=new s.default({category:4,context:2,_n:!0,In:this.hi,prefix:"RsF",Cn:this.si,Dn:"COMMAND"}),t.RANKING_SITE_CHATTERS=new s.default({category:4,context:2,_n:!0,In:this.hi,prefix:"RsA",Cn:this.si,Dn:"COMMAND"}),t[r.bi.LIST_CHAT_TYPING]=new s.default({category:6,context:0,In:this.di,prefix:"LT",Cn:this.oi,Dn:"COMMAND"}),t[r.bi.LIST_CHAT_MESSAGES]=new s.default({category:3,context:0,In:this.fi,prefix:"M",Cn:this.ti,Dn:"COMMAND"}),t[r.bi.COUNTER_PAGE_VIEWERS]=new s.default({category:2,context:0,In:this.ci,prefix:"CF",Cn:this.ei,Dn:"MERGE"}),t[r.bi.COUNTER_PAGE_CHATTERS]=new s.default({category:2,context:0,In:this.ci,prefix:"CA",Cn:this.ei,Dn:"MERGE"}),t[r.bi.COUNTER_SITE_VIEWERS]=new s.default({category:2,context:1,In:this.ci,prefix:"CF",Cn:this.ei,Dn:"MERGE"}),t[r.bi.COUNTER_SITE_CHATTERS]=new s.default({category:2,context:1,In:this.ci,prefix:"CA",Cn:this.ei,Dn:"MERGE"}),t[r.bi.COUNTER_CHAT_MESSAGES]=new s.default({category:2,context:0,In:this.ci,prefix:"CM",Cn:this.ei,Dn:"MERGE"}),t[r.bi.COUNTER_CHAT_TYPING]=new s.default({category:2,context:0,In:this.ci,prefix:"CT",Cn:this.ei,Dn:"MERGE"}),t.COUNTER_DOMAINS_GLOBAL=new s.default({category:2,context:2,_n:!0,In:this.ci,prefix:"Ga",Cn:["hc"],Dn:"MERGE"}),t.COUNTER_CHAT_MESSAGES_GLOBAL=new s.default({category:2,context:2,_n:!0,In:this.ci,prefix:"Ga",Cn:["mc"],Dn:"MERGE"}),t.COUNTER_USERS_GLOBAL=new s.default({category:2,context:2,_n:!0,In:this.ci,prefix:"Ga",Cn:["uc"],Dn:"MERGE"}),t.PEAK_SITE_VIEWERS=new s.default({category:2,context:1,_n:!0,In:this.ci,prefix:"CpF",Cn:this.ei,Dn:"MERGE"}),t.PEAK_SITE_CHATTERS=new s.default({category:2,context:1,_n:!0,In:this.ci,prefix:"CpA",Cn:this.ei,Dn:"MERGE"}),t[r.bi.HEATMAP_PAGE_VIEWERS]=new s.default({category:5,context:0,In:this.li,prefix:"HF",Cn:this.ri,Dn:"MERGE"}),t[r.bi.HEATMAP_SITE_VIEWERS]=new s.default({category:5,context:1,In:this.li,prefix:"HF",Cn:this.ri,Dn:"MERGE"}),t[r.bi.POLL]=new s.default({category:12,In:this.vi,prefix:"Po",Cn:this.ui,Dn:"MERGE",Mn:!0}),t[r.bi.POLL_STATUS]=new s.default({category:11,In:this.vi,prefix:"Po",Cn:this.ai,Dn:"MERGE",Mn:!0}),t)}a.Si=function(){return a.Oi=a.Oi?a.Oi:new a},a.prototype.destroy=function(t){t=t.id;o.default(u.lt,"Destroying: "+t),delete this.Ei[t]},a.prototype.find=function(t){var n=t.split(":"),i=n[0],n=n[1],e=this.Ei[i];return e&&void 0===e.name&&(this.Ei[i].name=i),void 0!==n&&-1<this.gi.indexOf(i)?(o.default(u.lt,"Custom page context founded: "+n),i=e.prefix+"|"+n,this.Ei[i]||(o.default(u.lt,"Generating: "+t),(n=new s.default({category:e.category,In:e.In,prefix:e.prefix,Cn:e.Tn,Dn:e.mode,context:3,Nn:n})).name=t,this.Ei[i]=n)):e},a.prototype.Pi=function(){var n=this;return Object.keys(this.Ei).filter(function(t){return!0===n.Ei[t].yn}).map(function(t){return n.find(t)})},a.prototype.Ti=function(t){for(var n in this.Ei)if(this.Ei[n].toString()===t)return this.Ei[n]},a.prototype.Ci=function(){var n=this;return Object.keys(this.Ei).filter(function(t){return!0!==n.Ei[t].Vn()})},i.default=a},{2:2,34:34,43:43,8:8}],10:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.Di=i.Ni=i._i=i.yi=i.Mi=i.Ii=i.Ai=i.Ri=i.Ui=i.xi=i.test=void 0;var e=t(34),s=t(2);function r(){var t,n;return void 0!==document.hidden?(t="hidden",n="visibilitychange"):void 0!==document.mozHidden?(t="mozHidden",n="mozvisibilitychange"):void 0!==document.msHidden?(t="msHidden",n="msvisibilitychange"):void 0!==document.webkitHidden&&(t="webkitHidden",n="webkitvisibilitychange"),{hidden:t,visibilityChange:n}}function o(){return"postMessage"in window}function u(){return window.storageAvailable}function a(t,n){var i=(t="on"+t)in n;return i||(n=n.setAttribute?n:document.createElement("div")).setAttribute&&n.removeAttribute&&(n.setAttribute(t,""),i="function"==typeof n[t],void 0!==n[t]&&(n[t]=void 0),n.removeAttribute(t)),i}i.test=function(t){switch(t){case 1:return a("message",window)&&o();case 0:return a("storage",window)&&u();case 2:var n=r().hidden;return void 0!==document[n];default:return e.default(s.ct,"Unsupported feature",t),!1}},i.xi=r,i.Ui=o,i.Ri=u,i.Ai=a,i.Ii=function(){return-1!==(t=navigator.userAgent,n=-1,"Microsoft Internet Explorer"===navigator.appName?null!==new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(t)&&(n=parseFloat(RegExp.$1)):"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(t)&&(n=parseFloat(RegExp.$1)),n);var t,n},i.Mi=function(){return 0<=navigator.userAgent.indexOf("Edge")},i.yi=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},i._i=function(){return/Version\/.{1,300}Chrome\/\d+\.\d+\.\d+\.\d+|; wv\).{1,300}Chrome\/\d+\.\d+\.\d+\.\d+|(?:iPod|iPod touch|iPhone|iPad);.{0,30}CPU.{0,30}OS[ +]\d+_\d+(?:_\d+|).{0,30} AppleNews\/\d+\.\d+(?:\.\d+|)|(?:iPod|iPhone|iPad).{1,200}Version\/\d+\.\d+(?:\.\d+|)(?!.{0,200} Safari)|(?:iPod|iPod touch|iPhone|iPad)(?!.{0,200} Safari)/.test(navigator.userAgent)},i.Ni=function(){return e.default(s.lt,"UA: "+navigator.userAgent),/bot|crawler|spider/i.test(navigator.userAgent)},i.Di=function(){var t=navigator.userAgent||"";return!!/iP(hone|od|ad)/.test(t)&&!!(t=t.match(/Version\/(\d+)\.(\d+)/))&&26<=parseInt(t[1],10)}},{2:2,34:34}],11:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.default=function(){window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),String.prototype.startsWith||(String.prototype.startsWith=function(t){return this.substr(0,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)}),String.prototype.ki||(String.prototype.ki=function(){return this.charAt(0).toUpperCase()+this.slice(1)})}},{}],12:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(1),o=t(42),s=t(7),u=t(2),r=t(40);function a(t){this.Li=0,this.ji={},this.Fi=r.Gi(8),this.destination=t,this.origin=t!==a.Ji||void 0!==e.default.I.file_name?"*":s.default.Hi,this.Vi()}a.prototype.Wi=function(){return this.Fi+this.Li++},a.prototype.Vi=function(){function t(t){var n,i,e,s;(t.origin||t.originalEvent.origin)!==r.origin||(n=(t=t.data).cmd)!==u.default.Yt&&n!==u.default.zt||(i=t.id,e=t.payload,n===u.default.zt&&(s=t.code,t=t.message,s)&&t&&(e=new o.default(s,t)),null!=(s=r.ji[i])&&s[n](e),delete r.ji[i])}var r=this;window.addEventListener("message",t,!1),this.qi=t},a.prototype.send=function(t){var i=this,e=this.Wi();return this.destination.postMessage({id:e,cmd:t.cmd,payload:t.payload},this.origin),new Promise(function(t,n){i.ji[e]={resolve:t,reject:n}})},a.prototype.reset=function(){for(var t=this.Li=0,n=Object.keys(this.ji);t<n.length;t++){var i=n[t];this.ji[i].reject(new o.default("ABORTED","broken channel")),delete this.ji[i]}window.removeEventListener("message",this.qi)},a.Ji=window.parent,a.Bi=window,i.default=a},{1:1,2:2,40:40,42:42,7:7}],13:[function(t,n,i){function e(t,n){this.cmd=t,this.payload=n}var s,r,o=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}))(t,n)},function(t,n){function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),u=(Object.defineProperty(i,"t",{value:!0}),i.Yi=i.zi=i.Ki=i.Xi=i.$i=i.Qi=void 0,o(a,r=i.Qi=e),a);function a(t){return r.call(this,"verify",t)||this}i.$i=u;o(h,c=e);var c,u=h;function h(t,n,i){return c.call(this,"reload",{startOpen:t,updatedSiteConf:n,reloadScriptConf:i})||this}i.Xi=u;o(f,l=e);var l,u=f;function f(){return l.call(this,"destroyAPI",null)||this}i.Ki=u;o(v,d=e);var d,u=v;function v(){return d.call(this,"getUpdatedJWT",null)||this}i.zi=u;o(m,w=e);var w,u=m;function m(t){return w.call(this,"updateConfig",{c:t})||this}i.Yi=u},{}],14:[function(t,n,i){function e(t,n){this.cmd=t,this.payload=n}var s,r,o=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}))(t,n)},function(t,n){function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),u=(Object.defineProperty(i,"t",{value:!0}),i.Zi=i.te=i.ne=i.ie=i.ee=i.se=i.re=i.oe=void 0,o(a,r=i.oe=e),a);function a(t){return r.call(this,"load",t)||this}i.re=u;o(h,c=e);var c,u=h;function h(t){return c.call(this,"error",t)||this}i.se=u;o(f,l=e);var l,u=f;function f(t){return l.call(this,"subjectUpdate",t)||this}i.ee=u;o(v,d=e);var d,u=v;function v(t){return d.call(this,"response",t)||this}i.ie=u;o(m,w=e);var w,u=m;function m(t){return w.call(this,"loggerEdit",t)||this}i.ne=u;o(g,p=e);var p,u=g;function g(t){return p.call(this,"siteStatusUpdate",t)||this}i.te=u;o(E,b=e);var b,u=E;function E(t){return b.call(this,"suggestionsUpdate",t)||this}i.Zi=u},{}],15:[function(t,n,i){function e(t,n){this.type=t,this.data=n,this.timestamp=Date.now()}var s,r,o=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}))(t,n)},function(t,n){function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),u=(Object.defineProperty(i,"t",{value:!0}),i.ue=i.ae=i.ce=i.he=i.le=i.fe=i.de=i.ve=i.we=i.me=i.pe=i.ge=void 0,t(43)),t=(i.ge=e,o(a,r=e),a);function a(t){return r.call(this,u.bi.CONNECTION_STATUS,t)||this}i.pe=t;o(h,c=e);var c,t=h;function h(t){return c.call(this,u.bi.LOGIN_STATUS,t)||this}i.me=t;o(f,l=e);var l,t=f;function f(t){return l.call(this,u.bi.AUTHORIZATION,t)||this}i.we=t;o(v,d=e);var d,t=v;function v(t){return d.call(this,u.bi.LIST_CHAT_MESSAGES,t)||this}i.ve=t;o(m,w=e);var w,t=m;function m(t){return w.call(this,u.bi.PARAMETERS,t)||this}i.de=t;o(g,p=e);var p,t=g;function g(t){return p.call(this,u.bi.LIST_CHAT_TYPING,t)||this}i.fe=t;o(E,b=e);var b,t=E;function E(t){return b.call(this,u.bi.POLL,t)||this}i.le=t;o(O,S=e);var S,t=O;function O(t){return S.call(this,u.bi.POLL_STATUS,t)||this}i.he=t;o(T,P=e);var P,t=T;function T(t,n){return P.call(this,t,n)||this}i.ce=t;o(D,C=e);var C,t=D;function D(t,n){return C.call(this,t,n)||this}i.ae=t;o(_,N=e);var N,t=_;function _(t,n){return N.call(this,t,n)||this}i.ue=t},{43:43}],16:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),new(t(17).be)},{17:17}],17:[function(H,t,V){!function(J){!function(){var l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t}).apply(this,arguments)},f=(Object.defineProperty(V,"t",{value:!0}),V.be=void 0,H(1)),d=H(2),D=H(7),v=H(3),N=H(40),t=H(33),n=H(41),w=H(21),m=H(26),p=H(27),g=H(28),b=H(25),e=H(36),s=H(35),r=H(31),o=H(9),E=H(18),u=H(11),_=H(15),a=H(14),c=H(13),i=H(23),h=H(10),S=H(5),k=H(30),O=H(6),P=H(19),L=H(20),j=H(24),T=H(12),F=H(38),C=H(42),y=H(44),M=H(43),I=H(34),A=H(3),R=H(2),U="undefined"!=typeof window?window.LS:void 0!==J?J.LS:null,G=(x.prototype.start=function(){I.default(R.ht,U.LightstreamerClient.LIB_VERSION);try{this.Ee();for(var t=this.Ei.Pi(),n=0,i=t;n<i.length;n++)i[n].kn(this);this.Oe.Se()&&this.load()}catch(t){throw new C.default(M.on.TECHNICAL_PROBLEM,t.message)}},x.prototype.Pe=function(t){I.default(R.lt,"updateIntegratorStatus",t);var n=t.status,i=t.logo,t=t.whiteLabel;this.Te=n,this._siteStatus=n,this._customLogo=void 0!==i?!!i:3===n,this._whiteLabel=void 0!==t&&t},x.prototype.Ce=function(t){var n=f.default.N.target;"api"!==n&&"api+widget"!==n&&"demo"!==n||this.notify(new a.se(t),"p"),"widget"!==n&&"api+widget"!==n&&"demo"!==n||N.De(this.onerror)&&this.onerror.call(this,t),this.Ne(),S.default.publish(v.Qt.LoadError,t)},x.prototype.Ne=function(){this.notify(new a.oe("destroy",{}),"p")},x.prototype._e=function(){var t,n=f.default.N.target;"api"!==n&&"api+widget"!==n&&"demo"!==n||((t=JSON.parse(f.default._)).technicalConfig=f.default.I,t={cc:JSON.stringify(t),as:this.Ei.Ci(),ll:f.default.O,ago:f.default.ye,co:f.default.Me,uau:f.default.Ie,ss:this.Te,lv:this.version,pc:this.context.Ae,sc:this.context.un,gc:this.context.Re,wv:this.Ue,nrm:this.xe,em:this.ke,sk:null==(t=this.Le.get())?void 0:t.siteKey,wll:this._whiteLabel,sid:D.default.sid,pars_snap:this.Ei.find(M.bi.PARAMETERS).snapshot},this.notify(new a.re(t),"p")),"widget"!==n&&"api+widget"!==n&&"demo"!==n||(this._fromFile=void 0!==f.default.I.file_name,this._standardAuthDisabled=this.Ue,this.je)||this.onload.call(this),S.default.publish(v.Qt.Load,null)},x.prototype.Fe=function(t){t=window[t];this.onload=t&&N.De(t.onload)?t.onload:function(){I.default(R.ut,"onload not setted")},this.onerror=t?t.onerror:null},x.prototype.Ge=function(){if("file:"===location.protocol)return!0;for(var t=f.default.F,n=N.Je(window.location.href).host,i=0,e=t;i<e.length;i++){var s=e[i];if(n.endsWith(s))return!0}return I.default(R.ut,"the domain is not enabled",n,t,window.location.href),!1},x.prototype.He=function(t){var n=this;P.default.init(t),this.Ve(),P.default.We(function(t){n.Be.qe(P.default.Ye()),n.Ve()}),this.Be.qe(P.default.Ye())},x.prototype.ze=function(t){var i,e,n,s=this,r=f.default.N,o=t.status,u=t.master,a=t.group,c=t.auth,u=((u||a)&&(this.context=this.Ke.update(u,a)),r.context_check),a=this.context.un;u&&a!==f.default.G&&u!==a?this.Ce(new C.default(M.on.INVALID_CALL,"the expected context_check had to be equal to: "+a+", got: "+u)):(this.Pe(t),this.siteContext=this.context.un,this.pageContext=this.context.Ae,this.groupContext=this.context.Re,this.xe=2===c,this.ke=3===c,this.je||(i=function(t){t.then(function(t){return s.$e.Xe().then(function(t){return E.default.Qe(t)})}).then(function(t){s.Ze(t)}).catch(function(t){E.default.ts(null),s.ns(t)})},e=function(t,n){t.then(function(t){E.default.es()}).then(function(t){return s.$e.Xe().then(function(t){return E.default.Qe(t)})}).then(function(t){s.rs(!1)}).catch(function(t){E.default.ts(n),s.ns(t)})},this.xe?(n=D.default.os.watch(f.default.tt,function(t){E.default.state.us(2),t?(E.default.ts(t.id),i(s.Be.cs(v.Zt.NO_REGISTRATION,t.token))):(E.default.ts(null),e(s.Be.hs(),E.default.ls()))}))&&this.fs.push(n):this.ke?(n=D.default.os.watch(f.default.it,function(t){E.default.state.us(2),t?(E.default.ts(t.id),i(s.Be.cs(v.Zt.EMAIL,t))):(E.default.ts(null),e(s.Be.hs(),E.default.ls()))}))&&this.fs.push(n):this.ds||(a=w.default.watch(d.default.Gt,function(t,n){t?(null==n?void 0:n.id)===t.id?(I.default(R.lt,"onCredentialUpdated call"),s.Ze(t)):(I.default(R.lt,"onCredentialStored call"),E.default.state.us(2),E.default.ts(t.id),i(s.Be.cs(v.Zt.SOCIAL,t))):(I.default(R.lt,"onCredentialDeleted call"),E.default.state.us(2),E.default.ts(null),e(s.Be.hs(),E.default.ls()))}))&&this.fs.push(a)),f.default.I.our_origin=this.context.an,f.default.J=r.local_persistence||!(null!=(u=null==r?void 0:r.custom_auth)&&u.enabled)||3!==o,this.browserPreferences=new L.default(this.context.Re||this.context.un),this.Be.vs(),1!==o||this.je||I.default(R.ct,"Verify "+this.siteContext+" for free in the Now4real Dashboard to get analytics, notifications, and more. Go to https://dashboard.now4real.com and follow the instructions."),this.ws=t)},x.prototype.ps=function(t,n){I.default(R.lt,"Auth info",t,n),E.default.Qe(t),this.He(t)},x.prototype.load=function(){var i=this;I.default(R.lt,"Loading NOW4REAL",this.version),this.gs=!0,this.Ue=h._i(),this.bs(),this.Es(this.Ss),this.userPreferences=new j.default(this.$e,function(){return i.Ei},function(t){i.Ze(t)}),this.Os();this.Ps(),this.Ts(),D.default.bn=new T.default(T.default.Ji),this.fs.push(function(t){D.default.bn.reset()}),this.Cs(),!this.je&&this.Oe.Se()&&this.Ds(),this.Ns(),this.Be._s().then(function(t){return Promise.all([i.$e.Xe(),t])}).then(function(t){var n=t[0],t=t[1];i.ze(i.Le.get()),i.ps(n,t),i.ys(t)}).then(function(t){i._e()}).catch(function(t){t.code===M.on.RELOAD_REQUIRED?i.reload({updatedSiteConf:JSON.parse(t.message),reloadScriptConf:!1}):i.Ce(t)})},x.prototype.Ns=function(){this.Subject=M.bi,this.ErrorCode=M.on},x.prototype.ys=function(t){var n;0===E.default.state.Ms&&(n=E.default.getUser(),t!==v.Zt.READ_ONLY&&t!==v.Zt.N4R&&(t!==v.Zt.JWT&&t!==v.Zt.NO_REGISTRATION&&t!==v.Zt.EMAIL||n)?this.Ze(n):this.rs(!1))},x.prototype.Is=function(){window.n4rConfig||window.n4rTechnicalConfig?(t=window.n4rConfig,n=window.n4rTechnicalConfig,i=window.n4rConfig,e=null,s="{}",this.je=!window.n4rNoAnalytics):(o=N.As(),t=(r=y.Rs(o)).config,n=r.technicalConfig,i=r.scriptConfig,e=r.updatedConfig,s=o),f.default.N=t,f.default._=s,f.default.I=n,f.default.A=i;var t,n,i,e,s,r=t.logger,o=(r&&(f.default.O=A.P[r.ki()]),f.default.ye=N.Us(f.default.I.env_subdom),f.default.Me=N.xs(f.default.I.env_subdom),f.default.Ie=N.ks(f.default.I.env_subdom),t.custom_auth);return this.ds=null==o?void 0:o.enabled,D.default.gn="fn"===(null==o?void 0:o.jwt),I.default(R.lt,"Extracted configuration",f.default.N,f.default.I,f.default.A),e},x.prototype.Ls=function(t){var t=decodeURIComponent(t.substring(1)),n=y.Rs(t),i=n.config,e=n.technicalConfig,n=n.scriptConfig,t=(f.default.N=i,f.default._=t,f.default.I=e,f.default.A=n,i.logger);t&&(f.default.O=A.P[t.ki()]),I.default(R.lt,"Updated configuration",f.default.N,f.default.I,f.default.A)},x.prototype.js=function(){var t=this.je&&f.default.I.global_name?f.default.I.global_name:"now4real";this.Fe(t),window[t]=this},Object.defineProperty(x.prototype,"config",{get:function(){return f.default.N},Fs:!1,Gs:!0}),x.prototype.Ee=function(){var l=this;this.Oe=new n.default({Js:function(){I.default(R.lt,"onPageHiding call",document.visibilityState),S.default.publish(v.Qt.PageHiding,null)},Hs:function(){I.default(R.lt,"onPageShowing call"),l.gs?S.default.publish(v.Qt.PageShowing,null):l.load()}}),this.fs.push(function(){l.Oe.reset()}),t.default.init({Vs:function(n,i,t){I.default(R.lt,"onProxyCommand call",n,i,t);function e(t){t.then(function(t){l.Ws(n,i,s,t)}).catch(function(t){l.Ws(n,i,r,t)})}var s="resolve",r="reject",o="subject";switch(i){case"startProxyLogin":e(l.qs());break;case"stopProxyLogin":l.Bs();break;case"reload":l.reload(t[0]);break;case"destroy":l.destroy();break;case"subscribe":var u=t[0];l.subscribe(u,null,t[1],!0).then(function(t){t[o]=u,l.Ws(n,i,s,t)}).catch(function(t){t[o]=u,l.Ws(n,i,r,t)});break;case"unsubscribe":var a=t[0];l.unsubscribe(a,!0).then(function(t){t[o]=a,l.Ws(n,i,s,t)}).catch(function(t){t[o]=a,l.Ws(n,i,r,t)});break;case"post":e(l.post(t[0],t[1],!0));break;case"logout":case"deleteMessage":case"flushChat":case"setChatEnabled":case"getMute":case"setMute":case"startTyping":case"stopTyping":case"reportMessage":case"registerUserConsent":case"createPoll":case"closePoll":case"sendVote":case"getPollVote":case"getOlderMessages":case"editMessage":case"setLoggerLevel":e(l[i].apply(l,t));break;case"browserPreferences.getItem":case"browserPreferences.setItem":case"browserPreferences.removeItem":var c=i.split("."),h=l[c[0]];e(h[c[1]].apply(h,t));break;default:I.default(R.ct,"Unsupported message",n,i,t)}}},this.context.Hi,this.context.an),this.fs.push(function(){t.default.reset()})},x.prototype.ns=function(t){var n;-1<t.message.indexOf("client")?n="DISCONNECTED:UNSUPPORTED_CLIENT":-1<t.message.indexOf("browser")?n="DISCONNECTED:UNSUPPORTED_BROWSER":t.code===M.on.CREDIT_EXHAUSTED&&(n="DISCONNECTED:CREDIT_EXHAUSTED"),n&&(this.Ys(n),this.zs())},x.prototype.bs=function(){var n=this,t=s.default.Si(),i=t.init(this.version,this.Le,this.context.un,"demo"===f.default.N.target,this.je,this.ds,this.Ue);t.Ks({Xs:function(t){n.Ys(t),S.default.publish(v.Qt.ConnectionStatus,t)},$s:function(){n.Ys("DISCONNECTED:JWT_EXPIRED"),n.zs(),n.Qs(!1)},Zs:function(){n.Ys("DISCONNECTED:CONFIG_CHANGED"),n.zs(),n.Qs(!1)},tr:function(){n.Ys("DISCONNECTED:CREDIT_EXHAUSTED"),n.zs(),n.Qs(!1)},nr:function(){n.Ys("DISCONNECTED:UNSUPPORTED_CLIENT"),n.zs(),n.Qs(!1)},ir:function(){E.default.state.us(2),E.default.ts(null),t.hs().then(function(t){E.default.es()}).then(function(t){return n.$e.Xe().then(function(t){return E.default.Qe(t)})}).then(function(t){n.rs()})},er:function(t){n.Ls(t)}}),this.Be=t,this.Ss=i,this.sr=i.connectionDetails},x.prototype.Es=function(t){var n=this,i=e.default.Si();i.init(t,function(){return n.Ke.context}),this.$e=i,E.default.$e=i},x.prototype.Os=function(){var n=this,t=new k.default(S.default,this.Oe);t.init(function(){var t;n.Be.rr(),null!=(t=n.ur)&&t.ar()},function(){var t;0!==n.Te&&(n.Be.cr(),null!=(t=n.ur))&&t.hr()}),D.default.En=t},x.prototype.Ds=function(){this.lr(this.Ei.find(d.default.ft)),S.default.subscribe(v.Qt.PageHiding,this.dr.bind(this)),S.default.subscribe(v.Qt.PageShowing,this.vr.bind(this))},x.prototype.wr=function(t,n){var i=this;N.mr(function(){i.pr(t,n||null)})},x.prototype.pr=function(t,n){var i,e=this.Ei.find(t.type),n=n||e.Rn();if(I.default(R.lt,"notifyEvent for subject: "+this.Ei.find(t.type).name,t,n),-1<n.indexOf(1)&&(i=new a.ee({lsn:t.type,data:t}),this.notify(i,"p")),-1<n.indexOf(0)&&N.De(e.listener)){t.data&&delete t.data._snap;try{e.listener(t)}catch(t){I.default(R.ut,t.message)}}},x.prototype.notify=function(t,n){var i,e;!this.context||this.je&&"p"===n||(e=i=void 0,e="p"===n?(i=window.parent,void 0!==f.default.I.file_name?"*":this.context.Hi):(i=window,"*"),i.postMessage({cmd:t.cmd,payload:N.An(t.payload)},e))},x.prototype.gr=function(t){t=new _.me(t);this.wr(t,[0,1])},x.prototype.br=function(t){t=new _.me(t);this.wr(t,[0,1])},x.prototype.Ys=function(t){var n=this.Ei.find(M.bi.CONNECTION_STATUS),i=n.snapshot.status;t!==i&&("DISCONNECTED"!==t||"DISCONNECTED:CREDIT_EXHAUSTED"!==i&&"DISCONNECTED:CONFIG_CHANGED"!==i&&"DISCONNECTED:UNSUPPORTED_CLIENT"!==i&&"DISCONNECTED:JWT_EXPIRED"!==i)&&(n.Ln(i={status:t},this),this.wr(new _.pe(i),[0,1]))},x.prototype.Ve=function(){this.Ei.find(M.bi.AUTHORIZATION).Ln(P.default.state,this),this.pr(new _.we(P.default.state),[0,1])},x.prototype.Er=function(i){var t=this,n=this.Sr.get(i);return void 0===n?(I.default(R.lt,i+" not found in cache"),new Promise(function(n){t.Sr.watch(i,function(t){I.default(R.lt,"Resolved "+i,t),n(t)})})):Promise.resolve(n)},x.prototype.lr=function(e,t,n,s){var r,o,u,a=this,c=e.toString(),h=e.category,l=!1,i=new Promise(function(n,i){o=function(){var t="onSubscription call: "+c;l&&(t="re-".concat(t)),I.default(R.lt,t),l?3!==h&&a.zs(e):(n({}),s&&N.De(s.onAfterFirstSub)&&s.onAfterFirstSub(),l=!0)},u=function(t,n){l?I.default(R.ut,"Automatic "+c+" subscription recovery error",t,n):(delete a.Or[c],t===v.nn.Unauthorized?i(new C.default(M.on.NOT_AUTHORIZED,'not authorized to perform the "'+e.id+'" subscription')):i(new C.default(M.on.TECHNICAL_PROBLEM,t.toString())))}}),f={Pr:o,Tr:u,Cr:function(t,n,i){I.default(R.ct,c+" itemLostUpdates call",t,n,i),a.zs(e),a.Ss.unsubscribe(r),a.Ss.subscribe(r)},Dr:function(t,n){I.default(R.lt,c+" onClearSnapshot call",t,n),a.zs(e)}};if(n)for(var d in n)f[d]=n[d];switch(h){case 3:r=this.Nr(e,f,t);break;case 6:r=this._r(e,f);break;case 1:r=this.yr(e,f);break;case 10:r=this.Mr(e,f);break;case 2:r=this.Ir(e,f);break;case 4:r=this.Ar(e,f);break;case 5:r=this.Rr(e,f);break;case 9:r=this.Ur(e,f);break;case 7:r=this.kr(e,f);break;case 8:r=this.Lr(e,f);break;case 12:r=this.jr(e,f);break;case 11:r=this.Fr(e,f)}return this.Ss.subscribe(r),this.Or[c]=r,i},x.prototype.jr=function(a,t){var c=this,n=a.prefix+":"+(f.default.N.scope===d.default.kt?this.context.Gr||this.context.Jr:this.context.Hr),n=(I.default(R.lt,"Computed item: "+n),new U.Subscription(a.mode,n,a.Tn));return n.setRequestedSnapshot("yes"),n.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemUpdate:function(t){var i,t=N.Vr(t.getValue,t),n=t("b"),e=t("q"),s=t("o"),r=t("v"),o=t("t"),t=t("m"),u=(I.default(R.lt,a.id+" update ("+c.sr.getSessionId()+")",n,e,s,r,o,t),null),r=(e&&(s=s.split("\t"),i=N.Wr(r),u={closed:null===t,question:e,answers:s.map(function(t,n){return{text:t,percentage:i[n]}}),votesCount:o,multipleChoice:1<Number(t),startDate:N.qr(n)}),a.Ln(u,c),new _.le(u));c.wr(r)}}),n},x.prototype.Fr=function(r,t){var o=this,n=r.prefix+":"+(f.default.N.scope===d.default.kt?this.context.Gr||this.context.Jr:this.context.Hr),n=(I.default(R.lt,"Computed item: "+n),new U.Subscription(r.mode,n,r.Tn));return n.setRequestedSnapshot("yes"),n.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemUpdate:function(t){var t=N.Vr(t.getValue,t),n=t("q"),i=t("m"),e=t("b"),t=t("c"),s=(I.default(R.lt,r.id+" update ("+o.sr.getSessionId()+")",n,i,e,t),null),n=(n&&(s={question:n,closed:null===i,startDate:N.qr(e)},t)&&(s.closeDate=N.qr(t)),r.Ln(s,o),new _.he(s));o.wr(n)}}),n},x.prototype.Mr=function(s,t){var r=this,n=s.prefix+":"+d.default.Ft,n=(I.default(R.lt,"Computed item: "+n),new U.Subscription(s.mode,n,s.Tn));return n.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemUpdate:function(t){var t=N.Vr(t.getValue,t),n=t("t");if(I.default(R.lt,s.prefix+" update ("+r.sr.getSessionId()+")",n),"e"===n)F.timeout(f.default.X,D.default.bn.send(new c.zi)).then(function(t){I.default(R.lt,"obtained new JWT",t);try{r.Be.Br(t),r.$e.Yr(t)}catch(t){throw t}}).catch(function(t){I.default(R.ut,t.message)});else if("c"===n)try{var i=t("p"),e=JSON.parse(i).payload;I.default(R.lt,"authentication switch event received",e),E.default.abort(),E.default.getUser()||r.zr(r.Be.cs(v.Zt.SOCIAL,e),!1,!1)}catch(t){I.default(R.ut,"authentication switch event error",t.message)}}}),n.setRequestedSnapshot("no"),n.setDataAdapter("EVENT"),n},x.prototype.Lr=function(t,n){var r=this,o=t.toString(),i=t.prefix+":"+(f.default.N.scope===d.default.kt?this.context.Gr||this.context.Jr:this.context.Hr),i=(I.default(R.lt,"Computed item: "+i),new U.Subscription(t.mode,i,t.Tn));return i.setRequestedSnapshot(d.default.Ut),i.addListener({onSubscription:n.Pr,onSubscriptionError:n.Tr,onItemUpdate:function(t){var n,t=N.Vr(t.getValue,t),i=t(d.default.bt),e=t("d"),t=t("p"),s=(I.default(R.lt,o+" update ("+r.sr.getSessionId()+")",i,e,t),(n={})[d.default.Et]=d.default.UPDATE,n[d.default.bt]=i,n.d=e||null,n.p=t||null,n.i=null,n.u=null,n.s=null,n.r=null,n.e=t?"e":"",n.isSnapshot=function(){return!1},n.getValue=function(t){return void 0!==s[t]?s[t]:null},n);r.ur.Kr(s).then(function(t){var n;t&&(I.default(R.lt,"CHAT evt upds",t),(n=r.Ei.find(M.bi.LIST_CHAT_MESSAGES)).Ln(r.ur.get(),r),t.forEach(function(t){t._snap=n.snapshot;t=new _.ve(t);r.wr(t)}))}).catch(function(t){I.default(R.lt,t)})}}),i},x.prototype.kr=function(c,t){var h=this,n=c.prefix+":"+(f.default.N.scope===d.default.kt?this.context.Gr||this.context.Jr:this.context.Hr),n=(I.default(R.lt,"Computed item: "+n),new U.Subscription(c.mode,n,c.Tn));return n.setRequestedSnapshot(d.default.Rt),n.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemUpdate:function(t){var n,i,e,s,r,o,u,a=N.Vr(t.getValue,t),t=(I.default(R.lt,c.prefix+" update ("+h.sr.getSessionId()+", "+t.isSnapshot()+")",a(d.default.Et)+"-"+a(d.default.bt)+"-"+a("n")+"-"+a("i")+"-"+a("p")+"-"+a("r")+"-"+a("b")+"-"+a("bf")+"-"+a("bb")),a(d.default.Et));t!==d.default.St&&t!==d.default.UPDATE||(t=a(d.default.bt),n=a("n"),i=a("i"),e=a("p"),s=a("r"),o=a("b"),u=a("bf"),a=a("bb"),r=null,s&&(r=N.Xr(s,o,u,a)),u=N.$r(o={id:t,nick:n,icon:i,provider:e},r?r.role:null,r?r.badge:null),h.Sr.set(u),(a=h.Ei.find(M.bi.LOGIN_STATUS).snapshot.user)&&a.id===u.id&&(h.xe||h.ke||w.default.Qr(n,i),E.default.Zr(s?r.role:null,s?r.badge:null),h.Ze(o)))}}),n},x.prototype.yr=function(t,n){var i=f.default.N.scope===d.default.kt&&t.name===d.default.dt?d.default.qt+"/":""+d.default.Bt+this.context.Ae,i=t.prefix+":"+i,i=(I.default(R.lt,"Computed item: "+i),new U.Subscription(t.mode,i,t.Tn));return i.addListener({onSubscription:n.Pr,onSubscriptionError:n.Tr}),i},x.prototype.Nr=function(i,t,n){var e=this,s=i.toString(),r=i.prefix+":"+(f.default.N.scope===d.default.kt?this.context.Gr||this.context.Jr:this.context.Hr),r=(I.default(R.lt,"Computed item: "+r),new U.Subscription(i.mode,r,i.Tn)),n=!(n&&!n.snapshot);return r.setRequestedSnapshot(n?d.default.Rt:d.default.Ut),r.setSelector("u"),r.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemLostUpdates:t.Cr,onClearSnapshot:t.Dr,onEndOfSnapshot:function(){e.ur.no()},onItemUpdate:function(t){var n=N.Vr(t.getValue,t);I.default(R.lt,s+" update ("+e.sr.getSessionId()+", "+t.isSnapshot()+")",n(d.default.bt),n("u"),n("i"),n("p"),n("r"),n("s"),n("d"),n("e")),n(d.default.Et)!==d.default.Ot&&e.ur.Kr(t).then(function(t){t&&(I.default(R.lt,"CHAT upds",t),i.Ln(e.ur.get(),e),t.forEach(function(t){t._snap=i.snapshot;t=new _.ve(t);e.wr(t)}))}).catch(function(t){I.default(R.lt,t)})}}),i.zn(d.default.$t,n),r},x.prototype.Ur=function(T,t){var C=this,n=f.default.N.scope===d.default.kt?d.default.qt+"/":""+d.default.Bt+this.context.Ae,n=T.prefix+":"+n,n=(I.default(R.lt,"Computed item: "+n),new U.Subscription(T.mode,n,T.Tn));return n.setRequestedSnapshot(d.default.Rt),n.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemLostUpdates:t.Cr,onItemUpdate:function(t){try{var n=N.Vr(t.getValue,t),i=n("ml"),e=n("mlm"),s=n("md"),r=n("cd"),o=n("mh"),u=n("gr"),a=n("mv"),c=n("cb"),h=n("mc"),l=n("me"),f=n("mr");if(I.default(R.lt,T.toString()+" update ("+C.sr.getSessionId()+", "+t.isSnapshot()+")",i,e,s,r,o,u,a,c,h,l,f),null!==i&&null!==e&&null!==r){var d=Number(i),v=Number(e),w=Number(h),m=N.io(s),p=N.eo(l),g=N.eo(f),b=void 0;switch(r){case"M":b="DISABLED_BY_MODERATOR";break;case"A":b="DISABLED_BY_ADMINISTRATOR";break;default:b="ENABLED"}var E,S,O,P=void 0;switch(u){case"1":P="G";break;case"2":P="PG";break;case"3":P="PG-13";break;case"4":P="R";break;default:P="DISABLED"}NaN!==d&&NaN!==v&&(E={messageMaxLength:d,messageMaxLengthModerator:v,messageMaxLengthGuest:v,messageDurationValue:m.value,messageDurationUnit:m.unit,chatStatus:b,clickableLinks:"a"===o?"ALL":"INTERNALS",gifsStatus:P,chatbotEnabled:"1"===c,listChatMessagesInitialCount:w,messageEditDuration:p,messageDeleteDuration:g},T.Ln(E,C),S=new _.de(E),C.wr(S,[0,1]),C.ur)&&(O=null!==s?N.so(m.value,m.unit):null,C.ur.ro(null!==O?1e3*O:null),C.ur.oo(N.qr(a)))}a&&(D.default.Sn=N.qr(a))}catch(t){I.default(R.ut,"Error while processing parameters update: "+t.message)}}}),n},x.prototype.Ir=function(i,t){var n,e=this,s=i.prefix,r=i.name,o=i.context,u=i.toString();switch(o){case 0:n=r!==M.bi.COUNTER_CHAT_TYPING&&r!==M.bi.COUNTER_CHAT_MESSAGES||f.default.N.scope!==d.default.kt?s+":"+this.context.Hr:s+":"+(this.context.Gr||this.context.Jr);break;case 1:n=s+":"+(this.context.Re||this.context.un);break;case 2:n=s+":"+d.default.Ft;break;case 3:n=s+":"+(this.context.un+i.Nn)}I.default(R.lt,"Computed item: "+n);o=new U.Subscription(i.mode,n,i.Tn);return o.setRequestedSnapshot(d.default.Rt),o.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemLostUpdates:t.Cr,onItemUpdate:function(t){var n=(n=N.Vr(t.getValue,t)(i.Tn[0]))&&n.toString();I.default(R.lt,u+" update ("+e.sr.getSessionId()+", "+t.isSnapshot()+")",n),n!==i.snapshot.value?(i.Ln(t={value:n},e),n=new _.ce(r,t),e.wr(n)):I.default(R.lt,"Discarded counter update",i)}}),o},x.prototype.Ar=function(r,t){var o=this,u=r.toString(),a=r.name,n=r.prefix+":"+(2===r.context?d.default.Ft:this.context.Re||this.context.un),i=(I.default(R.lt,"Computed item: "+n),!1),e=N.An(r.Tn),e=this.je?e.concat(["f"]):e,n=new U.Subscription(r.mode,n,e);return n.setRequestedSnapshot(d.default.Rt),n.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemLostUpdates:t.Cr,onClearSnapshot:t.Dr,onEndOfSnapshot:function(){var t;I.default(R.lt,u+" endOfSnapshot call"),i||(i=!0,t=new _.ae(a,o.ao.uo()),o.wr(t))},onItemUpdate:function(t){var n=N.Vr(t.getValue,t),n=(I.default(R.lt,u+" update ("+o.sr.getSessionId()+", "+t.isSnapshot()+")",n(d.default.bt),n(d.default.Et),n("i"),n("t"),n("c"),n("p")),o.ao.Kr(r,t));if(n){r.Ln(o.ao.get(u,!0),o);for(var i=0,e=n;i<e.length;i++){var s=e[i],s=(s._snap=r.snapshot,new _.ae(a,s));o.wr(s)}}else I.default(R.lt,"Discarded "+u+" ranking update")}}),n},x.prototype._r=function(i,t){var e=this,s=i.toString(),n=i.prefix+":"+(f.default.N.scope===d.default.kt?this.context.Gr||this.context.Jr:this.context.Hr),n=(I.default(R.lt,"Computed item: "+n),new U.Subscription(i.mode,n,i.Tn));return n.setRequestedSnapshot(d.default.Rt),n.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemLostUpdates:t.Cr,onClearSnapshot:t.Dr,onItemUpdate:function(t){var n=N.Vr(t.getValue,t);I.default(R.lt,s+" update ("+e.sr.getSessionId()+", "+t.isSnapshot()+")",n(d.default.bt),n(d.default.Et)),e.ho.Kr(t).then(function(t){i.Ln(e.ho.get(),e),t._snap=i.snapshot;t=new _.fe(t);e.wr(t)}).catch(function(t){I.default(R.lt,t)})}}),n},x.prototype.Rr=function(r,t){var n,o=this,u=r.id,i=r.prefix,a=r.name;switch(r.context){case 0:n=i+":"+this.context.Hr;break;case 1:n=i+":"+(this.context.Re||this.context.un);break;default:I.default(R.ut,"H sub unsupported context")}I.default(R.lt,"Computed item: "+n);var e=new U.Subscription(r.mode,n,r.Tn);return e.setRequestedSnapshot(d.default.Rt),e.addListener({onSubscription:t.Pr,onSubscriptionError:t.Tr,onItemLostUpdates:t.Cr,onItemUpdate:function(t){var n=N.Vr(t.getValue,t),n=(I.default(R.lt,u+" update ("+o.sr.getSessionId()+", "+t.isSnapshot()+")",n("c"),n("h")),o.lo.Kr(u,t));if(n){r.Ln(o.lo.get(u),o);for(var i=0,e=n;i<e.length;i++){var s=e[i],s=(s._snap=r.snapshot,new _.ue(a,s));o.wr(s)}}else I.default(R.lt,"Discarded "+u+" update")}}),e},x.prototype.vr=function(){var t=this.Ei.find(d.default.ft).id,n=this.Or[t];n?(this.Ss.subscribe(n),I.default(R.lt,"Subscribe "+t)):I.default(R.ct,"Undefined "+t)},x.prototype.dr=function(){var t=this.Ei.find(d.default.ft).id,n=this.Or[t];n?(this.Ss.unsubscribe(n),I.default(R.lt,"Unsubscribe "+t)):I.default(R.ct,"Undefined "+t)},x.prototype.fo=function(){var t=this.Ei.find(d.default.dt);return I.default(R.lt,"Subscribe "+t.id),this.lr(t)},x.prototype.do=function(){var t=this.Ei.find(d.default.dt).id;this.vo(t),I.default(R.lt,"Unsubscribe "+t)},x.prototype.Ps=function(){var t=this.Ei.find(M.bi.PARAMETERS);this.lr(t),I.default(R.lt,"Subscribe "+t.id)},x.prototype.Cs=function(){var t=this.Ei.find(d.default.gt);this.lr(t),I.default(R.lt,"Subscribe "+t.id)},x.prototype.wo=function(){var t=this.Ei.find(d.default.vt);void 0===this.Or[t.id]&&this.lr(t)},x.prototype.Ws=function(t,n,i,e){t=new a.ie({id:t,fn:n,res:i,data:e});this.notify(t,"p")},x.prototype.Ts=function(){this.Sr||(this.Sr=new i.default)},x.prototype.mo=function(){var t=this.Ei.find(d.default.wt);this.Or[t.id]||this.lr(t)},x.prototype.vo=function(t){this.Or[t]?(this.Or[t].isActive()?this.Ss.unsubscribe(this.Or[t]):I.default(R.lt,"Already unsubscribed",t),delete this.Or[t]):I.default(R.ct,"Subscription flow sync error",t,this.Or)},x.prototype.po=function(n,t,i,e){var s,r,o=this,u=null,a=n.category,c=n.toString(),h=n.qn()?void 0===n.listener:void 0===this.Or[c];switch(n.Un(e.bo?1:0),a){case 3:this.wo(),this.ur||(this.ur=b.default.Si()),h&&(I.default(R.lt,"Initilize subject: "+n),this.mo(),r=(s=this.Ei.find(M.bi.PARAMETERS)).snapshot.messageDurationValue,s=s.snapshot.messageDurationUnit,r=r&&s?N.so(r,s):null,this.ur.init(this.Er.bind(this),this.$e.Eo.bind(this.$e),this.Sr,r&&1e3*r,D.default.Sn||null,function(t){t&&0<t.length&&(I.default(R.lt,"CHAT upds",t),n.Ln(o.ur.get(),o),t.forEach(function(t){t._snap=n.snapshot;t=new _.ve(t);o.wr(t)}))}),u=this.lr(n,i,null));break;case 6:this.wo(),this.ho||(this.ho=g.default.Si()),h&&(I.default(R.lt,"Initilize subject: "+n),this.ho.init(this.Er.bind(this)),u=this.lr(n,null,null));break;case 2:case 12:case 11:h&&(I.default(R.lt,"Initilize subject: "+n),u=this.lr(n,null,null));break;case 4:void 0===this.ao&&(this.ao=p.default.Si()),h&&(I.default(R.lt,"Initilize subject: "+n),this.ao.init(c,this.Ke,this.je),u=this.lr(n,null,null));break;case 5:void 0===this.lo&&(this.lo=m.default.Si()),h&&(I.default(R.lt,"Initilize subject: "+n),this.lo.init(c),u=this.lr(n,null,null))}return h&&!n.qn()&&n.kn(this),e.bo&&(e.bo,N.De(n.listener))||n.Jn(t),null!==u?u:new Promise(function(t){t({}),N.mr(function(){o.So(n,e.bo)})})},x.prototype.Oo=function(t,n){var i=t.toString(),e=t.Rn().length,n=n.bo?1:0;return 1===e?(t.xn(n),t.qn()||(this.vo(i),t.Fn(this)),t.Yn()?this.Ei.destroy(t):t.Hn(),t.name===M.bi.LIST_CHAT_MESSAGES?(e=this.Ei.find(d.default.wt),this.vo(e.id),null!=(i=this.ur)&&i.reset(),t.Xn(d.default.$t)):t.name===M.bi.LIST_CHAT_TYPING&&this.ho.Po(),new Promise(function(t){t({})})):(t.xn(n),0==n&&t.Hn(),Promise.resolve({}))},x.prototype.zs=function(t){if(t)this.To(t);else for(var n in I.default(R.lt,"Reset snapshot"),this.Or)this.To(this.Ei.Ti(n))},x.prototype.So=function(n,t){I.default(R.lt,"notifySnapshot",n,t);var i=n.category,e=n.name,s=n.id,r=[t?1:0];if(n.qn())this.wr(new _.ge(n.name,n.snapshot),r);else switch(i){case 3:var o=this.ur.snapshot().map(function(t){return l(l({},t),{_snap:n.snapshot})});if(0<o.length)for(var u=0;u<o.length;u++)this.wr(new _.ve(o[u]),r);break;case 4:var a=this.ao.snapshot(s);if(a.push(this.ao.uo()),a.map(function(t){return l(l({},t),{_snap:n.snapshot})}),0<a.length)for(u=0;u<a.length;u++)this.wr(new _.ae(e,a[u]),r);break;case 5:var c=this.lo.snapshot(s).map(function(t){return l(l({},t),{_snap:n.snapshot})});if(0<c.length)for(u=0;u<c.length;u++)this.wr(new _.ue(e,c[u]),r);break;case 6:var h=this.ho.snapshot().map(function(t){return l(l({},t),{_snap:n.snapshot})});if(0<h.length)for(u=0;u<h.length;u++)this.wr(new _.fe(h[u]),r);break;case 2:null!==n.snapshot.value&&this.wr(new _.ce(e,n.snapshot),r)}},x.prototype.To=function(e){var s=this,t=e.category,n=e.name,r=e.toString();switch(t){case 3:this.ur.Co().then(function(t){var n=t.map(function(t){return l(l({},t),{_snap:e.In})});if(0<n.length){for(var i=0;i<n.length;i++)s.wr(new _.ve(n[i]));e.Ln(s.ur.get(),s),I.default(R.lt,"Reset "+r+" subscription")}});break;case 4:var i=this.ao.Co(r).map(function(t){return l(l({},t),{_snap:e.In})});if(0<i.length){for(var o=0;o<i.length;o++)this.wr(new _.ae(n,i[o]));e.Gn(this),I.default(R.lt,"Reset "+r+" subscription")}break;case 5:var u=this.lo.Co(r).map(function(t){return l(l({},t),{_snap:e.In})});if(0<u.length){for(o=0;o<u.length;o++)this.wr(new _.ue(n,u[o]));e.Gn(this),I.default(R.lt,"Reset "+r+" subscription")}break;case 6:this.ho.Co().then(function(t){var n=t.map(function(t){return l(l({},t),{_snap:e.In})});if(0<n.length){for(var i=0;i<n.length;i++)s.wr(new _.fe(n[i]));e.Gn(s),I.default(R.lt,"Reset "+r+" subscription")}});break;case 2:null!==e.snapshot.value&&(this.wr(new _.ce(n,e.In)),e.Gn(this),I.default(R.lt,"Reset "+r+" subscription"))}},x.prototype.rs=function(t){I.default(R.lt,"handleLogout call",t=void 0===t?!0:t),4!==E.default.state.Ms&&(E.default.state.us(4),t&&(this.xe||this.ke?((t=D.default.os).removeItem(this.xe?f.default.tt:f.default.it),t.removeItem(this.xe?f.default.nt:f.default.et)):w.default.Do()),t={status:"NOT_AUTHENTICATED"},this.Ei.find(M.bi.LOGIN_STATUS).Ln(t,this),this.br(t),S.default.publish(v.Qt.Authentication,{authorization:E.default.No()}))},x.prototype.Ze=function(t){I.default(R.lt,"handleLogin call",t),3!==E.default.state.Ms&&E.default.state.us(3);var n,i=this.Ei.find(M.bi.LOGIN_STATUS),e=i.snapshot,s=!this.ds||(null==(s=E.default.getUser())?void 0:s.consent),r=!this.ds&&(this.xe?D.default.os._o():!w.default.yo()),o=E.default.getDetails(),s={status:"AUTHENTICATED",user:N.Mo(t,s,(null==o?void 0:o.role)||null,(null==o?void 0:o.badge)||null,(null==o?void 0:o.preferences)||null),persistent:r};N.Io(e,s)||(i.Ln(s,this),this.gr(s),S.default.publish(v.Qt.Authentication,{user:t,authorization:E.default.No()}));try{var u=N.$r(t,(null==o?void 0:o.role)||null,(null==o?void 0:o.badge)||null);null!=(n=this.Sr)&&n.set(u)}catch(t){I.default(R.ut,"Error saving logged user on userInfoCache",t)}},x.prototype.Qs=function(t){var n;for(void 0===t&&(t=!0);this.fs.length;)null!=(n=this.fs.shift())&&n();t&&this.Ne()},x.prototype._load=function(i){var r,o=this;return I.default(R.ht,"_load call",arguments),(i=i||location.href)&&N.Ao(i)?(r=function(t){return t.startsWith(d.default.Pt)?t:d.default.Pt+"://"+t},new Promise(function(e,n){var s=o.Ke.Ro(r(i));(t=>(o.Le=new O.default(t,o.Ke.Uo()),("now4real.com"===(t=t)?Promise.resolve('{"s":3,"v":3}'):o.Le.fetch(t).then(function(t){return t.responseText})).then(function(t){return o.Le.update(t).status})))(s).then(function(t){0!==t?(t=i,document.customReferrer=r(t),o.context=o.Ke.update(null,null),S.default.subscribe(v.Qt.Load,function(t){var n=o.ws,i=n.master;e({siteContext:s,master:i,group:n.group})}),S.default.subscribe(v.Qt.LoadError,function(t){n(t)}),o.start()):(t=new C.default(M.on.CURRENTLY_DISABLED,"the site is currently disabled"),o.Ce(t),n(t))}).catch(function(t){t=403===t.statusCode?new C.default(M.on.INVALID_CALL,"the site is not registered yet"):new C.default(M.on.TECHNICAL_PROBLEM,t.statusCode);o.Ce(t),n(t)})})):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,""))},x.prototype.setLoggerLevel=function(t){if(I.default(R.ht,"setLoggerLevel call",arguments),!t)return Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid level argument"));if(!N.Ao(t))return Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"level must be a string"));t=t.toLowerCase().ki();if(void 0===A.P[t])return Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid level name"));f.default.O=A.P[t];t=new a.ne({level:A.P[t]});return this.notify(t,"p"),this.notify(t,"s"),Promise.resolve({})},x.prototype.subscribe=function(t,n,i,e){var s;return void 0===e&&(e=!1),I.default(R.ht,"subscribe call",arguments),N.Ao(t)?(s=this.Ei.find(t))?!s.Bn()&&s.name===t||3===this.Te?12!==s.category&&11!==s.category||3===this.Te?s.name!==t?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"not customizable subject")):e||N.De(n)?!e&&-1<s.Rn().indexOf(0)?Promise.reject(new C.default(M.on.INVALID_CALL,"already subscribed subject")):this.po(s,n,i,{bo:e}):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"callback must be a function")):Promise.reject(new C.default(M.on.INVALID_CALL,"poll is a Premium feature")):(s.Bn()&&this.Ei.destroy(s),Promise.reject(new C.default(M.on.INVALID_CALL,"custom context is a Premium feature"))):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"subject not exists")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"subject must be a string"))},x.prototype.unsubscribe=function(t,n){return void 0===n&&(n=!1),I.default(R.ht,"unsubscribe call",arguments),N.Ao(t)?(t=this.Ei.find(t))?!t.qn()&&!t.Wn()||t.qn()&&void 0===t.listener?Promise.reject(new C.default(M.on.INVALID_CALL,"not subscribed subject")):this.Oo(t,{bo:n}):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"subject not exists")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"subject must be a string"))},x.prototype.get=function(t){I.default(R.ht,"get call",arguments);var n=this.Ei.find(t);if(!n||n.name!==t)throw new C.default(M.on.INVALID_ARGUMENTS,"invalid subject");if(n.Wn())return n.snapshot;throw new C.default(M.on.INVALID_CALL,"not subscribed subject")},x.prototype.editUserProfile=function(){var t,n,i,e;return I.default(R.ht,"editUserProfile call",arguments),this.ds?Promise.reject(new C.default(M.on.INVALID_CALL,"not supported using custom auth")):(t=this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user)?(n=this.Ke.context.un,i=this._whiteLabel,e=null==(e=this.Le.get())?void 0:e.siteKey,E.default.editUserProfile(n,e,t.id,i)):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated"))},x.prototype.login=function(t){I.default(R.ht,"login call",arguments);var n,i,e,s,r=this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status;return/^DISCONNECTED:/.test(r)?Promise.reject(new C.default(M.on.INVALID_CALL,"the client is on an unrecoverable disconnection status")):this.Ue?Promise.reject(new C.default(M.on.INVALID_CALL,"not supported on this browser")):this.ds?Promise.reject(new C.default(M.on.INVALID_CALL,"not supported using custom auth")):3===E.default.state.Ms?Promise.reject(new C.default(M.on.INVALID_CALL,"the user is already authenticated")):(r=this.xe,n=this.ke,i=this._whiteLabel,r||n||!t||N.Ao(t)?r||n||!t||void 0!==v.sn[t]||t===d.default.EMAIL?void 0!==E.default.window?(E.default.window.focus(),Promise.reject(new C.default(M.on.ALREADY_STARTED,"already opened authentication window"))):(e=this.Ke.context.un,s=null==(s=this.Le.get())?void 0:s.siteKey,this.zr(r?E.default.xo(e,s,i):E.default.ko(e,t,s,n,i),n,r)):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid provider name")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"provider must be a string")))},x.prototype.qs=function(){I.default(R.lt,"startProxyLogin");var t=this.xe,n=this.ke;return this.zr(E.default.Lo(t),n,t)},x.prototype.Bs=function(){I.default(R.lt,"stopProxyLogin"),E.default.jo()},x.prototype.zr=function(t,i,e){var n=this;return t.then(function(t){return i||e?D.default.os.setItem(i?f.default.it:f.default.tt,t):w.default.Fo(t),E.default.ts(t.id),t}).then(function(t){return n.Be.cs(e?v.Zt.NO_REGISTRATION:i?v.Zt.EMAIL:v.Zt.SOCIAL,e?t.token:t)}).then(function(t){return E.default.reset(),n.$e.Xe().then(function(t){return E.default.Qe(t)})}).then(function(t){return n.Ze(t),t}).then(function(t){var n=E.default.getDetails();return{user:N.Mo(t,!0,n?n.role:null,n?n.badge:null,n?n.preferences:null),persistent:e||i?D.default.os._o():!w.default.yo()}}).catch(function(t){throw E.default.reset(),E.default.ts(null),n.ns(t),t})},x.prototype.logout=function(){var e,s=this,t=(I.default(R.ht,"logout call",arguments),this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status);return"DISCONNECTED"===t?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):/^DISCONNECTED:/.test(t)?Promise.reject(new C.default(M.on.INVALID_CALL,"the client is on an unrecoverable disconnection status")):this.ds?Promise.reject(new C.default(M.on.INVALID_CALL,"not supported using custom auth")):3!==E.default.state.Ms?Promise.reject(new C.default(M.on.INVALID_CALL,"already in readOnly state")):(e=E.default.ls(),new Promise(function(n,i){var t;E.default.state.us(2),E.default.ts(null),(s.xe?Promise.resolve():(t=s.ke?D.default.os.getItem(f.default.it).secret:w.default.Jo().Go,s.$e.Ho(t))).then(function(t){return s.Be.hs()}).then(function(t){E.default.es()}).then(function(t){return s.$e.Xe().then(function(t){return E.default.Qe(t)})}).then(function(t){s.rs(!0),n({})}).catch(function(t){s.ns(t),E.default.ts(e),i(t)})}))},x.prototype.post=function(t,n,r){var i,e,o=this;return void 0===r&&(r=!1),I.default(R.ht,"post call",arguments),N.Ao(t)?""===t?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"message can't be empty")):(e=this.Ei.find(M.bi.PARAMETERS),i=(i=E.default.getDetails())?i.role:null,e=N.Vo(e,i),I.default(R.lt,"using pars: "+e+", "+this.Wo),N.qo(t)>e?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"message too long")):"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?null!==this.Wo?Promise.reject(new C.default(M.on.TOO_FREQUENT,"posting rate exceeded, please wait for the required interval")):!this.ds||E.default.getUser().consent||this._whiteLabel?new Promise(function(s,i){o.$e.Bo(t,n).then(function(t){var n=t.w||0,t=t.s,i=1e3*n,e={waitPeriod:i};t&&(e.suggestions=t),0!==n&&(o.Wo=window.setTimeout(function(t){o.Wo=null,I.default(R.lt,"Posting re-enabled")},i)),"api+widget"===f.default.N.target&&(o._suggestions=n=t||null,r)&&(i=new a.Zi({suggestions:n}),o.notify(i,"s")),s(e)}).catch(function(t){var n=t;t instanceof C.default||(n="MUTED"===t?new C.default(M.on.USER_MUTED,"the user is muted"):"SEND_RATE"===t?new C.default(M.on.TOO_FREQUENT,"posting rate exceeded, please wait for the required interval"):"MODERATION"===t?new C.default(M.on.CANNOT_MODERATE,"the automatic content filtering system doesn't respond"):"CHAT_DISABLED"===t?new C.default(M.on.CHAT_DISABLED,"the chat is currently disabled"):"FILTERED"===t?new C.default(M.on.BLOCKED,"the message was blocked by an automatic moderation filter as it was deemed inappropriate"):"CHATBOT"===t?new C.default(M.on.CHATBOT,"an error occurred with the site's chatbot. Please try again"):new C.default(M.on.TECHNICAL_PROBLEM,"")),i(n)})}):Promise.reject(new C.default(M.on.INVALID_CALL,"the consent of the current user has not been recorded")):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated"))):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"message must be a string"))},x.prototype.deleteMessage=function(t){return t?N.Ao(t)?this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.Yo(t):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"msgId must be a string")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"msgId is required"))},x.prototype.flushChat=function(){var t;return this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?(t=E.default.getDetails())&&t.role===d.default.Vt?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.zo().then(function(t){return{}}):Promise.reject(new C.default(M.on.INVALID_CALL,"the user is not a MODERATOR")):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated"))},x.prototype.setChatEnabled=function(t){var n;return void 0!==t&&N.Ko(t)?this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?(n=E.default.getDetails())&&n.role===d.default.Vt?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.Xo(t).then(function(t){return{}}):Promise.reject(new C.default(M.on.INVALID_CALL,"the user is not a MODERATOR")):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid enabled argument"))},x.prototype.getMute=function(t){return I.default(R.ht,"getMute call",arguments),void 0!==t&&N.Ao(t)?this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.$o(t).then(function(t){return t?{expiration:(t=t.expiration)?new Date(t).getTime():null}:null}):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid userId argument"))},x.prototype.setMute=function(t,n){var i;return I.default(R.ht,"setMute call",arguments),void 0!==t&&N.Ao(t)?void 0===n||null!==n&&!N.Qo(n)?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid duration argument")):this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?(i=E.default.getDetails())&&i.role===d.default.Vt?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.Zo(t,n).then(function(t){return t?{expiration:(t=t.expiration)?new Date(t).getTime():null}:null}):Promise.reject(new C.default(M.on.INVALID_CALL,"the user is not a MODERATOR")):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid userId argument"))},x.prototype.startTyping=function(){var i=this;return I.default(R.ht,"startTyping call",arguments),this.Or[this.Ei.find(d.default.dt).toString()]?Promise.reject(new C.default(M.on.INVALID_CALL,"the user has already started to type")):new Promise(function(t,n){i.fo().then(function(){t({})}).catch(function(t){n(t)})})},x.prototype.stopTyping=function(){return I.default(R.ht,"stopTyping call",arguments),this.Or[this.Ei.find(d.default.dt).toString()]?(this.do(),Promise.resolve({})):Promise.reject(new C.default(M.on.INVALID_CALL,"the user has already stopped to type"))},x.prototype.reload=function(t){if(this.je)throw new Error("Unsupported feature");var n=null!=(n=null==t?void 0:t.startOpen)&&n,i=null!=(i=null==t?void 0:t.updatedSiteConf)?i:null,t=null==(t=null==t?void 0:t.reloadScriptConf)||t;this.notify(new c.Xi(n,i,t),"p")},x.prototype.destroy=function(){if(this.je)throw new Error("Unsupported feature");this.notify(new c.Ki,"p")},x.prototype.reportMessage=function(t,n,i){I.default(R.ht,"reportMessage call",arguments);var e="invalid msgId argument",s="invalid reason argument";return void 0!==t&&N.Ao(t)?void 0!==n&&N.Ao(n)?i&&!N.Ao(i)?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid comment argument")):i&&500<i.length?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"comment too long")):this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.tu(t,n,i).catch(function(t){var n=t;throw n=t instanceof C.default?n:"INVALID_MESSAGE_ID"===t?new C.default(M.on.INVALID_ARGUMENTS,e):"INVALID_REASON"===t?new C.default(M.on.INVALID_ARGUMENTS,s):"DUPLICATED"===t?new C.default(M.on.ALREADY_REPORTED,"the user has already reported the msg"):"MUTED"===t?new C.default(M.on.USER_MUTED,"the user is muted"):new C.default(M.on.TECHNICAL_PROBLEM,"")}):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,s)):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,e))},x.prototype.registerUserConsent=function(){var t,n=this;return I.default(R.ht,"registerUserConsent call",arguments),this.ds?(t=E.default.getUser())?t.consent?Promise.resolve({}):"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.nu().then(function(t){return E.default.iu(),n.Ze(E.default.getUser()),{}}):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_CALL,"feature not supported in the current authentication mode"))},x.prototype.createPoll=function(t,n,i){var e;return I.default(R.ht,"createPoll call",arguments),!t||!N.Ao(t)||100<N.qo(t)?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid question argument")):!n||!N.isArray(n)||n.length<2||10<n.length||n.some(function(t){return!N.Ao(t)||25<N.qo(t)})?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid answers argument")):void 0===(i=null==i?void 0:i.multipleChoice)||N.Ko(i)?3!==this.Te?Promise.reject(new C.default(M.on.INVALID_CALL,"poll is a Premium feature")):this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?!(e=E.default.getDetails())||e.role!==d.default.Vt&&e.role!==d.default.Wt?Promise.reject(new C.default(M.on.INVALID_CALL,"the user is not a MODERATOR or GUEST")):"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):(n=n.map(function(t){return t.trim()}),this.$e.eu(t,n,i?n.length:1).catch(function(t){var n=t;throw n=t instanceof C.default?n:"ALREADY_PRESENT"===t?new C.default(M.on.ALREADY_PRESENT,"there is already an active poll"):"DISABLED"===t?new C.default(M.on.CHAT_DISABLED,"the chat was disabled by the Administrator"):new C.default(M.on.TECHNICAL_PROBLEM,"")})):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid options argument"))},x.prototype.closePoll=function(t){var n;return void 0===t&&(t=!1),I.default(R.ht,"closePoll call",arguments),void 0===t||N.Ko(t)?3!==this.Te?Promise.reject(new C.default(M.on.INVALID_CALL,"poll is a Premium feature")):this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?!(n=E.default.getDetails())||n.role!==d.default.Vt&&n.role!==d.default.Wt?Promise.reject(new C.default(M.on.INVALID_CALL,"the user is not a MODERATOR or GUEST")):"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.su(t).catch(function(t){var n=t;throw n=t instanceof C.default?n:"NOT_FOUND"===t?new C.default(M.on.NOT_FOUND,"there is no active poll"):new C.default(M.on.TECHNICAL_PROBLEM,"")}):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid remove argument"))},x.prototype.sendVote=function(i){return I.default(R.ht,"sendVote call",arguments),i&&N.isArray(i)&&!i.some(function(t){return!N.Qo(t)||!i.every(function(t,n){return i.indexOf(t)===n})})?3!==this.Te?Promise.reject(new C.default(M.on.INVALID_CALL,"poll is a Premium feature")):this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.ru(i).catch(function(t){var n=t;throw n=t instanceof C.default?n:"INVALID_VOTE"===t?new C.default(M.on.INVALID_ARGUMENTS,"invalid votes argument"):"NOT_FOUND"===t?new C.default(M.on.NOT_FOUND,"there is no active poll"):"CLOSED"===t?new C.default(M.on.CLOSED,"the current poll has already been closed"):"DISABLED"===t?new C.default(M.on.CHAT_DISABLED,"the chat is currently disabled"):new C.default(M.on.TECHNICAL_PROBLEM,"")}):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid votes argument"))},x.prototype.getPollVote=function(){return I.default(R.ht,"getPollVote call",arguments),3!==this.Te?Promise.reject(new C.default(M.on.INVALID_CALL,"poll is a Premium feature")):this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):this.$e.ou().then(function(t){return{vote:t.vote||[]}}).catch(function(t){var n=t;throw n=t instanceof C.default?n:"NOT_FOUND"===t?new C.default(M.on.NOT_FOUND,"there is no active poll"):new C.default(M.on.TECHNICAL_PROBLEM,"")}):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated"))},x.prototype.getOlderMessages=function(t){var n,r,i,o=this;return I.default(R.ht,"getOlderMessages call",arguments),void 0!==t&&(!N.Qo(t)||t<1||50<t)?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid count argument")):"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):(r=this.Ei.find(M.bi.LIST_CHAT_MESSAGES)).Wn()?(null==(n=r.snapshot)?void 0:n.length)>=f.default.ot?Promise.resolve({messages:[],hasMore:!1}):r.getMetadata(d.default.$t)?this.ur.uu()?Promise.reject(new C.default(M.on.INVALID_CALL,"the chat snapshot is being processed")):this.ur.au()?Promise.reject(new C.default(M.on.INVALID_CALL,"older messages are currently being fetched")):r.snapshot.length?(i=t||f.default.st,this.ur.cu(i).then(function(t){var n=t.messages,i=t.hu;if(i&&0<i.length){I.default(R.lt,"CHAT add upds",i),r.Ln(o.ur.get(),o);for(var e=i.length-1;0<=e;e--){var s=i[e],s=(s._snap=r.snapshot,new _.ve(s));o.wr(s)}}return n}).then(function(t){return{messages:t,hasMore:t.length===i}})):Promise.reject(new C.default(M.on.INVALID_CALL,"the chat subject doesn't contain any messages")):Promise.reject(new C.default(M.on.INVALID_CALL,"the chat snapshot is required")):Promise.reject(new C.default(M.on.INVALID_CALL,"subscribe the chat subject first"))},x.prototype.editMessage=function(t,n){var e=this;return I.default(R.ht,"editMessage call",arguments),void 0===t?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"msgId is required")):N.Ao(t)?void 0===n?Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"newMsg is required")):n&&N.Ao(n)?this.Ei.find(M.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===this.Ei.find(M.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new C.default(M.on.DISCONNECTED,"the client is disconnected from the server")):null!==this.Wo?Promise.reject(new C.default(M.on.TOO_FREQUENT,"posting rate exceeded, please wait for the required interval")):this.$e.lu(t,n).then(function(t){var t=t.w||0,n=1e3*t,i={waitPeriod:n};return 0!==t&&(e.Wo=window.setTimeout(function(t){e.Wo=null,I.default(R.lt,"Posting re-enabled")},n)),i}).catch(function(t){var n=t;throw n=t instanceof C.default?n:"MUTED"===t?new C.default(M.on.USER_MUTED,"the user is muted"):"SEND_RATE"===t?new C.default(M.on.TOO_FREQUENT,"posting rate exceeded, please wait for the required interval"):"MODERATION"===t?new C.default(M.on.CANNOT_MODERATE,"the automatic content filtering system doesn't respond"):"CHAT_DISABLED"===t?new C.default(M.on.CHAT_DISABLED,"the chat is currently disabled"):"FILTERED"===t?new C.default(M.on.BLOCKED,"the message was blocked by an automatic moderation filter as it was deemed inappropriate"):"CHATBOT"===t?new C.default(M.on.CHATBOT,"an error occurred with the site's chatbot. Please try again"):new C.default(M.on.TECHNICAL_PROBLEM,"")}):Promise.reject(new C.default(M.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid newMsg argument")):Promise.reject(new C.default(M.on.INVALID_ARGUMENTS,"invalid msgId argument"))},x);function x(){var n,i=this;this.version="0.106.0-269-g33f0785",this.Or={},this.Wo=null,this.gs=!1,this.Ei=o.default.Si(),this.je=!1,this.ds=!1,this.xe=!1,this.ke=!1,this.Ue=!1,this.fs=[],u.default(),this.Ge()&&(n=this.Is(),this.js(),this.Ke=r.default.Si(),this.je||top===self||this.Ke.init().then(function(t){if(I.default(R.lt,"Retrieved context",t),i.context=t,i._ourOrigin=i.context.an,i._parentOrigin=i.context.Hi,D.default.Hi=i.context.Hi,h.Ni())throw new C.default(M.on.TECHNICAL_PROBLEM,"Unsupported browser");i.Le=new O.default(i.context.un,i.context.an,i.context.cn),i.Le.ln(n).then(function(t){i.start()}).catch(function(t){I.default(R.ut,t),i.Ce(t)})}).catch(function(t){i.Ce(t)}))}V.be=G}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,11:11,12:12,13:13,14:14,15:15,18:18,19:19,2:2,20:20,21:21,23:23,24:24,25:25,26:26,27:27,28:28,3:3,30:30,31:31,33:33,34:34,35:35,36:36,38:38,40:40,41:41,42:42,43:43,44:44,5:5,6:6,7:7,9:9}],18:[function(t,n,i){var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t}).apply(this,arguments)},r=(Object.defineProperty(i,"t",{value:!0}),t(40)),u=t(1),a=t(7),c=t(2),e=t(10),h=t(42),l=t(44),f=t(43),d=t(34),v=t(2),t=(s.prototype.fu=function(t){this.mode=t?"nore":"oauth",window.addEventListener("message",this.du,!1)},s.prototype.vu=function(){this.mode=null,window.removeEventListener("message",this.du)},s.prototype.onError=function(t){this.promise.wu(t),this.state.us(this.state.mu),this.state.mu=void 0,this.reset()},s.prototype.No=function(){return this.authorization},s.prototype.reset=function(){this.pu&&(clearInterval(this.pu),this.pu=void 0),void 0!==this.window&&(this.window.close(),this.window=void 0),this.promise.reset(),this.vu()},s.prototype.abort=function(){this.state!==this.state.mu&&void 0!==this.promise.wu&&this.onError(new h.default(f.on.ABORTED,"closed authentication window"))},s.prototype.Lo=function(i){var e=this;return new Promise(function(t,n){e.promise.set(t,n),e.state.mu=e.state.Ms,e.state.us(1),e.fu(i)})},s.prototype.jo=function(){var t,n;null!=(n=(t=this.promise).wu)&&n.call(t),this.reset()},s.prototype.gu=function(t,n,i){var e=this,s=(void 0===n&&(n=!1),void 0===i&&(i=!0),this.Di?void 0:"login"),t=window.open(t,s);return r.bu(t)?Promise.reject(new h.default(f.on.BLOCKED,"authentication popup was blocked")):i?(this.window=t,this.state.mu=this.state.Ms,this.state.us(1),this.fu(n),new Promise(function(t,n){e.promise.set(t,n),e.pu=window.setInterval(function(t){try{e.window&&!e.window.opener&&void 0!==u.default.I.file_name?(d.default(v.lt,"Found communication issue",e.window,e.window.opener),1===e.state.Ms&&e.onError(new h.default(f.on.TECHNICAL_PROBLEM,"cannot access authentication page"))):e.window&&e.window.closed&&(d.default(v.lt,"Auth window closed"),1===e.state.Ms)&&e.onError(new h.default(f.on.ABORTED,"closed authentication window"))}catch(t){d.default(v.ut,t)}},u.default.q)})):Promise.resolve({})},s.prototype.Eu=function(t,n){var i=u.default.N.widget,t={site:t,lang:i.language};return!1!==n&&(t.wl=n,t.logo=i.logo_url,t.bgColor=i.color_internal_background),t},s.prototype.editUserProfile=function(t,n,i,e){i=l.ks(u.default.Ie,"email-signin/step1",o({action:"EDIT_PROFILE",userId:i,siteKey:n},this.Eu(t,e)));return this.gu(i,!1,!1)},s.prototype.ko=function(t,n,i,e,s){var r=u.default.N.widget,n=l.ks(u.default.Ie,"oauth-signin",o({provider:e?c.default.EMAIL:n,siteKey:e?i:null,cm:e?r.consent_message:null,sid:e?null:a.default.sid},this.Eu(t,s)));return this.gu(n)},s.prototype.xo=function(t,n,i){var e=u.default.N.widget,n=l.ks(u.default.Ie,"no-registration-signin",o({siteKey:n,cm:e.consent_message},this.Eu(t,i)));return this.gu(n,!0)},s.prototype.iu=function(){this.Su=o(o({},this.getUser()),{consent:!0})},s.prototype.ts=function(t){this.Ou=t},s.prototype.Qe=function(t){d.default(v.lt,"storeDetails",t);var n=t.authentication,i=t.authorization,i=(n&&(this.Su=o({icon:null,consent:!0},n),this.Ou=n.id),i&&(this.authorization=i),null),e=t.role,n=(e&&(i={role:(e=r.Xr(e,n&&n.badge,n&&n.badgeFg,n&&n.badgeBg)).role,badge:e.badge}),t.preference);if(n)try{(i=i||{}).preferences=JSON.parse(n)}catch(t){d.default(v.ut,t)}return i&&(this.details=i),this.getUser()},s.prototype.es=function(){d.default(v.lt,"resetDetails"),this.Su=null,this.details=null,this.authorization=null,this.Ou=null},s.prototype.Zr=function(t,n){d.default(v.lt,"updateRole",t,n);var i=this.details||{};t?(i.role=t,i.badge=n):(delete i.role,delete i.badge),Object.keys(i).length?this.details=i:this.details=null},s.prototype.Pu=function(t){d.default(v.lt,"updatePreferences",t);var n=this.details||{};t?n.preferences=t:delete n.preferences,Object.keys(n).length?this.details=n:this.details=null},s.prototype.getUser=function(){return this.Su&&r.An(this.Su)},s.prototype.ls=function(){return this.Ou},s.prototype.getDetails=function(){return this.details&&r.An(this.details)},s);function s(){var i=this;this.state={mu:void 0,Ms:0,us:function(t){this.Ms=t}},this.$e=void 0,this.En=void 0,this.window=void 0,this.pu=void 0,this.Di=e.Di(),this.promise={Tu:void 0,wu:void 0,set:function(t,n){this.Tu=t,this.wu=n},reset:function(){this.wu=this.Tu=void 0}},this.Ou=null,this.du=function(t){var n=u.default.I.our_origin;t.origin===n&&t&&t.data&&t.data.fn===i.mode+".callback"&&t.data.payload&&(d.default(v.lt,"userAppResponseListener",t.data),i.state.us(2),a.default.En.Cu()&&a.default.En.Du(),i.pu&&(clearInterval(i.pu),i.pu=void 0),i.promise.Tu(t.data.payload))}}i.default=new t},{1:1,10:10,2:2,34:34,40:40,42:42,43:43,44:44,7:7}],19:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(1),s=t(40),r=t(5),o=t(3),u=t(34),a=t(2),t=(c.prototype.init=function(t){var n=this,t=t.authorization;this.state=this.Nu(t),(null==(t=null==(t=e.default.N)?void 0:t.custom_auth)?void 0:t.enabled)||r.default.subscribe(o.Qt.Authentication,function(t){t=n.Nu((null==t?void 0:t.authorization)||{});s.Io(n.state,t)||(n.state=t,s.De(n._u)&&n._u(t))})},c.prototype.We=function(t){this._u=t},c.prototype.Ye=function(){return s.An(this.perms)},c.prototype.yu=function(t,n,i,e){var s=[];t&&s.push("chatR"),n&&s.push("chatW"),i&&s.push("siteR"),e&&s.push("pageR"),this.perms=s},c.prototype.Nu=function(t){function n(t){return!1!==t}u.default(a.lt,"computeState",t);var i=n(t.chatR),e=n(t.chatW),s=n(t.siteR),t=n(t.pageR);return this.yu(i,e,s,t),{chatView:i,chatPost:e,siteCounterView:s,pageCounterView:t}},c);function c(){}i.default=new t},{1:1,2:2,3:3,34:34,40:40,5:5}],20:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(1),s=t(10),a=t(40),c=t(42),h=t(43),l=e.default.Z,f=t(34),d=t(2);function r(t){this.site=t,this.Mu()}r.prototype.Iu=function(){return e.default.J&&s.Ri()},r.prototype.Au=function(){try{return JSON.parse(localStorage.getItem(l)||"{}")}catch(t){return f.default(d.ut,"error parsing browser preferences",t),{}}},r.prototype.Mu=function(){if(this.Iu()){var t=this.Au(),n=Object.keys(t);if(n.length){for(var i=0,e=n;i<e.length;i++){var s=e[i],r=t[s]||{},o=Object.keys(r);if(o.length){for(var u=0,a=o;u<a.length;u++){var c=a[u],h=r[c];h.exp&&Date.now()>h.exp&&delete r[c]}Object.keys(r).length||delete t[s]}}Object.keys(t).length?localStorage.setItem(l,JSON.stringify(t)):localStorage.removeItem(l)}}},r.prototype.getItem=function(s){var r=this;return new Promise(function(t,n){if(s&&a.Ao(s)){if(r.Iu()){var i=r.Au(),e=i[r.site];if(f.default(d.lt,"browserPreferences.getItem",i,e),e){i=e[s];if(i){e=i.exp,i=i.val;if(!e||Date.now()<=e)return void t(i)}}}t(null)}else n(new c.default(h.on.INVALID_ARGUMENTS,"key must be a string"))})},r.prototype.setItem=function(s,r,o){var u=this;return new Promise(function(t,n){var i,e;s&&a.Ao(s)?void 0!==r&&(a.Ao(r)||a.Qo(r)||a.Ko(r))?void 0===o||a.Qo(o)?(u.Iu()&&(i=u.Au(),e={val:r},o&&(e.exp=Date.now()+o),f.default(d.lt,"browserPreferences.setItem",i,i[u.site],e),i[u.site]=i[u.site]||{},i[u.site][s]=e,localStorage.setItem(l,JSON.stringify(i))),t()):n(new c.default(h.on.INVALID_ARGUMENTS,"expirationInMs must be a number")):n(new c.default(h.on.INVALID_ARGUMENTS,"value must be a string, a number or a boolean")):n(new c.default(h.on.INVALID_ARGUMENTS,"key must be a string"))})},r.prototype.removeItem=function(s){var r=this;return new Promise(function(t,n){var i,e;s&&a.Ao(s)?r.Iu()?(e=(i=r.Au())[r.site],f.default(d.lt,"browserPreferences.removeItem",i,e),e&&void 0!==e[s]&&(delete e[s],Object.keys(e).length||delete i[r.site],Object.keys(i).length?localStorage.setItem(l,JSON.stringify(i)):localStorage.removeItem(l),t())):t():n(new c.default(h.on.INVALID_ARGUMENTS,"key must be a string"))})},i.default=r},{1:1,10:10,2:2,34:34,40:40,42:42,43:43}],21:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(2),s=t(10),r=t(40),o=t(34),u=t(2),t=(a.prototype.yo=function(){return this.Ru},a.prototype.Uu=function(){this.Ru=!0,o.default(u.lt,"SwitchToSessionMode call")},a.prototype.xu=function(){return s.Ri()||this.Ru?this.Ru?null!==this.ku:!!localStorage.getItem(e.default.Gt):null},a.prototype.Jo=function(){if(this.Ru)return{userId:this.ku.id,Go:this.ku.secret||null};try{var t=JSON.parse(localStorage.getItem(e.default.Gt));return{userId:t.id,Go:t.secret}}catch(t){return null}},a.prototype.Fo=function(t,n){void 0===n&&(n=!1),this.Ru||s.Ri()&&!n||this.Uu(),this.Ru?this.ku=t:localStorage.setItem(e.default.Gt,JSON.stringify(t)),o.default(u.lt,"User information stored (for_session="+this.Ru+")",t)},a.prototype.Lu=function(t){s.Ri()&&(localStorage.setItem(e.default.Jt,JSON.stringify({val:t,exp:Date.now()+36e5})),o.default(u.lt,"control link stored",t))},a.prototype.ju=function(){if(s.Ri())try{var t=localStorage.getItem(e.default.Jt),n=t&&JSON.parse(t);if(n){if(Date.now()<n.exp)return n.val;this.Fu()}}catch(t){o.default(u.ut,"error parsing control link",t),this.Fu()}return null},a.prototype.Fu=function(){s.Ri()&&localStorage.removeItem(e.default.Jt)},a.prototype.Do=function(){this.Ru?this.ku=null:localStorage.removeItem(e.default.Gt),o.default(u.lt,"DeleteCredential call")},a.prototype.getUser=function(){return this.xu()?this.Ru?this.ku:JSON.parse(localStorage.getItem(e.default.Gt)):null},a.prototype.Qr=function(t,n){if(this.xu()){var i=void 0;if((i=this.Ru?this.ku:JSON.parse(localStorage.getItem(e.default.Gt)))&&(i.nick!==t||i.icon!==n))return i.nick=t,i.icon=n,this.Fo(i),o.default(u.lt,"User info updated",i),!0}return!1},a.prototype.watch=function(i,e){var t;return this.Ru?null:(t=function(t){var n;t.key===i&&(n=JSON.parse(t.newValue||null),t=JSON.parse(t.oldValue||null),r.Io(n,t)||null!=e&&e(n,t))},window.addEventListener("storage",t),function(){window.removeEventListener("storage",t)})},a);function a(){this.Ru=!1,this.ku=null}i.default=new t},{10:10,2:2,34:34,40:40}],22:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var r=t(40),e=t(1),s=t(10),o=t(34),u=t(2);function a(t){this.siteKey=t,this.Iu()||(this.Gu={}),o.default(u.lt,"StoragePerSite init",t,!!this.Gu)}a.prototype.Iu=function(){return e.default.J&&s.Ri()},a.prototype.Au=function(){if(this.Gu)return this.Gu;try{return JSON.parse(localStorage.getItem(this.siteKey)||"{}")}catch(t){return o.default(u.ut,"error parsing bucket for: "+this.siteKey,t),{}}},a.prototype.Ju=function(){return this.siteKey},a.prototype.getItem=function(t){return this.Au()[t]},a.prototype.setItem=function(t,n){var i=this.Au();return i[t]=n,this.Gu||localStorage.setItem(this.siteKey,JSON.stringify(i)),n},a.prototype.removeItem=function(t){var n=this.Au();delete n[t],this.Gu||(Object.keys(n).length?localStorage.setItem(this.siteKey,JSON.stringify(n)):localStorage.removeItem(this.siteKey))},a.prototype.watch=function(i,e){var t,s=this;return this.Gu?null:(t=function(t){var n;t.key===s.siteKey&&(n=null==(n=JSON.parse(t.newValue||null))?void 0:n[i],t=null==(t=JSON.parse(t.oldValue||null))?void 0:t[i],r.Io(n,t)||null!=e&&e(n,t))},window.addEventListener("storage",t),function(){window.removeEventListener("storage",t)})},a.prototype._o=function(){return!this.Gu},i.default=a},{1:1,10:10,2:2,34:34,40:40}],23:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(39),s=t(3),r=t(40),o=t(34),u=t(2);function a(){this.Hu={},this.Vu=new e.default}a.prototype.get=function(t){return this.Hu[t]},a.prototype.set=function(t){var n=t.id,i=!!this.Hu[n],e=i&&r.Io(t,this.Hu[n]);this.Hu[n]=t,this.Vu.publish(n,t),i?e||(this.Vu.publish(s.Qt.UserUpdated,t),o.default(u.lt,"Updated details for user with id: "+n)):o.default(u.lt,"Saved details for user with id: "+n)},a.prototype.watch=function(t,n){return this.Vu.subscribe(t,n),o.default(u.lt,"Suscribed "+t+" topic"),n},a.prototype.unwatch=function(t,n){this.Vu.unsubscribe(t,n),o.default(u.lt,"Unsuscribed "+n+" from "+t+" topic")},a.prototype.Wu=function(){return Object.keys(this.Hu)},i.default=a},{2:2,3:3,34:34,39:39,40:40}],24:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var r=t(40),o=t(18),u=t(42),a=t(43),c=t(34),h=t(2);function e(t,n,i){this.$e=t,this.qu=n,this.Bu=i}e.prototype.Yu=function(t){var n=o.default.getDetails();return n&&n.preferences?t?n.preferences[t]||null:n.preferences:null},e.prototype.zu=function(){var t=o.default.getUser();r.De(this.Bu)&&this.Bu(t)},e.prototype.getItem=function(t){var n;return c.default(h.ht,"userPreferences.getItem call",arguments),void 0===t?Promise.reject(new u.default(a.on.INVALID_ARGUMENTS,"invalid key argument")):r.Ao(t)?(n=this.qu()).find(a.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===n.find(a.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new u.default(a.on.DISCONNECTED,"the client is disconnected from the server")):Promise.resolve(this.Yu(t)):Promise.reject(new u.default(a.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new u.default(a.on.INVALID_ARGUMENTS,"key must be a string"))},e.prototype.setItem=function(t,n){var i,e,s=this;return c.default(h.ht,"userPreferences.setItem call",arguments),void 0===t?Promise.reject(new u.default(a.on.INVALID_ARGUMENTS,"invalid key argument")):r.Ao(t)?void 0===n?Promise.reject(new u.default(a.on.INVALID_ARGUMENTS,"invalid value argument")):(i=this.qu()).find(a.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===i.find(a.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new u.default(a.on.DISCONNECTED,"the client is disconnected from the server")):((e=this.Yu()||{})[t]=n,this.$e.Ku(JSON.stringify(e)).then(function(t){o.default.Pu(e),s.zu()}).catch(function(t){var n=t;throw n=t instanceof u.default?n:"VALUE_TOO_LONG"===t?new u.default(a.on.QUOTA_EXCEEDED,"not enough remaining space for writing this key"):new u.default(a.on.TECHNICAL_PROBLEM,"")})):Promise.reject(new u.default(a.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new u.default(a.on.INVALID_ARGUMENTS,"key must be a string"))},e.prototype.removeItem=function(t){var n,i,e=this;return c.default(h.ht,"userPreferences.removeItem call",arguments),void 0===t?Promise.reject(new u.default(a.on.INVALID_ARGUMENTS,"invalid key argument")):r.Ao(t)?(n=this.qu()).find(a.bi.LOGIN_STATUS).snapshot.user?"DISCONNECTED"===n.find(a.bi.CONNECTION_STATUS).snapshot.status?Promise.reject(new u.default(a.on.DISCONNECTED,"the client is disconnected from the server")):(delete(i=this.Yu()||{})[t],this.$e.Ku(Object.keys(i).length?JSON.stringify(i):null).then(function(t){o.default.Pu(Object.keys(i).length?i:null),e.zu()})):Promise.reject(new u.default(a.on.NOT_AUTHENTICATED,"the user is not authenticated")):Promise.reject(new u.default(a.on.INVALID_ARGUMENTS,"key must be a string"))},i.default=e},{18:18,2:2,34:34,40:40,42:42,43:43}],25:[function(t,n,i){var d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t}).apply(this,arguments)},e=this&&this.__spreadArrays||function(){for(var t=0,n=0,i=arguments.length;n<i;n++)t+=arguments[n].length;for(var e=Array(t),s=0,n=0;n<i;n++)for(var r=arguments[n],o=0,u=r.length;o<u;o++,s++)e[s]=r[o];return e},m=(Object.defineProperty(i,"t",{value:!0}),t(34)),p=t(2),g=t(40),b=t(2),v=t(1),w=t(18),u=t(39),s=t(37),a=t(3);function E(){this.Xu=new s.default(!0,1e4,"cm"),this.$u=!1,this.Qu=null,this.Zu=null,this.ta=!1,this.na=!1,this.ia=null,this.ea=!1,this.sa=null,this.ra=null}E.Si=function(){return E.Oi=E.Oi?E.Oi:new E},E.prototype.cu=function(i){var r=this;return void 0===i&&(i=v.default.st),new Promise(function(s,n){if(0===r.oa.length)return m.default(p.ut,"Cannot load older messages: chat list is empty"),n(new Error("Chat list is empty"));r.oa.length+i>v.default.ot&&(i=v.default.ot-r.oa.length);var t=r.oa[0].id;m.default(p.lt,"Requesting "+i+" older messages before message "+t),r.na=!0,r.getOlderMessages(t,i,r.Sr.Wu()).then(function(t){var n,i=t.m||[],e=t.u||{},t=t.o||{};if(!e||!i)return m.default(p.ut,"Invalid response from getOlderMessages"),s({messages:[],hu:[]});Object.entries(e).forEach(function(t){var n=t[0];r.Sr.set(r.ua(d({id:n},t[1])))}),r.ta=!0;e=r.aa(i,e,t),t=e.map(function(t){return d({action:"ADD"},t)});(n=r.oa).unshift.apply(n,e),0<i.length&&r.ea&&null!==r.ia&&(m.default(p.lt,"Older messages added, rescheduling cleanup cycle"),clearTimeout(r.ia),r.ia=null,r.ca()),s({messages:e,hu:t})}).catch(function(t){m.default(p.ut,"Error loading older messages:",t),n(t)}).finally(function(){r.na=!1})})},E.prototype.init=function(n,t,i,e,s,r){var o=this;if(m.default(p.lt,"ChatManager init with parameters:",[n,t,i,e,s,r]),this.oa=[],this.ha=[],this.Er=n,this.la=e||null,this.fa=s||null,this.getOlderMessages=t||null,this.sa=r||null,this.Sr=i,this.da={},this.va=new u.default,"api"!==v.default.N.target){n="(?:[\\u{1F1E6}-\\u{1F1FF}]{2}|\\u{1F3F4}.{1,10}\\u{E007F}|(?:[\\p{Emoji_Presentation}\\p{Other_Symbol}]\\uFE0F?|[\\p{Letter}\\p{Number}\\p{Symbol}\\p{Punctuation}]\\uFE0F)[\\p{Emoji_Modifier}\\p{Enclosing_Mark}]*(?:\\u200D[\\p{Emoji}\\p{Number}\\p{Symbol}\\p{Punctuation}\\p{Enclosing_Mark}]\\uFE0F?\\p{Emoji_Modifier}*)*)";try{this.wa=new RegExp(n+"(?<!\\uFE0E)","gu")}catch(t){m.default(p.ut,"Error parsing emoji regex",t),this.wa=new RegExp(n,"gu")}}this.ra||(this.ra=i.watch(a.Qt.UserUpdated,function(t){var n,t=o.Qr(t);t&&0<t.length&&null!=(n=o.sa)&&n.call(o,t)}))},E.prototype.reset=function(){this.ar(),this.oa=[],this.ha=[],this.da={},this.$u=!1,this.Qu=null,this.Zu=null,this.ta=!1,this.na=!1,this.va=new u.default,this.Xu.Po(),this.ra&&this.Sr&&(this.Sr.unwatch(a.Qt.UserUpdated,this.ra),this.ra=null),m.default(p.lt,"ChatManager has been reset to initial state")},E.prototype.ro=function(t){this.la!==t&&(m.default(p.lt,"Updating messageExpirationTime from "+this.la+" to "+t+" ms"),this.la=t,this.ea&&null!==this.ia?(m.default(p.lt,"Expiration time changed, rescheduling cleanup cycle"),clearTimeout(this.ia),this.ia=null,this.ca()):this.ma())},E.prototype.oo=function(t){var n,i;this.fa!==t&&(i=this.fa?new Date(this.fa).toISOString():"not set",n=t?new Date(t).toISOString():"not set",m.default(p.lt,"Updating chatFlushDate from "+i+" to "+n),i=this.fa,this.fa=t,this.ea&&null!==this.ia&&null!==t&&(null===i||i<t)?(m.default(p.lt,"Flush date changed to a later time or newly set, rescheduling cleanup cycle"),clearTimeout(this.ia),this.ia=null,this.ca()):this.ma())},E.prototype.get=function(){return this.oa},E.prototype.pa=function(i,e){var s=this;return new Promise(function(n){for(var t=0;t<e.length;t++)if(e[t].id===i)return m.default(p.lt,"msg resolved from target list",e[t],t),void n(e[t]);s.da[i]?(m.default(p.lt,"msg resolved from outdated",s.da[i]),n(s.da[i])):s.va.subscribe(i,function(t){m.default(p.lt,"msg resolved",t),n(t)})})},E.prototype.Kr=function(t){function n(n){return!v&&e.$u?(m.default(p.lt,"Non-snapshot update "+r+" "+o+" waiting for snapshot completion"),new Promise(function(t){e.va.subscribe(E.ga,function(){m.default(p.lt,"Snapshot completed, now processing delayed update "+r+" "+o),n().then(t)})})):n()}var i,e=this,s=g.Vr(t.getValue,t),r=s(b.default.Et),o=s(b.default.bt),u=s("i"),a=s("u"),c=s("p"),h=s("s"),l=s("r"),f=s("d"),d="e"===s("e"),v=(m.default(p.lt,"Chat handle "+r+" "+o,this.Xu.ba()),t.isSnapshot()),s=!1,w=(!v||this.$u||(this.$u=!0,this.ha=[],this.Zu=[],this.da={},s=!0),v?this.ha:this.oa);switch(r){case b.default.St:i="o"!==h?this.Xu.add(function(t){return n(function(){var t,n=[e.Er(a)];return l&&(t=e.pa(l,w),n.push(t)),Promise.all(n).then(function(t){return e.Ea(w,o,u,c,f,t[0],t[1],d)})})}):this.Xu.add(function(t){return n(function(){return e.Er(a).then(function(t){return e.Sa(o,u,c,f,t,d)})})});break;case b.default.UPDATE:i=this.Xu.add(function(t){return n(function(){return e.pa(o,w).then(function(t){return e.Oa(w,t,f,c,d)})})});break;default:i=Promise.resolve(null)}return v&&i&&this.Zu.push(i),v?s?new Promise(function(t){e.Qu=t,m.default(p.lt,"Started processing snapshot")}):Promise.resolve([]):i},E.prototype.Ea=function(t,n,i,e,s,r,o,u){var a=this.Pa(n,i,e,s,r,o,u);if(0===t.length)m.default(p.lt,"insert "+n+" at head",t.length),t.push(a);else for(var c=t.length-1;0<=c;c--){if(a.time>=t[c].time){m.default(p.lt,"insert "+n+" at index "+(c+1),t.length),t.splice(c+1,0,a);break}0===c&&(m.default(p.lt,"insert "+n+" at head",t.length),t.unshift(a))}this.va.publish(n,a),this.va.Ta(n);var h=[];if(t===this.oa&&t.length>v.default.ot){for(var l=0;t.length>v.default.ot;){var f=t.shift();if(!f)break;f=this.Pa(f.id,null,null,null,null,null,null);h.push(d({action:"REMOVE"},f)),l++}0<l&&m.default(p.lt,"Max chat list length ("+v.default.ot+") exceeded. Removed "+l+" oldest message(s)")}return t===this.oa&&this.ma(),h.push(d({action:"ADD"},a)),h},E.prototype.Ca=function(t,n){if(!t.time)return!1;if(this.la&&t.time+this.la<=n)return!0;return!!(this.fa&&t.time<=this.fa)},E.prototype.Oa=function(t,n,i,e,s){for(var r=-1,o=0;o<t.length;o++)if(n.id===t[o].id){r=o;break}var u=null,u=!e&&i?this.Pa(n.id,null==(a=n.time)?void 0:a.toString(16),null,i,n.author,null,s):this.Pa(n.id,null==(a=n.time)?void 0:a.toString(16),e,i,n.author,n.repliesTo||null,s),a=[];return-1!==r?(e=t[r],this.Da(e,u)?(t.splice(r,1,u),a.push(d({action:"UPDATE"},u)),this.Na(t,e.id,u,a)):m.default(p.lt,"No changes detected for message "+n.id+", skipping update")):(m.default(p.lt,"Message "+n.id+" not found in list directly, checking for references"),this.Na(t,n.id,u,a)),a},E.prototype.Na=function(t,n,i,e){for(var s=0;s<t.length;s++){var r,o,u=t[s];u.repliesTo&&u.repliesTo.id===n&&(r=g.An(u),(o=g.An(i)).repliesTo&&delete o.repliesTo,r.repliesTo=o,t.splice(s,1,r),e.push(d({action:"UPDATE"},r)),m.default(p.lt,"Updated message "+u.id+" to reference updated message "+n))}},E.prototype.no=function(){var n=this;return m.default(p.lt,"endOfSnapshot"),this.$u?this.Xu.add(function(t){return Promise.all(n.Zu).then(function(){return n._a().then(function(){return[]})})}):this.Xu.add(function(t){return n._a().then(function(){return[]})})},E.prototype._a=function(){var f=this;return new Promise(function(i){m.default(p.lt,"Started finalizing snapshot",f.ha,f.oa);var n=Date.now(),e=f.oa.filter(function(t){return f.la&&t.time&&t.time+f.la<n?(m.default(p.lt,"Filtering out expired message: "+t.id,t.time),!1):!(f.fa&&t.time&&t.time<f.fa&&(m.default(p.lt,"Filtering out message older than chatFlushDate: "+t.id,"Message time: "+new Date(t.time).toISOString()+", FlushDate: "+new Date(f.fa).toISOString()),1))});if(f.oa.length!==e.length&&m.default(p.lt,"Filtered chatList from "+f.oa.length+" to "+e.length+" messages"),0===e.length||0===f.ha.length)m.default(p.lt,"Empty list detected"),h=f.ya(),f.Ma(i,h,!0);else if(f.ha[0].time<e[0].time)m.default(p.lt,"Oldest message in snapshot is older than oldest in filtered list"),h=f.ya(),f.Ma(i,h,!0);else{var s={},r=(e.forEach(function(t){s[t.id]=t}),null),t=!1;if(0<f.ha.length&&0<e.length&&f.ha[0].id===e[0].id)r=f.ha[0].id,t=!0,m.default(p.lt,"Overlap found at oldest message in both lists: "+r);else for(var o=0;o<f.ha.length;o++)if(s[f.ha[o].id]){r=f.ha[o].id;break}var u,a,c,h,l=!!r;m.default(p.lt,"Lists "+(l?"have":"do not have")+" overlap",l?"Message ID: "+r+", at oldest: "+t:""),!l||t?(h=f.ya(),f.Ma(i,h,!l)):f.getOlderMessages?((c=t=e.findIndex(function(t){return t.id===r}))>v.default.rt&&m.default(p.lt,"Overlap index ("+c+") exceeds maximum getOlderMessages limit ("+v.default.rt+")"),u=c>v.default.rt?c-v.default.rt:0,m.default(p.lt,"Trimming filteredChatList to indices ["+u+", "+t+")"),(!(a=t=null==(t=(e=e.slice(u,t))[e.length-1])?void 0:t.time)||f.oa.length&&f.oa[f.oa.length-1].time>t)&&(a=f.oa[f.oa.length-1].time),t=c-u,c=g.Ia(a),m.default(p.lt,"Calling getOlderMessages with: "+r+", "+t+", "+c),f.getOlderMessages(r,t,f.Sr.Wu(),c).then(function(t){var n;m.default(p.lt,"getOlderMessages succeeded, received "+((null==(n=t.m)?void 0:n.length)||0)+" messages"),t=t&&t.u&&t.m&&0<t.m.length?(n=f.aa(t.m,t.u,t.o),f.Aa(e,n)):(m.default(p.lt,"getOlderMessages returned empty list, local messages are up-to-date"),f.Ra(e,f.ha)),f.Ma(i,t,!l,0<u)}).catch(function(t){m.default(p.ut,"getOlderMessages failed with error",t);t=f.ya();f.Ma(i,t,!l,0<u)})):(m.default(p.lt,"No getOlderMessages available"),h=f.ya(),f.Ma(i,h,!l))}})},E.prototype.ua=function(t){var n=t.id,i=t.r,e=t.b,s=t.bf,r=t.bb,n={id:n,name:t.n,pic:t.i,provider:t.p};return void 0!==i&&(n.role="M"===i?b.default.Vt:b.default.Wt,n.badge={label:e,textColor:"#"+s,backgroundColor:"#"+r}),n},E.prototype.aa=function(t,a,c){var h=this;if(!a||!t)return m.default(p.ut,"Invalid response from getOlderMessages"),[];m.default(p.lt,"Processing "+t.length+" older messages");var l={};return t.forEach(function(t){l[t.k]=t}),t.map(function(t){var n=t.u,i=a[n],e=null;if(i?e=h.ua(d({id:n},i)):h.Sr&&(e=h.Sr.get(n))&&m.default(p.lt,"Found author for message "+t.k+" in userInfoCache"),!e)return m.default(p.ut,"Could not find user for message "+t.k+" in users object or userInfoCache",t),null;i=null;if(t.r){var n=t.r,s=null;if(c&&c[n]?s=c[n]:l[n]&&(s=l[n]),!s)return m.default(p.ut,"Message "+t.k+" replies to message "+n+" not found in available messages, discarding"),null;var r=s.u,o=a[r],u=null;if(o?u=h.ua(d({id:r},o)):h.Sr&&(u=h.Sr.get(r))&&m.default(p.lt,"Found reply author for message "+n+" in userInfoCache"),!u)return m.default(p.ut,"Could not find reply author for message "+n+", discarding message "+t.k),null;i=h.Pa(s.k,s.i,s.p,s.d,u,null,"e"===s.e),m.default(p.lt,"Message "+t.k+" replies to message "+n)}return h.Pa(t.k,t.i,t.p,t.d,e,i,"e"===t.e)}).filter(function(t){return null!==t})},E.prototype.ya=function(){return m.default(p.lt,"Using snapshot-only strategy"),e(this.ha)},E.prototype.Aa=function(t,n){var i={};n.forEach(function(t){i[t.id]=t}),m.default(p.lt,"Applying "+n.length+" updated messages to "+t.length+" filtered messages");for(var e=0;e<t.length;e++){var s=t[e],r=!1,o=s;i[s.id]&&(o=i[s.id],r=!0,m.default(p.lt,"Updated message: "+s.id)),null!=(s=o.repliesTo)&&s.id&&i[o.repliesTo.id]&&(r||(o=g.An(o)),(s=g.An(i[o.repliesTo.id])).repliesTo&&delete s.repliesTo,o.repliesTo=s,r=!0,m.default(p.lt,"Updated referencing message: "+o.id+" to reference updated message: "+o.repliesTo.id)),r&&(t[e]=o)}return this.Ra(t,this.ha)},E.prototype.Ra=function(t,n){return m.default(p.lt,"Merging "+n.length+" snapshot messages with "+t.length+" local messages"),e(t,n)},E.prototype.Ua=function(t){var i=w.default.ls();return t.map(function(t){var n;return t.author&&t.isMine!==(t.author.id===i)?((n=g.An(t)).isMine=t.author?t.author.id===i:null,n):t})},E.prototype.Ma=function(t,n,i,e){var n=this.Ua(n),s=this.xa(this.oa,n),r=!1;this.ta&&(i||e)&&(r=!0,m.default(p.lt,"Sending RESET update",i,e),s.unshift({action:"RESET"}),i)&&(this.ta=!1),m.default(p.lt,"Finalized snapshot with "+s.length+" updates"+(r?" (including RESET)":"")+", new chat list has "+n.length+" messages"),this.oa=n,this.Qu?this.Qu(s):this.sa(s),this.$u=!1,this.Qu=null,this.ha=[],this.Zu=[],this.va.publish(E.ga,null),this.va.Ta(E.ga),this.ma(),t(s)},E.prototype.uu=function(){return this.$u},E.prototype.au=function(){return this.na},E.prototype.ma=function(){this.ea?null===this.ia&&(m.default(p.lt,"Resuming paused message cleanup cycle"),this.ca()):(m.default(p.lt,"Activating message cleanup cycle"),this.hr())},E.prototype.xa=function(t,n){var i=this,e=[],s={},r=(t.forEach(function(t){s[t.id]=t}),{});return n.forEach(function(t){r[t.id]=t}),m.default(p.lt,"Calculating updates: "+t.length+" messages in old list, "+n.length+" in new list"),t.forEach(function(t){var n;r[t.id]||(n=i.Pa(t.id,null,null,null,null,null,null),e.push(d({action:"REMOVE"},n)),m.default(p.lt,"Generated REMOVE for message: "+t.id,JSON.stringify(n)))}),n.forEach(function(t){var n=s[t.id];n?i.Da(n,t)&&(e.push(d({action:"UPDATE"},t)),m.default(p.lt,"Generated UPDATE for message: "+t.id,JSON.stringify(n),JSON.stringify(t))):(e.push(d({action:"ADD"},t)),m.default(p.lt,"Generated ADD for message: "+t.id,JSON.stringify(t)))}),e},E.prototype.Da=function(t,n){return JSON.stringify(t)!==JSON.stringify(n)},E.prototype.Pa=function(t,n,i,e,s,r,o){var u,a=w.default.ls();if(!i&&e)switch(e){case"u":u="BY_AUTHOR";break;case"d":u="BY_ADMINISTRATOR";break;case"m":u="BY_MODERATOR";break;case"n":u="BY_NOW4REAL";break;case"r":u="BY_AI";break;default:u="UNKNOWN"}e={id:t,author:s||null,message:i||null,time:g.qr(n),isMine:s?s.id===a:null,edited:!i||u?null:!!o};if(u&&(e.deleted=u),r&&((t=g.An(r)).repliesTo&&delete t.repliesTo,e.repliesTo=t),i&&this.wa)try{for(var c=i.matchAll(this.wa),h=i,l=0,f=c.next();!f.done;){var d=f.value[0];if(l+=1,h=h.replace(d,""),3<l)break;f=c.next()}0<l&&l<4&&!h.trim().length&&(e.emojisCount=l)}catch(t){m.default(p.ut,"match error",t)}return e},E.prototype.Sa=function(t,n,i,e,s,r){n=this.Pa(t,n,i,e,s,null,r);return this.da[t]=n,this.va.publish(t,n),this.va.Ta(t),null},E.prototype.Qr=function(t){for(var n,i=[],e=0;e<this.oa.length;e++){var s=this.oa[e],r=!1,o=g.An(s);(null==(n=s.author)?void 0:n.id)===t.id&&(o.author=t,r=!0,m.default(p.lt,"Updating author for message: "+s.id)),s.repliesTo&&(null==(n=null==(n=s.repliesTo)?void 0:n.author)?void 0:n.id)===t.id&&(o.repliesTo.author=t,r=!0,m.default(p.lt,"Updating repliesTo.author for message: "+s.id)),r&&(this.oa.splice(e,1,o),i.push(d({action:"UPDATE"},o)))}return m.default(p.lt,"User update for "+t.id+" affected "+i.length+" messages"),i},E.prototype.Co=function(){this.Xu.Po();return this.Xu.add(function(t){return Promise.resolve([])})},E.prototype.snapshot=function(){for(var t=this.get(),n=[],i=0;i<t.length;i++)n.push(d({action:"ADD"},t[i]));return n},E.prototype.hr=function(){this.ar(),this.ea=!0,m.default(p.lt,"Starting dynamic message cleanup cycle"),this.ca()},E.prototype.ar=function(){null!==this.ia&&(clearTimeout(this.ia),this.ia=null,this.ea=!1,m.default(p.lt,"Stopped automatic message cleanup cycle"))},E.prototype.ca=function(){var t,n,i,e,s=this;this.ea&&null===this.ia&&(null===(t=this.ka())?(m.default(p.lt,"No messages to expire, cleanup cycle paused"),this.ia=null):(n=2147483647,i=t-(t=Date.now()),e=Math.min(Math.max(i,1e3),n),n<i&&m.default(p.lt,"Delay capped from "+i+"ms to "+e+"ms due to setTimeout limitations. Will recalculate after timeout."),m.default(p.lt,"Next cleanup scheduled in "+e+"ms at "+new Date(t+e).toISOString()),this.ia=setTimeout(function(){s.ia=null,s.La().then(function(){s.ca()}).catch(function(t){m.default(p.ut,"Error in cleanup cycle",t),s.ca()})},e)))},E.prototype.ka=function(){var t;return(this.la||this.fa)&&0!==this.oa.length&&null!=(t=this.oa[0])&&t.time?this.fa&&this.fa>t.time?Date.now():this.la?t.time+this.la:null:null},E.prototype.La=function(){var u=this;return!this.la&&!this.fa||0===this.oa.length?Promise.resolve([]):this.Xu.add(function(t){return new Promise(function(t){var n=Date.now(),i=[],e=[];m.default(p.lt,"Running cleanup cycle at "+new Date(n).toISOString());for(var s=0;s<u.oa.length;s++){var r=u.oa[s];u.Ca(r,n)&&(i.push(r),e.push(s),m.default(p.lt,"Message "+r.id+" marked for removal: expired"))}if(0===i.length)m.default(p.lt,"No expired messages found during cleanup cycle"),t([]);else{for(s=e.length-1;0<=s;s--)u.oa.splice(e[s],1);m.default(p.lt,"Cleanup cycle removed "+i.length+" expired messages");var o=i.map(function(t){t=u.Pa(t.id,null,null,null,null,null,null);return d({action:"REMOVE"},t)});if(u.sa)try{u.sa(o)}catch(t){m.default(p.ut,"Error in updates callback",t)}t(o)}})})},E.ga="SNAPSHOT_COMPLETED",i.default=E},{1:1,18:18,2:2,3:3,34:34,37:37,39:39,40:40}],26:[function(t,n,i){var s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t}).apply(this,arguments)},e=(Object.defineProperty(i,"t",{value:!0}),t(34)),r=t(2),o=t(40);function u(){this.ja={}}u.Si=function(){return u.Oi=u.Oi?u.Oi:new u},u.prototype.init=function(t){this.ja[t]={},e.default(r.lt,"Initialized "+t+" heatmap")},u.prototype.get=function(t){return this.ja[t]},u.prototype.Kr=function(t,n){var n=o.Vr(n.getValue,n),i=n("c"),n=n("h"),e=[];return i&&n?(i=o.Fa(i,n),e=[s({},i)],this.ja[t]=i):(e=[{}],this.ja[t]={}),e},u.prototype.Co=function(t){return this.ja[t]={},[{}]},u.prototype.snapshot=function(t){t=this.get(t);return[s({},t)]},i.default=u},{2:2,34:34,40:40}],27:[function(t,n,i){var h=this&&this.__assign||function(){return(h=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t}).apply(this,arguments)},l=(Object.defineProperty(i,"t",{value:!0}),t(34)),f=t(2),d=t(40),a=t(2),u=t(1);function e(){this.Ga={}}e.Si=function(){return e.Oi=e.Oi?e.Oi:new e},e.prototype.init=function(t,n,i){this.Ga[t]={map:{},buffer:{}},l.default(f.lt,"Initialized "+t+" ranking"),this.Ke=n,this.je=i},e.prototype.get=function(t,n){void 0===n&&(n=!1);var i,e=[],s=this.Ga[t].map;for(i in s){var r=d.An(s[i]);n&&delete r.position,e[s[i].position-1]=r}return e},e.prototype.Kr=function(t,n){var i=d.Vr(n.getValue,n),e=t.id,s=i(a.default.Et),r=i(a.default.bt),o=this.Ja(n,t),u=this.Ga[e].buffer;switch(s){case a.default.St:u[r]=o,l.default(f.lt,r+" ranking: adding "+r);break;case a.default.UPDATE:u[r]=o,l.default(f.lt,r+" ranking: updating "+r);break;case a.default.Ot:delete u[r],l.default(f.lt,r+" ranking: deleting "+r)}if(this.Ha(e)){i=this.Va(e);if(i)return this.Ga[e].map=d.An(u),i}return null},e.prototype.Va=function(t){var n,i=this.Ga[t].buffer,e=this.Ga[t].map,s=0,r=0,o=0,u=[];for(n in e)void 0===i[n]&&(s++,u.push(h({action:"LEAVE",key:e[n].key,position:null,users:e[n].users,title:e[n].title,url:e[n].url,isCurrentPage:e[n].isCurrentPage},this.je&&{favicon:e[n].favicon})));for(n in i){var a=d.An(i[n]),c=e[n];void 0===c?(r++,a.action="ENTER",u.push(a)):d.Io(c,a)||(o++,a.action="UPDATE",u.push(a))}return l.default(f.lt,"Diff "+t+" ranking: "+r+" add, "+o+" upd, "+s+" del",i,e),u},e.prototype.Ha=function(t){for(var n=this.Ga[t].buffer,t=Object.keys(n),i=t.length,e=t.map(function(t){return n[t].position}),s=1;s<=i;s++)if(-1===e.indexOf(s))return!1;return!0},e.prototype.Ja=function(t,n){var i,t=d.Vr(t.getValue,t),e=t(a.default.Et),s=t(a.default.bt),r=t("i")?Number(t("i"))+1:"",o={};return(o[a.default.bt]=s).startsWith(u.default.G)?(o.url=null,o.title=2===n.context?"Now4real Shared Public Sandbox":"Now4real Sandbox: "+s.substring(u.default.G.length)):(n=("s"===t("p")?"https":"http")+"://"+s,i=t("t"),o.url=n,i?o.title=i:(i=d.Je(n),o.title=i.pathname+i.search+i.hash)),o.users=t("c"),o.position=r,o.isCurrentPage=this.Ke.Wa(s),this.je&&(o.favicon=t("f")),e===a.default.Ot&&(o.url=o.title=o.users="",this.je)&&(o.favicon=""),o},e.prototype.uo=function(){return h({action:"INIT",key:null,position:null,users:null,title:null,url:null,isCurrentPage:null},this.je&&{favicon:null})},e.prototype.Co=function(t){for(var n=this.get(t),i=[],e=0;e<n.length;e++)i.push(h({action:"LEAVE",key:n[e].key,position:null,users:null,title:null,url:null,isCurrentPage:null},this.je&&{favicon:null}));return this.Ga[t]={map:{},buffer:{}},i},e.prototype.snapshot=function(t){for(var n=this.get(t),i=[],e=0;e<n.length;e++)i.push(h({action:"ENTER"},n[e]));return i},i.default=e},{1:1,2:2,34:34,40:40}],28:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var s=t(34),r=t(2),o=t(40),u=t(2),e=t(37);function a(){this.Xu=new e.default(!0,1e4,"tm"),this.qa={}}a.Si=function(){return a.Oi=a.Oi?a.Oi:new a},a.prototype.init=function(t){this.Er=t,this.qa={},s.default(r.lt,"Initialized typing")},a.prototype.get=function(){var n=this;return Object.keys(this.qa).map(function(t){return n.qa[t]})},a.prototype.Kr=function(t){var n=this,t=o.Vr(t.getValue,t),i=t(u.default.Et),e=t(u.default.bt);switch(s.default(r.lt,"Typing handle "+i+" "+e,this.Xu.ba()),i){case u.default.St:return this.Xu.add(function(t){return n.Er(e)}).then(function(t){return s.default(r.lt,"Adding "+e+" to typing"),n.qa[e]=t}).then(function(t){return{action:"START",user:t}});case u.default.Ot:return this.Xu.add(function(t){return n.Er(e)}).then(function(t){return s.default(r.lt,"Deleting "+e+" from typing"),delete n.qa[e],t}).then(function(t){return{action:"STOP",user:t}});default:return Promise.reject("Unsupported typing command")}},a.prototype.Co=function(){var s=this;this.Xu.Po();return this.Xu.add(function(t){return Promise.resolve((()=>{for(var t=[],n=0,i=s.get();n<i.length;n++){var e=i[n];t.push({action:"STOP",user:e})}return s.qa={},t})())})},a.prototype.snapshot=function(){for(var t=[],n=0,i=this.get();n<i.length;n++){var e=i[n];t.push({action:"START",user:e})}return t},a.prototype.Po=function(){this.Xu.Po()},i.default=a},{2:2,34:34,37:37,40:40}],29:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var s=t(34),r=t(2);function o(){}o.Ba=function(t){var i={},t=t.getAllResponseHeaders();return t&&t.trim().split(/[\r\n]+/).forEach(function(t){var t=t.split(": "),n=t.shift(),t=t.join(": ");i[n]=t}),i},o.mn=function(e){return new Promise(function(t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(200===i.status||304===i.status?t({responseText:i.responseText,hn:o.Ba(i)}):n(o.Ya(i.status,i.statusText)))},i.ontimeout=function(){n(o.Ya(408,"client timeout"))},i.open("GET",e,!0),i.timeout=6e4,i.send(),s.default(r.lt,"GET: "+e)})},o.Ya=function(t,n){return{statusCode:t,statusText:n}},i.default=o},{2:2,34:34}],30:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(34),s=t(2),r=t(1),o=t(18),u=t(3),a=t(40);function c(t,n){var i=this;this.za=void 0,this.Ka=!1,this.Xa=!0,this.$a=function(t){"DISCONNECTED"!==t||i.Oe.Se()||i.Cu()||2===o.default.state.Ms||i.Qa(void 0!==i.za)},this.Za=t,this.Oe=n,this.Za.subscribe(u.Qt.PageHiding,this.reduce.bind(this)),this.Za.subscribe(u.Qt.PageShowing,this.reset.bind(this)),this.Za.subscribe(u.Qt.ConnectionStatus,function(t){i.Xa="DISCONNECTED"===t})}c.prototype.init=function(t,n){this.tc=t,this.nc=n},c.prototype.Cu=function(){return this.Ka},c.prototype.Du=function(){this.Cu()&&(this.Ka=!1,this.ic())},c.prototype.ic=function(){var n=this;e.default(s.lt,"startListening"),this.Za.subscribe(u.Qt.ConnectionStatus,this.$a),this.za=window.setTimeout(function(t){n.Qa(void 0!==n.za)},r.default.B)},c.prototype.ec=function(){e.default(s.lt,"stopListening"),clearTimeout(this.za),this.za=void 0,this.Za.unsubscribe(u.Qt.ConnectionStatus,this.$a)},c.prototype.Qa=function(t){e.default(s.lt,"fire",t),this.Ka=!0,a.De(this.tc)&&this.tc(),t&&this.ec()},c.prototype.reduce=function(){this.Ka=!1,this.Xa?this.$a("DISCONNECTED"):this.ic()},c.prototype.reset=function(){this.Cu()?(this.Ka=!1,a.De(this.nc)&&this.nc()):this.ec()},i.default=c},{1:1,18:18,2:2,3:3,34:34,40:40}],31:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var h=t(40),l=t(2),f=t(1),e=t(38),a=t(13),c=t(33),s=t(42),r=t(43),d=t(34),v=t(2);function o(){}o.Si=function(){return o.Oi=o.Oi?o.Oi:new o},o.prototype.init=function(){var n=this;return this.rc().then(function(t){return n.context=t}).catch(function(t){throw new s.default(r.on.TECHNICAL_PROBLEM,"Invalid location")})},o.prototype.update=function(t,n){d.default(v.lt,"Update context",t=void 0===t?null:t,n=void 0===n?null:n);var i=this.oc();return this.context&&i===this.context.uc?(t&&(this.context.un=t,this.context.Hr=this.context.un+this.context.Ae,this.context.Jr=this.context.un+"/"),n&&(this.context.Re=n,this.context.Gr=n+"/")):this.context=this.ac(i,t,n),this.context},o.prototype.Wa=function(t){return this.context.un+this.context.Ae===t},o.prototype.rc=function(){var e=this,s=this.oc();return new Promise(function(n,i){s?void 0===f.default.I.file_name?e.hc(s).then(function(t){return e.ac(s)}).then(function(t){/\.googleusercontent\.com$/.test(t.un)?(d.default(v.ut,"Now4real is not compatible with the site: "+t.un),i("Invalid site")):n(t)}).catch(function(t){i(t)}):n(e.ac(s)):i("Invalid referrer")})},o.prototype.ac=function(t,n,i){d.default(v.lt,"Creating context",t,n=void 0===n?null:n,i=void 0===i?null:i);var e=this.lc(t),n=n||this.Ro(t),i=i||null,s=void 0===f.default.I.file_name?this.fc(t,!1):null,r=this.Uo(),o=!!s&&s.endsWith(l.default.Ht);return{uc:t,un:n,Ae:e,Re:i,Hr:n+e,Jr:n+"/",Gr:i?i+"/":null,Hi:s,an:r,cn:o}},o.prototype.oc=function(){var t=document.customReferrer,t=t||f.default.I.location;return t},o.prototype.dc=function(t,n){var i,e;return(t=(n=void 0===n?!0:n)&&(t&&(n=h.Je(t))&&(n.hostname.endsWith(l.default.Ht)?(e=t.match(/[^-]*-[^-]*-(.+)\.translate\.goog(.*)/))&&(t=n.protocol+"//"+e[1].replace(/-/g,".")+(e[2]||"/")):new RegExp("^"+l.default.Ct+"$|^127(?:.[0-9]{1,3}){3}$").test(n.hostname)&&(e=n.pathname,i=n.search,n=n.hash,/file:\/\//i.test(e)&&(e="/"+e.split("/").pop()),t=l.default.Tt+"://"+f.default.G+e+i+n)),void 0!==(e=f.default.I.file_name))?l.default.Tt+"://"+f.default.G+"/"+e:t)?(d.default(v.lt,"Computed referrer: "+t),t):(d.default(v.ut,"Empty referrer"),null)},o.prototype.lc=function(t){var n,i,e,s,r,o,u,a,t=this.dc(t),c=f.default.N.page_context;return null!=c?(a=void 0,a=h.Ao(c)?c.startsWith(l.default.jt)?c:l.default.jt+c:(i=n="",e=c.query,c=c.fragment,s=h.Je(t),e&&s.search&&(r=new URLSearchParams(s.search),h.Ko(e)?(r.sort(),n=r.toString()):h.isArray(e)?(o=new URLSearchParams,e.forEach(function(n){var t=r.getAll(n);t.length&&t.forEach(function(t){o.append(n,t)})}),o.sort(),n=o.toString()):h.vc(e)&&(u=new URLSearchParams,r.forEach(function(t,n){e.test(n)&&u.append(n,t)}),u.sort(),n=u.toString()),n=n&&"?"+(n=n.replace(/=$|=(?=&)/g,""))),c&&s.hash&&(i=s.hash),s.pathname+n+i),d.default(v.lt,"Custom Page Context: "+a),a):(c=h.Je(t).pathname,d.default(v.lt,"Retrieved Page Context: "+c),this.wc(c))},o.prototype.Ro=function(t){t=this.dc(t),t=h.Je(t).host;return d.default(v.lt,"Retrieved Site Context: "+t),t.toLowerCase()},o.prototype.fc=function(t,n){t=h.Je(this.dc(t,n)),n=t.origin;return d.default(v.lt,"Retrieved parent origin: "+n,t),n},o.prototype.hc=function(t){var r=h.Je(t).origin,o=h.Gi(16),u=window.parent;return e.timeout(f.default.K,new Promise(function(i,e){function s(t){var n=t.data;t.source===u&&t.origin===r&&"verify"===n.cmd&&(d.default(v.lt,"Origin verification event",t),n.payload.id===o?(c.default.removeEventListener(window,"message",s),i(r)):e("Invalid verification"))}c.default.addEventListener(window,"message",s),u.postMessage(new a.$i({id:o}),r),d.default(v.lt,"Started origin verification",t,r,o)}))},o.prototype.Uo=function(){var t=window.n4rConfig,n=-1<window.location.host.indexOf("localhost"),i="file:"===window.location.protocol,e=-1<window.location.host.indexOf("cdn");return i||t&&n?"http://localhost:3000":e||!t&&n?window.location.origin:"https://cdn.now4real.com"},o.prototype.wc=function(t){return h.Ao(t)?/\/([Hh]ome|[Ii]ndex|[Dd]efault)(\.\w+)?/.test(t)?t.substring(0,t.length-t.split("/").pop().length):t:null},i.default=o},{1:1,13:13,2:2,33:33,34:34,38:38,40:40,42:42,43:43}],32:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.decode=i.mc=void 0;var e=t(40);function s(t){return t.replace(/-/g,"+").replace(/_/g,"/")}function r(t){return decodeURIComponent(atob(t).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))}i.mc=function(t){return!!t&&e.Ao(t)&&/^[^\.\s]+\.[^\.\s]+\.[^\.\s]*$/.test(t)},i.decode=function(t){return(t=t.split("."))?{bc:JSON.parse(r(s(t[0]))),payload:JSON.parse(r(s(t[1]))),signature:t[2]||null}:null}},{40:40}],33:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var o=t(1),u=t(21),e=t(40),s=t(10),a=t(7),c=t(34),h=t(2),t=(r.prototype.init=function(t,n,i){this.Ec=n,this.an=i,c.default(h.lt,"Origins: our -> "+i+", integrator -> "+n),this.Sc=t,this.Oc()},r.prototype.reset=function(){c.default(h.lt,"Listeners resetted"),this.removeEventListener(window,"message",this.Pc)},r.prototype.Oc=function(){if(!s.test(1))throw new Error("Message API not supported!");this.addEventListener(window,"message",this.Pc)},r.prototype.addEventListener=function(t,n,i){document.addEventListener&&t.addEventListener(n,i,!1)},r.prototype.removeEventListener=function(t,n,i){document.removeEventListener&&t.removeEventListener(n,i,!1)},r.prototype.Tc=function(t,n){return(n=void 0===n?!1:n)?void 0!==o.default.I.file_name||t===this.Ec:t===this.an},r.prototype.Cc=function(t){return e.jn(t)&&"cmd"in t&&"payload"in t&&"PROXY"===t.iss},r.prototype.Dc=function(t){return e.jn(t)&&"cmd"in t&&"getStoredEmail"===t.cmd},r);function r(){var r=this;this.Pc=function(t){var n,i,e=t.data,s=t.origin||t.originalEvent.origin;r.Tc(s,!0)&&r.Cc(e)?(c.default(h.lt,"Proxy message received"),r.Sc.Vs(e.id,e.cmd,e.payload)):r.Tc(s)&&r.Dc(e)&&(e=e.siteKey,i=void c.default(h.lt,"Get email message received",e),e&&(null==(n=a.default.os)?void 0:n.Ju())==="n4rAuth@"+e?i=a.default.os.getItem(o.default.it):e||(i=u.default.getUser()),i)&&i.email&&t.source.postMessage({email:i.email},s)}}i.default=new t},{1:1,10:10,2:2,21:21,34:34,40:40,7:7}],34:[function(t,n,i){var r=this&&this.__spreadArrays||function(){for(var t=0,n=0,i=arguments.length;n<i;n++)t+=arguments[n].length;for(var e=Array(t),s=0,n=0;n<i;n++)for(var r=arguments[n],o=0,u=r.length;o<u;o++,s++)e[s]=r[o];return e},o=(Object.defineProperty(i,"t",{value:!0}),t(1)),u=t(3);function a(t,n){return n.length>=t?n:n+new Array(t-n.length+1).join(" ")}var c="[NOW4REAL-"+a(o.default.C,o.default.S)+"]";i.default=function(t,n){for(var i=[],e=2;e<arguments.length;e++)i[e-2]=arguments[e];var s=o.default.O;window.console&&s!==u.P.Off&&s<=t&&(s=t!==u.P.Error&&t!==u.P.Warn||void 0===console.error?"log":"error",t=a(o.default.T,u.P[t]),t=c+" "+t+" | "+n,0!==i.length?console[s].apply(console,r([t],i)):console[s](t))}},{1:1,3:3}],35:[function(e,t,u){!function(i){!function(){Object.defineProperty(u,"t",{value:!0});var f=e(42),d=e(43),v=e(3),w=e(40),s=e(32),a=e(2),m=e(7),S=e(1),p=e(21),r=e(22),g=e(13),b=e(38),n=e(10),E=e(4),o=e(33),c="undefined"!=typeof window?window.LS:void 0!==i?i.LS:null,O=e(34),P=e(2),T=/^CONNECTED:(?!STREAM-SENSING)/;function t(){this.Nc=!1,this._c=!1,this.yc=!1,this.Mc=null}t.Si=function(){return t.Oi=t.Oi?t.Oi:new t},t.prototype.init=function(t,n,i,e,s,r,o){var u=this,t=(this.version=t,this.Le=n,this.Ic=i,this.je=s,this.ds=r,this.Ue=o,this.Ac=w.Rc(S.default.I.env_subdom),p.default.ju()||this.Ac),n=w.Je(this.Ac).protocol,i=(this.Uc=n,O.default(P.lt,"felsEndpoint",t,n),new c.LightstreamerClient(t,S.default.L)),s=i.connectionOptions,r=(s.setReverseHeartbeatInterval(3e4),s.setSessionRecoveryTimeout(2e3),s.setRetryDelay(4e3),s.setCookieHandlingRequired(!0),e&&(O.default(P.lt,"DEMO"),i.connectionDetails.setAdapterSet("DEMO")),{onStatusChange:function(t){var n=t.startsWith(a.default.Dt+":")||t===a.default._t&&"CONNECTED"===u.xc,n=(O.default(P.ht,t),n?"CONNECTED":"DISCONNECTED");u.xc!==n&&(u.kc&&w.De(u.kc.Xs)&&u.kc.Xs(n),u.xc=n),T.test(t)?u.Lc():t===a.default.Nt&&u.jc()},onPropertyChange:function(t){var n;"sessionId"===t?(n=u.sr.getSessionId(),!m.default.sid&&n&&(u.sr.setUser(u.Fc()),m.default.sid=w.Gc(n)),O.default(P.ht,t+": "+n)):-1<["user","password"].indexOf(t)&&O.default(P.lt,"Changed "+t+" property")},onServerError:function(t,n){var i,e;if(u.Nc&&(O.default(P.ut,"onServerError event",t,n),u.kc))switch(t){case v.nn.UnsupportedClient:null!=(i=u.kc)&&i.nr();break;case v.nn.AuthenticationExpired:u._c||(u.mode===v.Zt.JWT?m.default.gn?b.timeout(S.default.X,m.default.bn.send(new g.zi)).then(function(t){O.default(P.lt,"obtained new JWT 2",t),u.Jc(t)}).catch(function(t){O.default(P.ut,t.message),null!=(t=u.kc)&&t.$s()}):null!=(i=u.kc)&&i.$s():u.mode!==v.Zt.SOCIAL&&u.mode!==v.Zt.EMAIL||null!=(i=u.kc)&&i.ir());break;case v.tn.WrongCredentials:case v.nn.Unauthorized:u.Hc(w.Vc(t,n).reason);break;case v.nn.TemporarilyUnavailable:u._c||(e=(i=w.Vc(t,n)).redirect,i.siteConf?u.Hc(a.default.Kt):u.jc(e));break;case v.tn.AllowedSessionCountReached:case v.tn.SessionCountLimitReached:case v.tn.ServerTooBusy:case v.tn.ServerBlocked:u._c||u.jc()}}});return i.addListener(r),this.Ss=i,this.sr=i.connectionDetails,i},t.prototype.Ks=function(t){this.kc=t},t.prototype.vs=function(){this.yc=!0,this.Lc()},t.prototype.qe=function(t){t&&(this.perms=t,this.sr)&&this.sr.getUser()&&this.sr.setUser(this.Fc())},t.prototype._s=function(){var e,s=this;return new Promise(function(n,i){s.Wc().then(function(n){var t=S.default.I.no_initial_config,i=s.Le.get().conf;if(t&&i){if(s.qc(i))throw new f.default(d.on.RELOAD_REQUIRED,JSON.stringify(s.Le.pn()));if(s.Bc(i))return s.Yc(i).then(function(t){var n;O.default(P.lt,"fixing config",t),null!=(n=s.kc)&&n.er(t)}).then(function(t){return n})}return n}).then(function(t){var n=t.zc,t=t.Kc,i=(e=n,s.Le.get().auth),i=!s.je&&(n===v.Zt.JWT&&1!==i||n!==v.Zt.JWT&&1===i);return O.default(P.lt,"First connection",n,t,i),s.connect(n,t,i)}).then(function(t){s.Nc=!0,s.Xc=s.Le.get().auth,n(t)}).catch(function(t){e!==v.Zt.READ_ONLY&&e!==v.Zt.N4R&&s.$c(t)?s.hs().then(function(t){s.Nc=!0,s.Xc=s.Le.get().auth,n(s.mode)}).catch(function(t){i(t)}):s.Qc(t)?i(new f.default(d.on.ACCESS_DENIED,t.message)):i(t)})})},t.prototype.Wc=function(){var e=this;return new Promise(function(n,i){e.ds&&m.default.gn?b.timeout(S.default.X,m.default.bn.send(new g.zi)).then(function(t){O.default(P.lt,"obtained first JWT",t),e.Mc=m.default.Zc=t,n(e.th(t))}).catch(function(t){O.default(P.ut,t.message),i(new f.default(d.on.ACCESS_DENIED,t.message))}):n(e.th())})},t.prototype.cs=function(e,s){var r=this;return new Promise(function(n,i){O.default(P.lt,"Switching to authenticated",e,s),r.qe([]),r.disconnect().then(function(t){r.connect(e,s).then(function(t){n(s)}).catch(function(n){r.$c(n)?r.connect(v.Zt.READ_ONLY).then(function(t){i(n)}).catch(function(t){i(t),r.Qc(t)&&r.Hc(a.default.Kt)}):(i(n),r.Qc(n)&&r.Hc(a.default.Kt))})})})},t.prototype.hs=function(){var e=this;return new Promise(function(n,i){O.default(P.lt,"Switching to unauthenticated"),e.qe([]),e.disconnect().then(function(t){e.connect(v.Zt.READ_ONLY).then(function(t){n()}).catch(function(t){i(t),e.Qc(t)&&e.Hc(a.default.Kt)})})})},t.prototype.rr=function(){this.Ss.disconnect()},t.prototype.cr=function(){var t;n.Ri()&&(t=p.default.ju(),this.sr.setServerAddress(t||this.Ac)),this.Ss.connect()},t.prototype.th=function(t){var n,i=this.Le.get(),e=i.auth,i=i.siteKey,s=3===e;return s=this.je?(n=v.Zt.N4R,S.default.I.n4r_jwt||null):this.ds?(n=v.Zt.JWT,t||S.default.N.custom_auth.jwt):2===e?(t=(m.default.os=new r.default(a.default.Gt+"@"+i)).getItem(S.default.tt),n=v.Zt.NO_REGISTRATION,t?t.token:null):s?(e=(m.default.os=new r.default(a.default.Gt+"@"+i)).getItem(S.default.it),n=v.Zt.EMAIL,e||null):(n=(t=p.default.getUser())&&!this.Ue?v.Zt.SOCIAL:v.Zt.READ_ONLY,t&&!this.Ue?t:null),{zc:n,Kc:s}},t.prototype.$c=function(t){return t.code===d.on.ACCESS_DENIED},t.prototype.Qc=function(t){return t.code===d.on.MISMATCH},t.prototype.nh=function(t,n,i){void 0===i&&(i=!1);t=t||"",n=n||{};return Object.keys(n).length||(n.site=this.Ic,n["x-conf"]=S.default.N),i||(n.sitev=this.Le.get().version),m.default.sid&&(n.sid=m.default.sid),this.perms&&(n.perms=this.perms),[this.version,t,JSON.stringify(n,function(t,n){return!0===n?1:!1===n?0:null!==n?n:void 0})].join(a.default.Lt)},t.prototype.eh=function(t,n,i){var e;if(void 0===i&&(i=!1),t===v.Zt.JWT||t===v.Zt.N4R){var s=null,r=null;if(n){var o=w.sh(n,".");if(!o||5!==o.length)throw new f.default(d.on.ACCESS_DENIED,"Invalid JWT");r=o.pop(),s=o.join("")}o=this.nh(s,null,i),s=r}else s=t===v.Zt.NO_REGISTRATION?(o=this.nh(n,null,i),null):t===v.Zt.EMAIL?(o=this.nh((e=n)?e.id:null,null,i),e?e.secret:null):t===v.Zt.SOCIAL?(o=this.nh((e=n).id,null,i),e.secret):(o=this.nh(null,null,i),null);return[o,s]},t.prototype.Fc=function(){var t=this.sr.getUser().split(a.default.Lt),n=t[1],t=JSON.parse(t[2]);return this.nh(n,t)},t.prototype.Br=function(t){if(!this.Mc||!s.mc(t))throw new Error("Invalid JWT or missing initial");var n=this.Mc,n=s.decode(n).payload,i=s.decode(t).payload,e=n.sub;if(e!==i.sub)throw new Error("'sub' claim changed. It should have been equal to: "+e);e=n.iss;if(e!==i.iss)throw new Error("'iss' claim changed. It should have been equal to: "+e);n=this.sr.getUser().split(a.default.Lt),i=JSON.parse(n[2]),e=w.sh(t,"."),n=e.pop(),e=e.join("");this.sr.setUser(this.nh(e,i)),this.sr.setPassword(n),m.default.Zc=t},t.prototype.Jc=function(t){this.Br(t),null!=(t=m.default.En)&&t.Cu()||this.Ss.connect()},t.prototype.Lc=function(){var t;this.yc&&(t=this.sr.getServerInstanceAddress(),O.default(P.lt,"handleFelsSaving",t),t)&&t!==this.Ac&&(O.default(P.lt,"control link detected",t),S.default.J&&p.default.Lu(t),this.sr.setServerAddress(t))},t.prototype.jc=function(t){var n=this.sr.getServerAddress(),i=this.Ss.getStatus(),e=m.default.En.Cu(),i=(O.default(P.lt,"handleFelsSwitch",t,n,i,e,this.Ac),i===a.default.DISCONNECTED);if(t||n!==this.Ac){O.default(P.lt,"switching"),p.default.Fu(),this.Ss.disconnect();try{this.sr.setServerAddress(t?this.Uc+"//"+t+"/":this.Ac)}catch(t){O.default(P.ut,t.message),this.sr.setServerAddress(this.Ac)}i=!0}i&&!e&&(O.default(P.lt,"reconnecting"),this.Ss.connect())},t.prototype.rh=function(t){O.default(P.lt,"handleConfUpdate",t),this.Le.update(JSON.stringify(t));var t=this.th(m.default.Zc),n=t.zc,t=this.eh(n,t.Kc),i=t[0],t=t[1];return this.sr.setUser(i),this.sr.setPassword(t),this.Ss.connect(),n},t.prototype.connect=function(c,r,o){var u,h=this,l=(void 0===o&&(o=!1),this._c=!0,c);return new Promise(function(n,i){function a(t){h._c=!1,h.Ss.removeListener(u),i(t)}u={onStatusChange:function(t){T.test(t)&&(h.mode=l,t=l,h._c=!1,h.Ss.removeListener(u),n(t))},onServerError:function(t,n){O.default(P.ut,n,t);var i=w.Vc(t,n);switch(t){case v.tn.WrongCredentials:l===v.Zt.SOCIAL?p.default.Do():l===v.Zt.EMAIL&&(null!=(u=m.default.os)&&u.removeItem(S.default.it),null!=u)&&u.removeItem(S.default.et),a(new f.default(d.on.ACCESS_DENIED,i));break;case v.nn.Unauthorized:a(new f.default(d.on.ACCESS_DENIED,i));break;case v.nn.AuthenticationExpired:c===v.Zt.JWT&&m.default.gn?b.timeout(S.default.X,m.default.bn.send(new g.zi)).then(function(t){O.default(P.lt,"obtained new JWT 1",t),h.Jc(t)}).catch(function(t){O.default(P.ut,t.message),a(new f.default(d.on.ACCESS_DENIED,i))}):a(new f.default(d.on.ACCESS_DENIED,i));break;case v.nn.UnsupportedClient:a(new f.default(d.on.TECHNICAL_PROBLEM,"Unsupported client"));break;case v.nn.UnsupportedBrowser:a(new f.default(d.on.TECHNICAL_PROBLEM,"Unsupported browser"));break;case v.nn.TemporarilyUnavailable:var e,s,r,o=i.siteConf,u=i.redirect;o?(e=o.s,s=o.a,r=o.c||{},e?!s&&(!h.Nc&&c===v.Zt.JWT||h.Nc&&s!==h.Xc&&c!==v.Zt.N4R)?a(new f.default(d.on.MISMATCH,"This site requires social authentication")):1===s&&c!==v.Zt.JWT&&c!==v.Zt.N4R?a(new f.default(d.on.MISMATCH,"This site requires JWT authentication")):2===s&&(!h.Nc&&c===v.Zt.JWT||h.Nc&&s!==h.Xc&&c!==v.Zt.N4R)?a(new f.default(d.on.MISMATCH,"This site requires No Registration login")):3===s&&(!h.Nc&&c===v.Zt.JWT||h.Nc&&s!==h.Xc&&c!==v.Zt.N4R)?a(new f.default(d.on.MISMATCH,"This site requires Email login")):!h.Nc&&h.qc(r)?a(new f.default(d.on.RELOAD_REQUIRED,JSON.stringify(o))):!h.Nc&&h.Bc(r)?h.Yc(r).then(function(t){var n;O.default(P.lt,"obtained new config",t),null!=(n=h.kc)&&n.er(t),l=h.rh(o)}).catch(function(t){O.default(P.lt,t),a(new f.default(d.on.TECHNICAL_PROBLEM,"unable to refresh config"))}):l=h.rh(o):a(E.rn)):h.jc(u);break;case v.tn.AllowedSessionCountReached:case v.tn.SessionCountLimitReached:case v.tn.ServerTooBusy:case v.tn.ServerBlocked:h.jc();break;default:a(new f.default(d.on.TECHNICAL_PROBLEM,i))}}},h.Ss.addListener(u);try{var t=h.eh(c,r,o),e=t[0],s=t[1];h.sr.setUser(e),h.sr.setPassword(s),O.default(P.lt,c+" attempt",r,e,s),o=!1,h.Ss.connect()}catch(t){a(t)}})},t.prototype.disconnect=function(){var e=this;return new Promise(function(n){var i;e.Ss.getStatus()===a.default.DISCONNECTED?n():(i={onStatusChange:function(t){t===a.default.DISCONNECTED&&(e.Ss.removeListener(i),n())}},e.Ss.addListener(i),e.Ss.disconnect())})},t.prototype.Hc=function(t){var n;switch(t){case a.default.Kt:null!=(n=this.kc)&&n.Zs();break;case a.default.Xt:null!=(n=this.kc)&&n.tr();break;default:this.mode===v.Zt.JWT&&null!=(n=this.kc)&&n.$s()}},t.prototype.qc=function(t){var n,i,e,s,r,o,u,a,c,h,l,f,d,v,w,m,p,g,b,E;try{return O.default(P.lt,"requiresReload",t),this.je||top===self?!1:(u=S.default.A,a=S.default.N,c=u.target,h=a.target,l=null!=(n=t.target)?n:"widget",f=u.page_context,d=a.page_context,v=null!=(i=t.page_context)?i:null,w=u.param_overriding,m=a.param_overriding,p=null!=(e=t.param_overriding)&&e,g=null==(s=u.widget)?void 0:s.container,b=a.widget.container,E=null!=(o=null==(r=t.widget)?void 0:r.container)?o:null,void 0===c&&l!==h||void 0===f&&v!==d||void 0===w&&p!==m||void 0===g&&E!==b)}catch(t){return O.default(P.ut,"requiresReload error",t),!1}},t.prototype.Bc=function(t){try{return O.default(P.lt,"requiresConfigUpdate",t),!this.je&&top!==self}catch(t){return O.default(P.ut,"requiresConfigUpdate error",t),!1}},t.prototype.Yc=function(t){var r=window.parent;return b.timeout(S.default.K,new Promise(function(i,e){function s(t){var n=t.data;if(t.source===r&&"updateConfig"===n.cmd){O.default(P.lt,"Config update event",t),o.default.removeEventListener(window,"message",s);try{i(n.ih)}catch(t){e("Invalid config update")}}}o.default.addEventListener(window,"message",s),m.default.bn.send(new g.Yi(t))}))},u.default=t}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,13:13,2:2,21:21,22:22,3:3,32:32,33:33,34:34,38:38,4:4,40:40,42:42,43:43,7:7}],36:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var o=t(3),e=t(40),u=t(38),a=t(2),c=t(1),h=t(42),l=t(43),f=t(34),d=t(2);function s(){}s.Si=function(){return s.Oi=s.Oi?s.Oi:new s},s.prototype.init=function(t,n){this.Ss=t,this.getContext=n},s.prototype.Eo=function(t,n,i,e){t={beforeMessageId:t,maxMessageCount:n=void 0===n?10:n};return e&&(t.updatedAfter=e),i&&(t.skipUserIds=i),this.oh(o.en.MESSAGE_GET,t)},s.prototype.lu=function(t,n){return this.oh(o.en.MESSAGE_EDIT,{id:t,payload:n})},s.prototype.Xe=function(){return this.oh(o.en.GET_AUTH_INFO,{})},s.prototype.Ho=function(t){return this.oh(o.en.DELETE_PASSWORD,{password:t})},s.prototype.Bo=function(t,n){t={payload:t},n=n&&n.replyTo;return n&&(t.reply=n),this.oh(o.en.MESSAGE_SEND,t)},s.prototype.Yo=function(t){return this.oh(o.en.MESSAGE_DELETE,{id:t})},s.prototype.zo=function(){return this.oh(o.en.CHAT_FLUSH,{})},s.prototype.Xo=function(t){return this.oh(o.en.CHAT_ENABLE,{enable:t})},s.prototype.$o=function(t){return this.oh(o.en.MUTE_USER_GET,{userId:t})},s.prototype.Zo=function(t,n){return this.oh(o.en.MUTE_USER_SET,{userId:t,duration:n})},s.prototype.tu=function(t,n,i){t={id:t,reason:n};return i&&(t.comment=i),this.oh(o.en.REPORT_CHAT_MESSAGE,t)},s.prototype.Ku=function(t){return this.oh(o.en.USER_PREFERENCE_SET,{value:t})},s.prototype.uh=function(t){return this.oh(o.en.LOG,{msg:t})},s.prototype.nu=function(){return this.oh(o.en.USER_CONSENT_SET,{})},s.prototype.Yr=function(t){return this.oh(o.en.JWT_REFRESH,{jwt:t},{ah:!0})},s.prototype.eu=function(t,n,i){return this.oh(o.en.POLL_NEW,{question:t,options:n,maxVotes:i})},s.prototype.su=function(t){return this.oh(o.en.POLL_CLOSE,{remove:t})},s.prototype.ou=function(){return this.oh(o.en.POLL_VOTE_GET,{})},s.prototype.ru=function(t){return this.oh(o.en.POLL_VOTE_SET,{vote:t})},s.prototype.oh=function(t,n,i){var e=this.getContext(),e=c.default.N.scope===a.default.kt&&-1<[o.en.MESSAGE_SEND,o.en.MESSAGE_DELETE,o.en.MESSAGE_EDIT,o.en.CHAT_FLUSH,o.en.CHAT_ENABLE,o.en.MUTE_USER_GET,o.en.MUTE_USER_SET,o.en.REPORT_CHAT_MESSAGE,o.en.USER_CONSENT_SET,o.en.POLL_NEW,o.en.POLL_CLOSE,o.en.POLL_VOTE_GET,o.en.POLL_VOTE_SET,o.en.MESSAGE_GET].indexOf(t)?a.default.qt+"/":""+a.default.Bt+e.Ae,s=this.hh(e,o.en[t],n),r=(f.default(d.lt,"RPC ("+o.en[t]+")",s,i),(null!=i&&i.ah?this.lh:this.fh).bind(this));return null!=i&&i.retryOnAbort?u.retry(function(){return r(s)},{dn:"message",vn:["onAbort"],wn:5,delay:500}):r(s)},s.prototype.hh=function(t,n,i){return t+a.default.Lt+n+a.default.Lt+JSON.stringify(i)},s.prototype.fh=function(t){var s=this;return new Promise(function(i,e){s.Ss.sendMessage(t,"s",null,{onDeny:function(t,n,i){f.default(d.lt,"onDeny listener call",t,n,i),s.dh(n,i,e)},onProcessed:function(t,n){f.default(d.lt,"onProcessed listener call",t,n),s.wh(t,n,i,e)},onDiscarded:function(t){f.default(d.ct,"onDiscarded listener call",t),e(new h.default(l.on.TECHNICAL_PROBLEM,"onDiscarded"))},onError:function(t){f.default(d.ut,"onError listener call",t),e(new h.default(l.on.TECHNICAL_PROBLEM,"onError"))},onAbort:function(t,n){f.default(d.lt,"onAbort listener call",t,n),e(new h.default(l.on.TECHNICAL_PROBLEM,"onAbort"))}},!0)})},s.prototype.lh=function(i){var e=this;return new Promise(function(t,n){try{e.Ss.sendMessage(i,"UNORDERED_MESSAGES",null,null,!1),t()}catch(t){n(new h.default(l.on.TECHNICAL_PROBLEM,t.message))}})},s.prototype.dh=function(t,n,i){try{switch(t){case o.nn.TemporarilyUnavailable:i(new h.default(l.on.SERVICE_UNAVAILABLE,"the service is temporarily unavailable"));break;case o.nn.Unauthorized:i(new h.default(l.on.NOT_AUTHORIZED,e.Vc(t,n)));break;case o.nn.IllegalArgument:i(new h.default(l.on.INVALID_ARGUMENTS,e.Vc(t,n)));break;default:i(new h.default(l.on.TECHNICAL_PROBLEM,t.toString()))}}catch(t){f.default(d.ut,t),i(new h.default(l.on.TECHNICAL_PROBLEM,"protocol mismatch"))}},s.prototype.wh=function(t,n,i,e){try{var s,r,o,u=n?JSON.parse(n):null;this.mh(t)||this.ph(t)?(s=u.publish,r=u.moderation,o=u.error,s?i(u):e(o||r)):(this.gh(t)||this.bh(t)||this.Eh(t))&&(o=u.error)?e(o):i(u)}catch(t){f.default(d.ut,t),e(new h.default(l.on.TECHNICAL_PROBLEM,"protocol mismatch"))}},s.prototype.Sh=function(t){return t.split(a.default.Lt)[1]},s.prototype.mh=function(t){return this.Sh(t)===o.en[o.en.MESSAGE_SEND]},s.prototype.gh=function(t){return this.Sh(t)===o.en[o.en.REPORT_CHAT_MESSAGE]},s.prototype.bh=function(t){return this.Sh(t)===o.en[o.en.USER_PREFERENCE_SET]},s.prototype.ph=function(t){return this.Sh(t)===o.en[o.en.MESSAGE_EDIT]},s.prototype.Eh=function(t){return[o.en[o.en.POLL_NEW],o.en[o.en.POLL_CLOSE],o.en[o.en.POLL_VOTE_GET],o.en[o.en.POLL_VOTE_SET]].includes(this.Sh(t))},i.default=s},{1:1,2:2,3:3,34:34,38:38,40:40,42:42,43:43}],37:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(39),s=t(34),r=t(2),a="ABORT_RUNNING";function o(t,n,i){void 0===t&&(t=!1),void 0===n&&(n=1),this.Oh=[],this.Ph=0,this.Th=n,(this.Ch=t)&&(this.Dh=new e.default(i)),this.name=i||"",this.Nh=function(){}}o.prototype.next=function(){this.Ph--,0<this.Oh.length?this.Oh.shift()():this.Nh()},o.prototype.add=function(o){var u=this;return new Promise(function(s,r){function t(){u.Ph++;var n,i,e=!1;u.Ch&&(n=Date.now(),i=function(t){n<t&&(e=!0,r(new Error("Task aborted")),u.Dh.unsubscribe(a,i),u.next())},u.Dh.subscribe(a,i)),o().then(function(t){e||(s(t),u.Ch&&u.Dh.unsubscribe(a,i),u.next())},function(t){e||(r(t),u.Ch&&u.Dh.unsubscribe(a,i),u.next())})}u.Ph<u.Th?t():u.Oh.push(t)})},o.prototype.Po=function(){this.Ch&&(s.default(r.lt,"abortRunning",this.Dh._h(a),this.name),this.Dh.publish(a,Date.now()))},o.prototype.ba=function(){return this.Ph},i.default=o},{2:2,34:34,39:39}],38:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.timeout=i.retry=i.pause=void 0;var h=t(34),l=t(2);function f(n){return new Promise(function(t){return setTimeout(t,n)})}i.pause=f,i.retry=function e(s,r){var o=r.dn||"code",u=r.vn||"*",a=r.wn||3,c=r.delay||1e3;return s().catch(function(t){var n,i=t[o];return 1<a&&i&&(-1<u.indexOf(i)||"*"===u)?(h.default(l.lt,"Retry "+s+", remaining attempts: "+(n=a-1)+", code: "+i),r.wn=n,f(c).then(function(){return e(s,r)})):Promise.reject(t)})},i.timeout=function(i,t){var e,n=new Promise(function(t,n){e=setTimeout(function(){n(new Error("Timeout after "+i+" ms"))},i)});return Promise.race([t,n]).then(function(t){return clearTimeout(e),t})}},{2:2,34:34}],39:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e={}.hasOwnProperty,r=t(34),o=t(2);function s(t){this.yh={},this.name=t||""}s.prototype.subscribe=function(t,n){var i;r.default(o.lt,"PubSub subscribe",t,this.name,null==(i=this.yh[t])?void 0:i.length),e.call(this.yh,t)||(this.yh[t]=[]),this.yh[t].push(n)},s.prototype.unsubscribe=function(t,n){var i,e=null==(i=this.yh[t])?void 0:i.length;if(e){r.default(o.lt,"PubSub unsubscribe",t,this.name,e);for(var s=0;s<e;s++)if(this.yh[t][s]===n){this.yh[t].splice(s,1),1===e&&delete this.yh[t];break}}},s.prototype.Ta=function(t){delete this.yh[t]},s.prototype.publish=function(t,n){e.call(this.yh,t)&&this.yh[t].forEach(function(t){t(void 0!==n?n:{})})},s.prototype._h=function(t){return this.yh[t]?this.yh[t].length:null},i.default=s},{2:2,34:34}],40:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.Ia=i.qr=i.Fa=i.Wr=i.Vo=i.Xr=i.so=i.eo=i.io=i.sh=i.getTime=i.Gi=i.Vc=i.Vr=i.Io=i.An=i.vc=i.Ao=i.Qo=i.isArray=i.Ko=i.De=i.jn=i.Mo=i.$r=i.mr=i.Gc=i.qo=i.bu=i.Rc=i.Us=i.ks=i.xs=i.As=i.Je=i.Mh=i.Ih=void 0;var s=t(34),r=t(2),o=t(1),u=t(2);function a(t,n){return n?n===u.default.Pt&&t.endsWith(":80")||"https"===n&&t.endsWith(":443"):(s.default(r.ut,"Undefined protocol"),!1)}function c(t){return t.replace(/\:[0-9]{1,4}(.*)/,"$1")}function h(t){return("0"+t.toString(16)).substr(-2)}i.Ih=a,i.Mh=c,i.Je=function(t){var n,i,e,s,r,o,u;if(t)return(n=document.createElement("a")).href=t,t=n.port,e=n.hostname,s=n.pathname,r=n.search,o=n.hash,u=n.origin,a(i=n.host,(n=n.protocol).slice(0,-1))&&(i=c(i)),{protocol:n,host:i,hostname:e,port:t,pathname:s=s.startsWith("/")?s:"/"+s,origin:u=u||n+"//"+i,search:r,hash:o};throw new Error("Empty URL")},i.As=function(){return decodeURIComponent(location.hash.substring(1))},i.xs=function(t){var n=["cdn.",""!==t?t+".":t,"now4real.com"].join("");return s.default(r.lt,"Computed cdn hostname for "+t+" env: "+n),u.default.Tt+"://"+n},i.ks=function(t){return this.xs(t)+"/user-app/"},i.Us=function(t){var n=["api.",""!==t?t+".":t,"now4real.com"].join("");return s.default(r.lt,"Computed api gateway hostname for "+t+" env: "+n),u.default.Tt+"://"+n+":443"},i.Rc=function(t){if(void 0===t)throw new Error("env err: "+t);"staging"===t||""===t?(e=o.default.R,i=["fels.",""!==t?t+".":t,"now4real.com"].join(""),n=o.default.U):"devops"===t?(e="http",i="fels.localtest.me",n="4000"):"ci-devops"===t&&(e=u.default.Pt,i="n4r-fels.now4real-client-integration-test.svc.cluster.local",n="80");var n,i,e=e+"://"+i+":"+n+"/";return s.default(r.lt,"Computed fels for "+t+" env: "+e),e},i.bu=function(t){return null==t||void 0===t.closed},i.qo=function(t){return t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},i.Gc=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},i.mr=function(t){Promise.resolve().then(function(){t()})},i.$r=function(t,n,i){return t={id:t.id,name:t.nick,pic:t.icon,provider:t.provider},n&&(t.role=n),i&&(t.badge=i),t},i.Mo=function(t,n,i,e,s){return(t=this.$r(t,i,e)).consentGiven=n,s&&(t.preferences=s),t},i.jn=function(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)},i.De=function(t){return"function"==typeof t},i.Ko=function(t){return"boolean"==typeof t},i.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.Qo=function(t){return"number"==typeof t||"object"==typeof t&&t.constructor===Number},i.Ao=function(t){return"string"==typeof t},i.vc=function(t){return t instanceof RegExp},i.An=function(t){return JSON.parse(JSON.stringify(t))},i.Io=function(t,n){return JSON.stringify(t)===JSON.stringify(n)},i.Vr=function(t,n){return t.bind(n)},i.Vc=function(t,n){return 0<t?n:JSON.parse(n)},i.Gi=function(t){var n;if(void 0===t&&(t=8),window.crypto&&window.crypto.getRandomValues&&Uint8Array)return n=new Uint8Array((t||40)/2),window.crypto.getRandomValues(n),Array.prototype.slice.call(n).map(h).join("");for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",s=0;s<t;s++)e+=i.charAt(Math.floor(Math.random()*i.length));return e},i.getTime=function(){return(new Date).getTime()},i.sh=function(t,n){for(var i=t.split(n),e=i.length;1<e--;)i.splice(e,0,n);return i},i.io=function(t){if(null===t)return{value:null,unit:null};if(!t||!/^\d+(s|m|h|D|W|M|Y)$/.test(t))throw new Error("Invalid duration format");var n;switch((t=t.split("")).pop()){case"Y":n="YEARS";break;case"M":n="MONTHS";break;case"W":n="WEEKS";break;case"D":n="DAYS";break;case"h":n="HOURS";break;case"m":n="MINUTES";break;default:n="SECONDS"}return{value:Number(t.join("")),unit:n}},i.eo=function(t){if(null===t)return 1/0;if(t&&/^\d+(s|m|h|D|W|M|Y)$/.test(t))return parseInt(t.slice(0,-1),10)*{Y:31556952,M:2629746,W:604800,D:86400,h:3600,m:60,s:1}[t.slice(-1)];throw new Error("Invalid duration format")},i.so=function(t,n){return t*{SECONDS:1,MINUTES:60,HOURS:3600,DAYS:86400,WEEKS:604800,MONTHS:2629746,YEARS:31556952}[n]},i.Xr=function(t,n,i,e){var s=null;switch(t){case"M":s=u.default.Vt;break;case"G":s=u.default.Wt}return{role:s,badge:null!==n&&i&&e?{label:n,textColor:"#"+i,backgroundColor:"#"+e}:null}},i.Vo=function(t,n){var t=t.snapshot,i=null;return n?n===u.default.Vt?i=t.messageMaxLengthModerator:n===u.default.Wt&&(i=t.messageMaxLengthGuest):i=t.messageMaxLength,null!==i?i:o.default.H},i.Wr=function(t){return t=atob(t),Array.from(t).map(function(t){return t.charCodeAt(0)})},i.Fa=function(t,n){var i,t=null==t?void 0:t.match(/.{2}/g),e=null==n?void 0:n.split(""),s={};return t&&e&&(i=0,t.forEach(function(t,n){n=e[n].charCodeAt(0)-32;i+=s[t]=n=0===n?.5:n}),Object.keys(s).forEach(function(t){s[t]=s[t]/i})),s},i.qr=function(t){return t?parseInt(t,16):null},i.Ia=function(t){return t?t.toString(16):null}},{1:1,2:2,34:34}],41:[function(t,n,i){Object.defineProperty(i,"t",{value:!0});var e=t(10),s=t(1),r=t(34),o=t(2);function u(t){var n=this;if(this.Ah=null,this.Js=null,this.Hs=null,this.visible=null,this.Rh=null,this.Uh=null,this.xh=function(){n.visible=n.Se(),n.Uh||n.kh()},!e.test(2))throw new Error("Visibility API not supported!");t.Js&&(this.Js=t.Js),t.Hs&&(this.Hs=t.Hs),this.Ah=e.xi(),this.visible=this.Rh=this.Se(),document.addEventListener(this.Ah.visibilityChange,this.xh)}u.prototype.kh=function(){var n=this,t=this.Lh(this.visible);this.Uh=t?setTimeout(function(t){n.kh()},s.default.$):null},u.prototype.Lh=function(t){var n;return t!==this.Rh&&(r.default(o.lt,"notify",t,this.Rh,this.Uh),t?null!=(n=this.Hs)&&n.call(this):null!=(n=this.Js)&&n.call(this),this.Rh=t,!0)},u.prototype.reset=function(){document.removeEventListener(this.Ah.visibilityChange,this.xh)},u.prototype.Se=function(){return!document[this.Ah.hidden]},i.default=u},{1:1,10:10,2:2,34:34}],42:[function(t,n,i){function e(t,n){this.code=t,this.message=n}Object.defineProperty(i,"t",{value:!0}),e.prototype.toString=function(){return this.code+" - "+this.message},i.default=e},{}],43:[function(t,n,i){var e;Object.defineProperty(i,"t",{value:!0}),i.bi=i.on=void 0,(e=i.on||(i.on={})).ABORTED="ABORTED",e.ACCESS_DENIED="ACCESS_DENIED",e.ALREADY_PRESENT="ALREADY_PRESENT",e.ALREADY_REPORTED="ALREADY_REPORTED",e.ALREADY_STARTED="ALREADY_STARTED",e.BLOCKED="BLOCKED",e.CANNOT_MODERATE="CANNOT_MODERATE",e.CHAT_DISABLED="CHAT_DISABLED",e.CLOSED="CLOSED",e.CREDIT_EXHAUSTED="CREDIT_EXHAUSTED",e.CURRENTLY_DISABLED="CURRENTLY_DISABLED",e.DISCONNECTED="DISCONNECTED",e.INVALID_ARGUMENTS="INVALID_ARGUMENTS",e.INVALID_CALL="INVALID_CALL",e.MISMATCH="MISMATCH",e.NOT_AUTHENTICATED="NOT_AUTHENTICATED",e.NOT_AUTHORIZED="NOT_AUTHORIZED",e.NOT_FOUND="NOT_FOUND",e.QUOTA_EXCEEDED="QUOTA_EXCEEDED",e.RELOAD_REQUIRED="RELOAD_REQUIRED",e.SERVICE_UNAVAILABLE="SERVICE_UNAVAILABLE",e.TECHNICAL_PROBLEM="TECHNICAL_PROBLEM",e.TOO_FREQUENT="TOO_FREQUENT",e.USER_MUTED="USER_MUTED",e.CHATBOT="CHATBOT",(e=i.bi||(i.bi={})).AUTHORIZATION="AUTHORIZATION",e.CONNECTION_STATUS="CONNECTION_STATUS",e.COUNTER_CHAT_MESSAGES="COUNTER_CHAT_MESSAGES",e.COUNTER_CHAT_TYPING="COUNTER_CHAT_TYPING",e.COUNTER_PAGE_CHATTERS="COUNTER_PAGE_CHATTERS",e.COUNTER_PAGE_VIEWERS="COUNTER_PAGE_VIEWERS",e.COUNTER_SITE_CHATTERS="COUNTER_SITE_CHATTERS",e.COUNTER_SITE_VIEWERS="COUNTER_SITE_VIEWERS",e.HEATMAP_PAGE_VIEWERS="HEATMAP_PAGE_VIEWERS",e.HEATMAP_SITE_VIEWERS="HEATMAP_SITE_VIEWERS",e.LIST_CHAT_MESSAGES="LIST_CHAT_MESSAGES",e.LIST_CHAT_TYPING="LIST_CHAT_TYPING",e.LOGIN_STATUS="LOGIN_STATUS",e.PARAMETERS="PARAMETERS",e.POLL="POLL",e.POLL_STATUS="POLL_STATUS",e.RANKING_PAGE_CHATTERS="RANKING_PAGE_CHATTERS",e.RANKING_PAGE_VIEWERS="RANKING_PAGE_VIEWERS"},{}],44:[function(t,n,i){Object.defineProperty(i,"t",{value:!0}),i.ks=i.Rs=void 0,i.Rs=function(t,n){var i,e,s,r=(t=JSON.parse(t)).config.page_context;return(r=r&&r.query)&&("string"==typeof(s=r)||s instanceof String)&&(i=s=void 0,s=(e=r.match(/.*\/([igmsuy]+)$/))?(i=e[1],r.slice(1,-(i.length+1))):(i="",r.slice(1,-1)),t.config.page_context.query=new RegExp(s,i)),n&&"fn"===(null==(e=t.config.custom_auth)?void 0:e.jwt)&&(t.config.custom_auth.jwt=n.custom_auth.jwt),t},i.ks=function(t,n,i){var e=t+"#/"+n;return["site","lang","action","userId","siteKey","provider","wl","cm","bgColor","logo","sid"].forEach(function(t,n){null!=i&&i[t]&&(e+=(n?"&":"?")+t+"="+encodeURIComponent(i[t]))}),e}},{}]},{},[16]);