(self.webpackChunkn4rWidget=self.webpackChunkn4rWidget||[]).push([[348],{3052:function(e,t,s){"use strict";var i=s(491),n=s(4053),o=s(2138),a=s(2358);const r=i.v.UNSUB_GRACE_PERIOD;t.Z={data(){return{activated:!1,timerId:void 0}},activated(){this.activated=!0,(0,a.Z)(o.s.Debug,this.subject+" activated")},deactivated(){this.activated=!1,(0,a.Z)(o.s.Debug,this.subject+" deactivated")},computed:{isActive(){return n.Z.openedFrameConfig&&this.activated}},watch:{isActive(e,t){e?this.timerId?(clearTimeout(this.timerId),this.timerId=void 0,(0,a.Z)(o.s.Debug,this.subject+" greace unset")):this.subscribe():(this.timerId=setTimeout((()=>{(0,a.Z)(o.s.Debug,this.subject+" greace expired"),this.timerId=void 0,this.unsubscribe().then(this.resetState)}),r),(0,a.Z)(o.s.Debug,`${this.subject} ${r}ms greace set`))}}}},2120:function(e,t,s){"use strict";function i(e){let t=document.createElement("a");return t.href=e,t}s.d(t,{e:function(){return i}})},9877:function(){},4908:function(){},350:function(){},1389:function(){},2842:function(){},2111:function(){},8070:function(){},2969:function(){},1770:function(){},3517:function(){},9222:function(){},6770:function(){},2197:function(){},9050:function(){},4317:function(){},8614:function(){},1134:function(){},6236:function(){},9277:function(){},7703:function(){},9922:function(){},1778:function(){},2241:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Tt}});var i=s(4053),n=s(672),o=s(491),a=s(896),r=s(8178),l=s(8082),c=s(2120),d=s(5715),h=s(1795);function u(e){return JSON.parse(JSON.stringify(e))}var g=s(1651),p=s(4780),m=s(7536),v=s(5378),f={computed:{authenticated(){return"AUTHENTICATED"===i.Z.LOGIN_STATUS.status},authenticatedUser(){return this.authenticated?i.Z.LOGIN_STATUS.user:null}}},b=s(7638),_=s(4289),C=s(6181),w=s(2138),y=s(2358);var k=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cooldownMs=e.cooldownMs||1e4,this.audioSource=e.audioSource||null,this.lastPlayTime=0,this.audio=null,this.volume=e.volume||.5,this.enabled=!0,this.playOnlyInBackground=e.playOnlyInBackground||!1,this.visibilityTracker=null,this._initAudio(),this._initVisibilityTracking()}_initAudio(){if(this.audioSource)try{this.audio=new Audio(this.audioSource),this.audio.volume=this.volume,this.audio.load(),(0,y.Z)(w.s.Debug,"AudioNotifier: initialized with source",this.audioSource)}catch(e){(0,y.Z)(w.s.Error,"AudioNotifier: failed to initialize audio",e)}}_initVisibilityTracking(){this.visibilityTracker=new C.E({onHidden:()=>{this.playOnlyInBackground&&this._resetCooldown()}}),this.playOnlyInBackground&&!this.visibilityTracker.isSupported()&&(0,y.Z)(w.s.Debug,"AudioNotifier: Visibility API not supported, background audio notifications will not work")}_resetCooldown(){this.lastPlayTime=0}setEnabled(e){this.enabled=!!e}setVolume(e){e>=0&&e<=1&&this.audio&&(this.volume=e,this.audio.volume=e)}_canPlay(){if(!this.enabled||!this.audio)return!1;if(this.playOnlyInBackground&&(!this.visibilityTracker||!this.visibilityTracker.isSupported()||!this.visibilityTracker.isHidden()))return!1;return Date.now()-this.lastPlayTime>=this.cooldownMs}play(){if(!this._canPlay())return Promise.resolve(!1);this.lastPlayTime=Date.now();try{return this.audio.currentTime=0,this.audio.play().then((()=>((0,y.Z)(w.s.Debug,"AudioNotifier: sound played successfully"),!0))).catch((e=>((0,y.Z)(w.s.Debug,"AudioNotifier: error playing sound (promise rejected)",e),!1)))}catch(e){return(0,y.Z)(w.s.Error,"AudioNotifier: error playing sound",e),Promise.resolve(!1)}}destroy(){this.visibilityTracker&&(this.visibilityTracker.destroy(),this.visibilityTracker=null)}},M=s.p+"audio/new-message-1.ce7d18d4fabaa8cf1ff5.mp3";const E=38,T=40,S=37,x=39,$=8,A=46;var O={props:{maxLines:{type:Number,default:5},maxLength:{type:Number,default:140}},mixins:[p.Z,f],data(){return{store:i.Z,lines:1,chars:0,message:"",disabled:!1,enterDisabled:!1,lineHeight:null,maxHeight:84}},computed:{inputAreaStyle(){return{color:o.v.COLOR_B,backgroundColor:o.v.COLOR_A,caretColor:o.v.COLOR_B}}},mounted(){const e=window.getComputedStyle(this.$el,null),t=parseFloat(e.getPropertyValue("line-height"),10);this.lineHeight=t,this.maxHeight=10+this.maxLines*t},methods:{focus(){this.$el.focus()},disable(){this.disabled=!0},enable(){this.disabled=!1},disableEnter(){this.enterDisabled=!0},enableEnter(){this.enterDisabled=!1},clear(){this.$el.value="",this._handleHeightChange(),this._updateState(),this.$emit("input",this.message,this.lines,this.chars)},placeCaretAtEnd(){const e=this.$el,t=e.value;e.selectionStart=e.selectionEnd=t.length},setValue(e){this.disabled||(this.$el.value=e,this._handleHeightChange(),this._updateState(),this.$emit("input",this.message,this.lines,this.chars))},insertText(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.disabled)return;if(!(""!==this._getSelectedText())&&!t){const t=(0,r.u$)(e),s=this._getSelectedText(),i=(0,r.u$)(s);if(this.chars-i+t>this.maxLength)return}this._insertTextAtCursor(e),this._handleHeightChange(),this._updateState(),this.$emit("input",this.message,this.lines,this.chars)},onInput(e){(0,y.Z)(w.s.Debug,"onInput",e,e.target.scrollHeight),this._handleHeightChange(),this._handleInputChange(e)},onKeydown(e){(0,y.Z)(w.s.Debug,"onKeydown",e,this.disabled);const t=e.which||e.keyCode,s=e.ctrlKey||e.metaKey,i=s&&88===t,n=s&&65===t;if(s&&90===t||s&&89===t)return void setTimeout((()=>{this._handleHeightChange(),this._updateState(),this.$emit("input",this.message,this.lines,this.chars)}),0);const o=""!==this._getSelectedText();if(13===t){const t=this.store.isMobile;if(now4real.config.widget.markdown_enabled&&(t||e.shiftKey))return;return e.preventDefault(),void this._tryToSendMessage(t)}(this.disabled||!([E,T,S,x,A,$].includes(t)||o||i||n)&&this.chars>=this.maxLength)&&e.preventDefault()},_tryToSendMessage(){!(!this.authenticated&&(0,g.vU)())&&this.connected&&!this.enterDisabled&&this.message.trim().length>0&&this.chars<=this.maxLength&&(this.$emit("enter"),this.disable())},onBeforeInput(e){if((0,y.Z)(w.s.Debug,"onBeforeInput",e),"insertFromPaste"===e.inputType){if(!now4real.config.widget.markdown_enabled&&e.data){e.preventDefault();const t=this.$el,s=e.data.replace(/[\r\n]/g," ");if(document.queryCommandSupported?.("insertText"))document.execCommand("insertText",!1,s);else if("function"==typeof t.setRangeText){const e=t.selectionStart,i=t.selectionEnd;t.setRangeText(s,e,i,"end")}}}},onPaste(e){(0,y.Z)(w.s.Debug,"onPaste",e),this.disabled?e.preventDefault():this.$nextTick((()=>{this._handleHeightChange(),this._updateState(),this.$emit("input",this.message,this.lines,this.chars)}))},_handleInputChange(e){this._updateState(),this.$emit("input",this.message,this.lines,this.chars)},_handleHeightChange(){const e=this.$el;e.style.overflowY="hidden",e.style.height=0,e.scrollHeight<this.maxHeight?e.style.height=e.scrollHeight+"px":(e.style.height=this.maxHeight+"px",e.style.overflowY="auto"),e.selectionEnd===e.value.length&&(0,d.Og)(e)},_updateState(){const e=this.$el,t=e.value;this.message=t,this.chars=(0,r.u$)(t),this.lines=Math.round((e.scrollHeight-10)/this.lineHeight),(0,y.Z)(w.s.Debug,"_updateState",this.chars,this.lines)},_getSelectedText(){const e=this.$el;return e.value.substring(e.selectionStart,e.selectionEnd)},_insertTextAtCursor(e){const t=this.$el,s=t.selectionStart,i=t.selectionEnd;if("number"==typeof s&&"number"==typeof i){const n=t.value,o=s;t.value=(0,r.VO)(n,s,i,e),t.selectionStart=t.selectionEnd=o+e.length,document.activeElement!==t&&t.focus()}}}},P=O,I=(s(6933),s(1900)),Z=(0,I.Z)(P,(function(){var e=this;return(0,e._self._c)("textarea",{staticClass:"input-area focus-cont",class:{"input-area-disabled":e.disabled},style:e.inputAreaStyle,attrs:{id:"chat-message-input",name:"chat-message-input",tabindex:"1003",rows:"1",placeholder:e.$lang.data.k80},on:{keydown:function(t){return t.stopPropagation(),e.onKeydown(t)},input:function(t){return t.stopPropagation(),e.onInput(t)},beforeinput:function(t){return e.onBeforeInput(t)},paste:function(t){return e.onPaste(t)}}})}),[],!1,null,null,null).exports,L=s(9814),D=s(6782),R=s(2987);let H="https:";const N=window.markdownit("zero",{}).enable(["emphasis","link"]);N.renderer.rules.link_open=function(e,t,s,i,n){const o=e[t],a=o.attrIndex("href");if(a>=0){let e=o.attrs[a][1];if(e.startsWith("//"))e=H+e,o.attrs[a][1]=e;else if(e.startsWith("/")||!e.match(/^[a-z]+:\/\//i)){const t=window.now4real.siteContext||"";e=e.startsWith("/")?e.substring(1):e;const s=`${H}//${t}/${e}`;o.attrs[a][1]=s}}return o.attrPush(["target","_blank"]),o.attrPush(["rel","noopener noreferrer nofollow ugc"]),n.renderToken(e,t,s)};var B={data(){return{store:i.Z,showed:!1,submitted:!1,intent:null,params:null,mode:null,MODE_A:1,MODE_B:2,consentMessage:null,customConsentMessage:null,consentAcceptance:!1,customConsentAcceptance:!1}},methods:{show(e,t){this.showed=!0,this.intent=e,this.params=t,this.$nextTick((e=>{this.handleFocus()}))},hide(){this.showed=!1,this.intent=null,this.params=null,this.consentAcceptance=!1,this.customConsentAcceptance=!1},handleFocus(){let e;e=this.mode===this.MODE_A?document.getElementById("accept"):document.querySelector(".jwt-modal-header a"),e&&e.focus()},generateClick(e){(0,L.H)(e.target.firstChild)},accept(e){this.submitted=!0,now4real.registerUserConsent().then((e=>{this.$emit("accept",this.intent,this.params),this.submitted=!1})).catch((e=>{(0,y.Z)(w.s.Error,"registerUserConsent error",e),this.$toast(this.$lang.data.k1,{parent:".chat-container",id:"logout-error",className:"toast-alert"}),this.submitted=!1}))},generateConsent(){return this.$lang.complete("k133",{"<a1>":'<span class="focus-el" tabindex="13"><a class="focus-cont" tabindex="-1" href="https://now4real.com/terms/" rel="noopener noreferrer nofollow" target="_blank">',"</a1>":"</a></span>","<a2>":'<span class="focus-el" tabindex="14"><a class="focus-cont" tabindex="-1" href="https://now4real.com/privacy/" rel="noopener noreferrer nofollow" target="_blank">',"</a2>":"</a></span>"})},generateCustomConsent(e){const t=(e=e.replaceAll("\n","")).substring(0,1e3);let s;try{s=N.render(t)}catch(e){(0,y.Z)(w.s.Error,"Markdown formatting error",e),s=(0,r.sY)(t)}return s=s.replace(/&lt;(?:(?:(?!(&lt;|&gt;)).)+)href=&quot;((?!javascript:).*?)&quot;(?:(?:(?!(&lt;|&gt;)).)*)*&gt;((?:(?!&lt;).)+)&lt;\/a&gt;/gm,((e,t,s,i,n)=>`<span class="focus-el" tabindex="17"><a class="focus-cont" tabindex="-1" href="${s}" rel="noopener noreferrer nofollow ugc" target="_blank">${n}</a></span>`)),s}},computed:{allAccepted(){return this.consentAcceptance&&this.customConsentAcceptance}},created(){const e=this.$whiteLabel,t=now4real.config.widget.consent_message;!e&&t?(this.mode=this.MODE_B,this.consentMessage=this.generateConsent(),this.customConsentMessage=this.generateCustomConsent(t)):(this.mode=this.MODE_A,this.consentMessage=t?this.generateCustomConsent(t):this.generateConsent())},components:{Modal:D.Z,Button:R.Z}},U=(s(175),(0,I.Z)(B,(function(){var e=this,t=e._self._c;return e.showed?t("modal",{on:{close:function(t){return e.$emit("close")}}},[t("template",{slot:"title"},[e._v("\n        "+e._s(e.$lang.data.k132)+"\n    ")]),e._v(" "),t("template",{slot:"header"},[e.mode===e.MODE_A?t("div",{staticClass:"jwt-modal-header"},[t("p",{domProps:{innerHTML:e._s(e.consentMessage)}})]):t("div",{staticClass:"jwt-modal-header"},[t("p",{domProps:{innerHTML:e._s(e.consentMessage)}}),e._v(" "),t("div",{staticClass:"c-radio-group"},[t("div",{staticClass:"c-radio-input focus-el",attrs:{tabindex:"15"},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.generateClick.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.consentAcceptance,expression:"consentAcceptance"}],staticClass:"focus-cont",attrs:{type:"radio",id:"bc-disagree-radio",tabindex:"-1"},domProps:{value:!1,checked:e._q(e.consentAcceptance,!1)},on:{change:function(t){e.consentAcceptance=!1}}}),e._v(" "),t("label",{staticClass:"focus-cont",attrs:{for:"bc-disagree-radio",tabindex:"-1"}},[e._v(e._s(e.$lang.data.k135))])]),e._v(" "),t("div",{staticClass:"c-radio-input focus-el",attrs:{tabindex:"16"},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.generateClick.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.consentAcceptance,expression:"consentAcceptance"}],staticClass:"focus-cont",attrs:{type:"radio",id:"bc-agree-radio",tabindex:"-1"},domProps:{value:!0,checked:e._q(e.consentAcceptance,!0)},on:{change:function(t){e.consentAcceptance=!0}}}),e._v(" "),t("label",{staticClass:"focus-cont",attrs:{for:"bc-agree-radio",tabindex:"-1"}},[e._v(e._s(e.$lang.data.k136))])])]),e._v(" "),t("p",{staticClass:"c-consent",domProps:{innerHTML:e._s(e.customConsentMessage)}}),e._v(" "),t("div",{staticClass:"c-radio-group"},[t("div",{staticClass:"c-radio-input focus-el",attrs:{tabindex:"18"},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.generateClick.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.customConsentAcceptance,expression:"customConsentAcceptance"}],staticClass:"focus-cont",attrs:{type:"radio",id:"cc-disagree-radio",tabindex:"-1"},domProps:{value:!1,checked:e._q(e.customConsentAcceptance,!1)},on:{change:function(t){e.customConsentAcceptance=!1}}}),e._v(" "),t("label",{staticClass:"focus-cont",attrs:{for:"cc-disagree-radio",tabindex:"-1"}},[e._v(e._s(e.$lang.data.k135))])]),e._v(" "),t("div",{staticClass:"c-radio-input focus-el",attrs:{tabindex:"19"},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.generateClick.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.customConsentAcceptance,expression:"customConsentAcceptance"}],staticClass:"focus-cont",attrs:{type:"radio",id:"cc-agree-radio",tabindex:"-1"},domProps:{value:!0,checked:e._q(e.customConsentAcceptance,!0)},on:{change:function(t){e.customConsentAcceptance=!0}}}),e._v(" "),t("label",{staticClass:"focus-cont",attrs:{for:"cc-agree-radio",tabindex:"-1"}},[e._v(e._s(e.$lang.data.k136))])])])])]),e._v(" "),t("template",{slot:"footer"},[e.mode===e.MODE_A?t("Button",{attrs:{id:"accept",disabled:e.submitted,submitted:e.submitted,tabindex:"20"},on:{click:e.accept}},[e._v("\n            "+e._s(e.$lang.data.k134)+"\n        ")]):t("Button",{attrs:{id:"continue",disabled:!e.allAccepted||e.submitted,submitted:e.submitted,tabindex:"20"},on:{click:e.accept}},[e._v("\n            "+e._s(e.$lang.data.k137)+"\n        ")])],1)],2):e._e()}),[],!1,null,null,null)),V=U.exports,j=s(6082),G=s(7474);const z="3600";var W={data(){return{store:i.Z,loading:!1,showed:!1,submitted:!1,header:null,body:null,muteValue:1,muteUnit:z,minMuteValue:null}},methods:{onKeyPress(e){e.key&&[",",".","-"].indexOf(e.key)>-1&&e.preventDefault(),this.muteValue&&3===this.muteValue.length&&e.preventDefault()},show(e){this.user=e,this.showed=!0,this.loading=!0,now4real.getMute(e.id).then((e=>{if(console.log("getMuteStatus response",e),e)if(e.expiration){let t=e.expiration;this.header=this.$lang.complete("k139",{$U:`<strong>${this.user.name}</strong>`,$E:new Date(t).toUTCString()}),this.body=this.$lang.data.k142,this.minMuteValue=0}else this.header=this.$lang.complete("k139Forever",{$U:`<strong>${this.user.name}</strong>`}),this.body=this.$lang.data.k142,this.minMuteValue=0;else this.body=this.$lang.complete("k141",{$U:`<strong>${this.user.name}</strong>`}),this.minMuteValue=1;this.loading=!1,this.$nextTick((e=>{document.getElementById("mute-value").focus()}))})).catch((e=>{console.error("getMuteStatus error",e),this.$toast(this.$lang.data.k1,{parent:"body",id:"mute-error",className:"toast-alert"}),this.hide()}))},hide(){this.showed=!1,this.user=null,this.loading=!1,this.submitted=!1,this.header=null,this.body=null,this.muteValue=1,this.muteUnit=z,this.minMuteValue=null},save(){this.submitted=!0;const e=this.muteUnit?Number(this.muteValue)*Number(this.muteUnit):null;now4real.setMute(this.user.id,e).then((e=>{console.log("setMute response",e),this.hide(),this.submitted=!1})).catch((e=>{console.error("setMute error",e),this.$toast(this.$lang.data.k1,{parent:"body",id:"mute-error",className:"toast-alert"}),this.submitted=!1}))}},components:{Modal:D.Z,Spinner:j.Z,Button:R.Z,UserPic:G.Z}},K=(s(4855),(0,I.Z)(W,(function(){var e=this,t=e._self._c;return e.showed?t("modal",{attrs:{id:"mute-modal"},on:{close:e.hide}},[t("template",{slot:"title"},[e._v("\n        "+e._s(e.$lang.data.k138)+"\n    ")]),e._v(" "),t("template",{slot:"header"},[t("div",{staticClass:"section"},[t("user-pic",{attrs:{id:"user-pic",user:e.user}}),e._v(" "),e.header?t("div",{domProps:{innerHTML:e._s(e.header)}}):e._e()],1)]),e._v(" "),t("template",{slot:"body"},[t("div",{staticClass:"section"},[e.loading?t("spinner"):t("div",[t("div",{domProps:{innerHTML:e._s(e.body)}}),e._v(" "),t("div",{staticClass:"mute-settings"},[t("span",{staticClass:"focus-el",attrs:{tabindex:"13"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.muteValue,expression:"muteValue"}],staticClass:"focus-cont",attrs:{type:"number",min:e.minMuteValue,max:"999",id:"mute-value",tabindex:"-1",disabled:!e.muteUnit},domProps:{value:e.muteValue},on:{keypress:e.onKeyPress,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save.apply(null,arguments)},paste:function(e){e.preventDefault()},input:function(t){t.target.composing||(e.muteValue=t.target.value)}}})]),e._v(" "),t("span",{staticClass:"focus-el",attrs:{tabindex:"14"}},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.muteUnit,expression:"muteUnit"}],staticClass:"focus-cont",attrs:{name:"unit",id:"mute-unit",tabindex:"-1"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.muteUnit=t.target.multiple?s:s[0]}}},[t("option",{attrs:{value:"60"}},[e._v(e._s(e.$lang.data.k5s))]),e._v(" "),t("option",{attrs:{value:"3600"}},[e._v(e._s(e.$lang.data.k7s))]),e._v(" "),t("option",{attrs:{value:"86400"}},[e._v(e._s(e.$lang.data.k9s))]),e._v(" "),t("option",{attrs:{value:"694800"}},[e._v(e._s(e.$lang.data.k11s))]),e._v(" "),t("option",{attrs:{value:"2592000"}},[e._v(e._s(e.$lang.data.k13s))]),e._v(" "),t("option",{attrs:{value:"31536000"}},[e._v(e._s(e.$lang.data.k15s))]),e._v(" "),t("option",{attrs:{value:""}},[e._v(e._s(e.$lang.data.k17))])])])]),e._v(" "),t("div",{staticClass:"remove-info"},[e._v("\n                    "+e._s(e.$lang.data.k143)+"\n                ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.header&&"0"===e.muteValue,expression:"header && muteValue === '0'"}],staticClass:"remove-alert"},[e._v("\n                    "+e._s(e.$lang.data.k144)+"\n                ")])])],1)]),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"section"},[e.loading?e._e():t("Button",{attrs:{disabled:e.submitted,submitted:e.submitted,tabindex:"15"},on:{click:e.save}},[e._v("\n                "+e._s(e.$lang.data.k145)+"\n            ")])],1)])],2):e._e()}),[],!1,null,null,null)),q=K.exports,Y={data(){return{store:i.Z,showed:!1,submitted:!1,msg:null,reasonRadioGroup:null,reason:null,comment:null}},methods:{generateClick(e){(0,L.H)(e.target.firstChild)},show(e){this.msg=e;const t=this.$lang.data;this.reasonRadioGroup=[{value:a.Z.SPAM,text:t.k161},{value:a.Z.HATE_SPEECH,text:t.k158},{value:a.Z.VIOLENCE,text:t.k159},{value:a.Z.PORNOGRAPHY,text:t.k160},{value:a.Z.SELF_INJURY,text:t.k162},{value:a.Z.COPYRIGHT,text:t.k163},{value:a.Z.OTHER,text:t.k164}],this.reason=a.Z.SPAM,this.showed=!0,this.$nextTick((e=>{let t=document.querySelector("#reason .r-radio-input input");t&&t.focus()}))},hide(){this.showed=!1,this.msg=null,this.reasonRadioGroup=null,this.reason=null,this.comment=null},report(){this.submitted=!0,now4real.reportMessage(this.msg.id,this.reason,this.comment).then((e=>{console.log("report response",e),this.$toast(this.$lang.data.k167,{parent:".chat-container",id:"report-ok",className:"report-toast-info"}),this.hide(),this.submitted=!1})).catch((e=>{let t;console.error("report error",e),t=e.code===now4real.ErrorCode.ALREADY_REPORTED?this.$lang.data.k168:e.code===now4real.ErrorCode.USER_MUTED?this.$lang.data.k2:this.$lang.data.k1,this.$toast(t,{parent:".chat-container",id:"report-error",className:"toast-alert"}),this.submitted=!1}))}},components:{Modal:D.Z,Button:R.Z}},F=(s(3466),(0,I.Z)(Y,(function(){var e=this,t=e._self._c;return e.showed?t("modal",{attrs:{id:"report-modal"},on:{close:e.hide}},[t("template",{slot:"title"},[e._v("\n        "+e._s(e.$lang.data.k155)+"\n    ")]),e._v(" "),t("template",{slot:"header"},[t("p",{attrs:{id:"header"}},[e._v(e._s(e.$lang.data.k156))])]),e._v(" "),t("template",{slot:"body"},[t("div",{staticClass:"section"},[t("p",{attrs:{id:"note"}},[e._v(e._s(e.$lang.data.k157))]),e._v(" "),t("div",{attrs:{id:"reason"}},[t("div",{staticClass:"r-radio-group"},e._l(e.reasonRadioGroup,(function(s,i){return t("div",{key:s.value,staticClass:"r-radio-input focus-el",attrs:{tabindex:15+i},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.generateClick.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.reason,expression:"reason"}],staticClass:"focus-cont",attrs:{type:"radio",id:s.value.toLowerCase()+"-radio",tabindex:"-1"},domProps:{value:s.value,checked:e._q(e.reason,s.value)},on:{change:function(t){e.reason=s.value}}}),e._v(" "),t("label",{staticClass:"focus-cont",attrs:{for:s.value.toLowerCase()+"-radio",tabindex:"-1"}},[e._v(e._s(s.text))])])})),0)]),e._v(" "),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],attrs:{id:"comment",rows:"3",maxlength:"500",placeholder:e.$lang.data.k165,tabindex:"22"},domProps:{value:e.comment},on:{input:function(t){t.target.composing||(e.comment=t.target.value)}}})])]),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"section"},[t("Button",{attrs:{disabled:e.submitted,submitted:e.submitted,tabindex:"23"},on:{click:e.report}},[e._v("\n                "+e._s(e.$lang.data.k166)+"\n            ")])],1)])],2):e._e()}),[],!1,null,null,null)),J=F.exports,X={data(){return{store:i.Z,showed:!1,submitted:!1,header:null,body:null,msg:null,intent:null,HIDE_INTENT:a.Z.HIDE,SHOW_INTENT:a.Z.SHOW}},methods:{show(e,t){this.msg=e,this.intent=t,this.showed=!0;const s=t===this.HIDE_INTENT?"k148":"k149";this.header=this.$lang.complete(s,{$U:`<strong>${e.author.name}</strong>`}),t===this.HIDE_INTENT&&(this.body=this.$lang.data.k150),this.$nextTick((e=>{let t=document.querySelector("#hide-modal #save");t&&t.focus()}))},hide(){this.showed=!1,this.msg=null,this.intent=null,this.header=null,this.body=null,this.submitted=!1},save(){this.submitted=!0;const e=this.msg.author.id,t=this.intent,s=this.store.hiddenUsers,i=a.Z.HIDDEN_USERS_KEY;let n=[];Object.keys(s).forEach((e=>{const t=s[e]-1;n[t]=e})),t===this.HIDE_INTENT?-1===n.indexOf(e)&&(n.push(e),n.length>o.v.MAX_USERS_HIDEABLE&&n.shift()):n=n.filter((t=>t!==e)),(0,y.Z)(w.s.Debug,"save",e,t,s,i,n);(n.length?now4real.userPreferences.setItem(i,n):now4real.userPreferences.removeItem(i)).then((e=>{this.hide(),this.submitted=!1})).catch((e=>{(0,y.Z)(w.s.Error,e),this.$toast(this.$lang.data.k1,{parent:".chat-container",id:"hide-error",className:"toast-alert"}),this.submitted=!1}))}},components:{Modal:D.Z,Button:R.Z,UserPic:G.Z}},Q=(s(3529),(0,I.Z)(X,(function(){var e=this,t=e._self._c;return e.showed?t("modal",{attrs:{id:"hide-modal"},on:{close:e.hide}},[t("template",{slot:"title"},[e.intent===e.HIDE_INTENT?[e._v("\n            "+e._s(e.$lang.data.k146)+"\n        ")]:[e._v("\n            "+e._s(e.$lang.data.k147)+"\n        ")]],2),e._v(" "),t("template",{slot:"header"},[e.msg&&e.header?t("div",{staticClass:"section"},[t("user-pic",{attrs:{id:"user-pic",user:e.msg.author}}),e._v(" "),t("div",{domProps:{innerHTML:e._s(e.header)}})],1):e._e()]),e._v(" "),t("template",{slot:"body"},[e.body?t("div",{staticClass:"section"},[t("div",{domProps:{innerHTML:e._s(e.body)}})]):e._e()]),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"section"},[t("Button",{attrs:{id:"save",disabled:e.submitted,submitted:e.submitted,tabindex:"13"},on:{click:e.save}},[e._v("\n                "+e._s(e.$lang.data.k151)+"\n            ")])],1)])],2):e._e()}),[],!1,null,null,null).exports),ee=s(144);const te={props:{suggestions:{type:Array,required:!0,default:()=>[]},color:{type:String,default:"red"}},computed:{limitedSuggestions(){return this.suggestions.slice(0,5)}},methods:{handleClick(e){this.$emit("suggestion-clicked",e)}}},se=()=>{(0,ee.sj)(((e,t)=>({"587d7fad":e.color})))},ie=te.setup;te.setup=ie?(e,t)=>(se(),ie(e,t)):se;var ne=te,oe=(s(3242),(0,I.Z)(ne,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"suggestions-container",class:{"has-suggestions":e.limitedSuggestions.length>0}},e._l(e.limitedSuggestions,(function(s,i){return t("button",{key:`${s}-${i}`,staticClass:"suggestion-button",on:{click:function(t){return e.handleClick(s)}}},[e._v("\n        "+e._s(s)+"\n    ")])})),0)}),[],!1,null,"6c52f1e0",null).exports);var ae=s(3052),re=s(5876),le={name:"div-component"},ce=(0,I.Z)(le,(function(){return(0,this._self._c)("div",[this._t("default")],2)}),[],!1,null,null,null).exports;const de=new class{constructor(e,t){this.name=t||"Elastic",this.time=e||2e4,this.id=null,this.onEnd=null}_set(e){this.id=setTimeout((()=>{this.id=null,e()}),this.time)}_reset(){clearTimeout(this.id),this.id=null}start(e,t){null===this.id?((0,y.Z)(w.s.Debug,`First "${this.name}" timer initialization`),this.onEnd=t,e()):((0,y.Z)(w.s.Debug,`"${this.name}" timer reinitialized`),this._reset()),this._set(t)}invalidate(){null!==this.id&&((0,y.Z)(w.s.Debug,`"${this.name}" timer invalidation`),this.onEnd(),this._reset(),this.onEnd=null)}}(o.v.TYPING_TIMEOUT,"typing"),he="COUNTER_CHAT_TYPING",ue="LIST_CHAT_TYPING";var ge={name:"typing",mixins:[ae.Z,p.Z],data(){return{subject:[he,ue].join(" & "),typingUsers:[],typingCounter:null,scope:o.v.SCOPE,typingEnabled:null}},created(){this.typingEnabled=o.v.CHAT_VIEW&&now4real.config.widget.typing_enabled},methods:{write(e){(0,y.Z)(w.s.Debug,"write call",e),""!==e?((0,y.Z)(w.s.Debug,"Start to type"),de.start((()=>now4real.startTyping()),(()=>now4real.stopTyping()))):((0,y.Z)(w.s.Debug,"Stop to type"),de.invalidate())},subscribe(){return this.typingEnabled?Promise.all([now4real.subscribe(he,(e=>{(0,y.Z)(w.s.Debug,"Typing counter update",e),this.typingCounter=e.data.value})),now4real.subscribe(ue,(e=>{(0,y.Z)(w.s.Debug,"Typing update",e)})).then((e=>{this.typingUsers=now4real[ue]}))]):Promise.resolve()},unsubscribe(){return de.invalidate(),this.typingEnabled?Promise.all([now4real.unsubscribe(he),now4real.unsubscribe(ue)]):Promise.resolve()},resetState(){(0,y.Z)(w.s.Debug,"typing reset state call"),this.typingUsers=[],this.typingCounter=null}},computed:{typingList(){let e="";if(null===this.typingCounter)return e;const t=Number(this.typingCounter),s=this.typingUsers.length,i=t-s;return t>0&&i>=0&&(e=s?1===s?i?1===i?this.$lang.complete("k126",{$A:this.typingUsers[0].name}):this.$lang.complete("k127",{$A:this.typingUsers[0].name,$N:i}):this.$lang.complete("k123",{$A:this.typingUsers[0].name}):2===s?i?1===i?this.$lang.complete("k128",{$A:this.typingUsers[0].name,$B:this.typingUsers[1].name}):this.$lang.complete("k129",{$A:this.typingUsers[0].name,$B:this.typingUsers[1].name,$N:i}):this.$lang.complete("k124",{$A:this.typingUsers[0].name,$B:this.typingUsers[1].name}):i?1===i?this.$lang.complete("k130",{$A:this.typingUsers[0].name,$B:this.typingUsers[1].name,$C:this.typingUsers[2].name}):this.$lang.complete("k131",{$A:this.typingUsers[0].name,$B:this.typingUsers[1].name,$C:this.typingUsers[2].name,$N:i}):this.$lang.complete("k125",{$A:this.typingUsers[0].name,$B:this.typingUsers[1].name,$C:this.typingUsers[2].name}):1===i?this.$lang.data.k121:this.$lang.complete("k122",{$N:i})),e},showTyping(){return this.typingCounter&&Number(this.typingCounter)>0&&Number(this.typingCounter)-this.typingUsers.length>=0}},components:{Presence:re.Z,DivComponent:ce}},pe=(s(1061),(0,I.Z)(ge,(function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"typing-container"}},[t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("keep-alive",[e.connected&&e.typingEnabled&&e.showTyping?t("div-component",{staticClass:"typing-summary"},[e._v("\n                "+e._s(e.typingList)+"\n            ")]):e.connected?t("presence",{attrs:{context:e.scope}}):e._e()],1)],1)],1)}),[],!1,null,null,null).exports),me=s(2712);const ve=[{version:16,emoji:String.fromCodePoint(129734)},{version:15.1,emoji:String.fromCodePoint(127819)+String.fromCodePoint(8205)+String.fromCodePoint(129001)},{version:15,emoji:String.fromCodePoint(129768)},{version:14,emoji:String.fromCodePoint(129760)},{version:13,emoji:String.fromCodePoint(129394)},{version:12,emoji:String.fromCodePoint(129393)},{version:11,emoji:String.fromCodePoint(129396)},{version:5,emoji:String.fromCodePoint(129322)},{version:4,emoji:String.fromCodePoint(9877)+String.fromCodePoint(65039)},{version:3,emoji:String.fromCodePoint(129314)},{version:2,emoji:String.fromCodePoint(128488)+String.fromCodePoint(65039)},{version:1,emoji:String.fromCodePoint(128512)}];function fe(){const e=ve.find((e=>function(e){let t=null;try{t=document.createElement("canvas").getContext("2d")}catch{}if(!t)return!1;const s=25,i=20,n=Math.floor(s/2);t.font=n+"px Arial, Sans-Serif",t.textBaseline="top",t.canvas.width=2*i,t.canvas.height=s,t.clearRect(0,0,2*i,s),t.fillStyle="#FF0000",t.fillText(e,0,22),t.fillStyle="#0000FF",t.fillText(e,i,22);const o=t.getImageData(0,0,i,s).data,a=o.length;let r=0;for(;r<a&&!o[r+3];r+=4);if(r>=a)return!1;const l=i+r/4%i,c=Math.floor(r/4/i),d=t.getImageData(l,c,1,1).data;if(o[r]!==d[0]||o[r+2]!==d[2])return!1;if(t.measureText(e).width>=i)return!1;return!0}(e.emoji)));return e?.version??1}var be=s(7856),_e={mixins:[f],data(){return{store:i.Z,availableLangs:["da","de","en","es","et","fi","fr","hu","it","ja","ko","lt","ms","nb","nl","pl","pt","ru","sv","th","uk","zh"],chosenLang:null,platformSupportedEmojiVersion:null,cachedPicker:null,recents:null,recentsTmp:null,optionUpdateListenerUnwatcher:null}},methods:{getRecents(){const e=this.authenticatedUser;let t=[];return e&&e.preferences&&e.preferences[a.Z.RECENTS_EMOJIS_KEY]&&(0,me.kJ)(e.preferences[a.Z.RECENTS_EMOJIS_KEY])&&(t=e.preferences[a.Z.RECENTS_EMOJIS_KEY]),t},setupOptionUpdateListener(e){const t=()=>{this.cachedPicker?.updateOptions(this.computeUpdateSizes())};if(this.store.containerMode){const e=(0,be.P)(500,t);window.addEventListener("resize",e),this.optionUpdateListenerUnwatcher=()=>{window.removeEventListener("resize",e)}}else this.optionUpdateListenerUnwatcher=this.$watch("store.isMobile",t);e&&t()},resetOptionUpdateListener(){this.optionUpdateListenerUnwatcher&&(this.optionUpdateListenerUnwatcher(),this.optionUpdateListenerUnwatcher=null)},computeUpdateSizes(){const e=this.store.containerMode,t=this.store.isMobile;let s,i,n;if(e)s="1.5rem",i=Math.floor(window.innerWidth/34),n=3;else if(t){s="1.7rem",i=9;const e=screen?.height||0;n=e>=824?5:e>=780?4:3}else s="1.5rem",i=8,n=3;return{emojiSize:s,emojisPerRow:i,visibleRows:n}},storeRecents(){(0,y.Z)(w.s.Debug,"Emoji-picker storeRecents",this.recents,this.recentsTmp),this.recents&&this.recentsTmp&&JSON.stringify(this.recents)!==JSON.stringify(this.recentsTmp)&&((0,y.Z)(w.s.Debug,"Emoji-picker save",this.recentsTmp),this.recents=this.recentsTmp,now4real.userPreferences.setItem(a.Z.RECENTS_EMOJIS_KEY,this.recentsTmp))},renderPicker(e,t){if(!this.cachedPicker){(0,y.Z)(w.s.Debug,"Emoji-picker renderPicker",e,t,this.platformSupportedEmojiVersion);const s=performance.now(),i=this;class n extends picmo.RecentsProvider{constructor(){super()}clear(){(0,y.Z)(w.s.Debug,"UserPreferencesRecentsProvider clear")}getRecents(e){return(0,y.Z)(w.s.Debug,"UserPreferencesRecentsProvider getRecents",e),t}addOrUpdateRecent(e,t){(0,y.Z)(w.s.Debug,"UserPreferencesRecentsProvider addOrUpdateRecent",e,t);const s=e.emoji,n=i.recentsTmp,a=[s,...n.filter((e=>e!==s))].slice(0,o.v.MAX_RECENTS_EMOJIS);i.recentsTmp=a}}const a=!!t,r=this.computeUpdateSizes(),l=document.documentElement.classList.contains("noto-color-emoji")?16:this.platformSupportedEmojiVersion,c=this.$lang.data,d=picmo.createPicker({rootElement:document.querySelector("#emoji-picker"),emojiVersion:l,showPreview:!1,visibleRows:r.visibleRows,emojiSize:r.emojiSize,emojisPerRow:r.emojisPerRow,locale:e,i18n:{"categories.recents":c.k111,"recents.none":c["k111.none"],"error.load":c.k117,retry:c.k118,"search.clear":c["k113.clear"],"search.error":c["k113.error"],"search.notFound":c["k113.notFound"],search:c.k113},showRecents:a,maxRecents:a?o.v.MAX_RECENTS_EMOJIS:0,recentsProvider:a?new n:null,initialCategory:a&&t.length?"recents":"smileys-emotion",className:"my-picker"});return d.addEventListener("data:ready",(e=>{const t=performance.now();(0,y.Z)(w.s.Debug,`Emoji-picker ready in: ${t-s}ms`)})),d.addEventListener("emoji:select",(e=>{const t=e.emoji;(0,y.Z)(w.s.Debug,"Emoji-picker select:",e,t),this.$emit("selection",t),setTimeout((e=>{document.querySelectorAll('.recentEmojis button:not([title=""])').forEach((e=>e.setAttribute("title","")))}),0)})),this.cachedPicker=d,!1}return!0},purgeCache(){(0,y.Z)(w.s.Debug,"Emoji-picker purgeCache",this.cachedPicker),this.cachedPicker&&(this.cachedPicker.destroy(),this.cachedPicker=null),this.recents=null,this.recentsTmp=null}},created(){(0,y.Z)(w.s.Debug,"Emoji-picker created");const e=this.$lang.currentLang,t=this.availableLangs.find((t=>t===e));this.chosenLang=t||"en",this.platformSupportedEmojiVersion=fe()},activated(){(0,y.Z)(w.s.Debug,"Emoji-picker activated");let e=null;this.authenticated&&(this.recents||(this.recents=this.getRecents()),this.recentsTmp||(this.recentsTmp=this.recents),e=this.recents.map((e=>({emoji:e,label:""}))));const t=this.renderPicker(this.chosenLang,e);this.setupOptionUpdateListener(t)},deactivated(){(0,y.Z)(w.s.Debug,"Emoji-picker deactivated"),this.resetOptionUpdateListener()}},Ce=(s(8626),(0,I.Z)(_e,(function(){this._self._c;return this._m(0)}),[function(){var e=this._self._c;return e("div",{attrs:{id:"emoji-picker-container"}},[e("div",{attrs:{id:"emoji-picker"}})])}],!1,null,null,null).exports),we=[function(){var e=this._self._c;return e("a",{attrs:{href:"https://tenor.com",target:"_blank",rel:"noopener noreferrer nofollow"}},[e("img",{attrs:{src:s(4409),alt:"TENOR"}})])}],ye=s(8685),ke={props:["gif","observer"],mounted(){this.observer&&(this.observer.observe(this.$el),(0,y.Z)(w.s.Debug,"observe",this.$el,this.gif.id))},beforeDestroy(){this.observer&&(this.observer.unobserve(this.$el),(0,y.Z)(w.s.Debug,"unobserve",this.$el,this.gif.id))},methods:{onClick(e){this.$emit("click",`https://tenor.com/view/${e.id}`)}}},Me=ke,Ee=(s(8408),(0,I.Z)(Me,(function(){var e=this;return(0,e._self._c)("button",{staticClass:"tenor-picker-item",style:`background-image: url('${e.gif.media_formats.tinygif.url}')`,on:{click:function(t){return e.onClick(e.gif)}}})}),[],!1,null,null,null).exports),Te={data(){return{retryLink:null}},created(){window.tenorTryAgainHandler=()=>{this.$emit("tryAgain")},this.retryLink=this.$lang.complete("k120",{"<a>":'<a href="javascript:void(0)" onclick="window.tenorTryAgainHandler()">'})},destroyed(){delete window.tenorTryAgainHandler}},Se=(s(19),(0,I.Z)(Te,(function(){var e=this;return(0,e._self._c)("p",{staticClass:"tenor-error-line",domProps:{innerHTML:e._s(e.retryLink)}})}),[],!1,null,null,null).exports),xe={props:{data:Array},data(){return{loading:!1,error:!1,gifs:null,observer:null}},watch:{data(e){(0,y.Z)(w.s.Debug,"Grid data update",e),this.gifs=e,this.loading=!1,this.error=!1}},created(){(0,y.Z)(w.s.Debug,"Grid created",this.data),this.gifs=this.data,this.observer=new IntersectionObserver(this.onElementObserved,{root:this.$el,threshold:.5})},methods:{isLastChild(e){return e===this.gifs.length-1},onElementObserved(e){e.forEach((e=>{let{target:t,isIntersecting:s}=e;s&&(this.observer.unobserve(t),this.$emit("loadMore"))}))},onSelected(e){this.$emit("selection",e)},onTryAgain(){this.$emit("loadMore")},markLoading(){this.loading=!0,this.error=!1},markLoadingError(){this.loading=!1,this.error=!0},scrollTop(){(0,d.k3)(this.$el)}},beforeUnmount(){this.observer.disconnect()},components:{TenorPickerItem:Ee,TenorLoadingErrorLine:Se,Spinner:j.Z}},$e=xe,Ae=(s(5614),(0,I.Z)($e,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"tenor-grid-wrapper"},[t("div",{staticClass:"tenor-grid"},e._l(e.gifs,(function(s,i){return t("div",{key:s.id+"-"+i},[e.isLastChild(i)?t("TenorPickerItem",{attrs:{gif:s,observer:e.observer},on:{click:e.onSelected}}):t("TenorPickerItem",{attrs:{gif:s},on:{click:e.onSelected}})],1)})),0),e._v(" "),e.loading?t("Spinner"):e.error?t("TenorLoadingErrorLine",{on:{tryAgain:e.onTryAgain}}):e._e()],1)}),[],!1,null,null,null)),Oe=Ae.exports;const Pe=new ye.Z(o.v.TENOR_API_KEY);var Ie={props:{rating:{type:String,default:"G"}},mixins:[p.Z],data(){return{store:i.Z,loading:!1,error:!1,searchValue:"",result:null,resultTrending:null,next:null,nextTrending:null}},computed:{computedRating(){return this.mapRating(this.rating)}},created(){(0,y.Z)(w.s.Debug,"Tenor picker created",this.rating,this.mapRating(this.rating)),this.loadTrending()},methods:{async loadTrending(){try{this.loading=!0;const e=await this.doTrendingSearch();this.result=e.results,this.resultTrending=e.results,this.nextTrending=e.next,this.loading=!1}catch(e){(0,y.Z)(w.s.Error,e),this.loading=!1,this.error=!0}},mapRating(e){return{G:"high",PG:"medium","PG-13":"low",R:"off"}[e]},doSearch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Pe.search(e,{contentfilter:this.computedRating,media_filter:"tinygif",...t})},doTrendingSearch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Pe.trending({contentfilter:this.computedRating,media_filter:"tinygif",...e})},search:(0,be.D)(500,(async function(){if(!this.searchValue)return this.result=this.resultTrending||[],this.next=null,void this.$refs.grid?.scrollTop();try{this.error=!1;const e=this.searchValue,t=await this.doSearch(e);this.searchValue===e&&(this.$refs.grid?.scrollTop(),this.result=t.results,this.next=t.next)}catch(e){(0,y.Z)(w.s.Error,"search error",e),this.error=!0}})),onClear(){this.searchValue="",this.search()},onSelection(e){(0,y.Z)(w.s.Debug,"onSelection",e),this.$emit("selection",e)},async onLoadMore(){(0,y.Z)(w.s.Debug,"onLoadMore",this.searchValue,this.next,this.nextTrending);try{const e=!!this.searchValue;if(e&&this.next){this.$refs.grid?.markLoading();const e=await this.doSearch(this.searchValue,{pos:this.next});this.result=this.result.concat(e.results),this.next=e.next}else if(!e&&this.nextTrending){this.$refs.grid?.markLoading();const e=await this.doTrendingSearch({pos:this.nextTrending});this.result=this.result.concat(e.results),this.resultTrending=this.result.concat(e.results),this.nextTrending=e.next}}catch(e){(0,y.Z)(w.s.Error,"onLoadMore error",e),this.$refs.grid?.markLoadingError()}},onTryAgain(){this.searchValue?this.search():this.loadTrending()},reset(){this.searchValue="",this.result=this.resultTrending||[],this.next=null,this.$refs.grid?.scrollTop()}},components:{TenorPickerGrid:Oe,TenorLoadingErrorLine:Se}},Ze=Ie,Le=(s(3747),(0,I.Z)(Ze,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"tenor-picker-container"},[t("div",{staticClass:"input-bar-container"},[t("div",{staticClass:"input-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchValue,expression:"searchValue"}],attrs:{type:"text",placeholder:e.$lang.data.k119,disabled:!e.connected||e.loading},domProps:{value:e.searchValue},on:{input:[function(t){t.target.composing||(e.searchValue=t.target.value)},e.search]}}),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.searchValue,expression:"searchValue"}],attrs:{"data-clear-input":""},on:{click:function(t){return t.stopPropagation(),e.onClear.apply(null,arguments)}}},[e._v("Ã—")])])],1),e._v(" "),e._m(0)]),e._v(" "),t("div",{staticClass:"search-results",class:{mobile:e.store.isMobile}},[e.error?t("TenorLoadingErrorLine",{on:{tryAgain:e.onTryAgain}}):e.result?t("TenorPickerGrid",{ref:"grid",attrs:{data:e.result},on:{loadMore:e.onLoadMore,selection:e.onSelection}}):e._e()],1)])}),we,!1,null,null,null)),De=Le.exports,Re={name:"rich-content-picker",props:{gifRating:{type:String,default:"G"}},data(){return{show:null,emojiPickerInvisible:!1,EMOJI_PICKER:a.Z.EMOJI_PICKER,GIF_PICKER:a.Z.GIF_PICKER}},methods:{open(e){e===this.GIF_PICKER&&this.show===this.EMOJI_PICKER?this.emojiPickerInvisible=!0:this.emojiPickerInvisible=!1,this.show=e},close(e){e?(this.$refs.emojiPicker?.purgeCache(),this.emojiPickerInvisible=!1,this.$refs.tenorPicker?.reset()):this.show===this.EMOJI_PICKER&&(this.emojiPickerInvisible=!0),this.show=null},getOpenPicker(){return this.show},storeRecents(){this.$refs.emojiPicker?.storeRecents()},_onEmojiSelection(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.$emit("emoji-selection",...t)},_onGifSelection(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.$emit("gif-selection",...t)}},components:{EmojiPicker:Ce,TenorPicker:De}},He=Re,Ne=(s(7895),(0,I.Z)(He,(function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"rc-picker-container"}},[t("keep-alive",[e.show===e.EMOJI_PICKER||e.emojiPickerInvisible?t("emoji-picker",{ref:"emojiPicker",class:{invisible:e.emojiPickerInvisible},on:{selection:e._onEmojiSelection}}):e._e()],1),e._v(" "),t("keep-alive",[e.show===e.GIF_PICKER?t("tenor-picker",{ref:"tenorPicker",attrs:{rating:e.gifRating},on:{selection:e._onGifSelection}}):e._e()],1)],1)}),[],!1,null,null,null).exports);const Be=150;var Ue={methods:{setClip(e,t,s,i){return`rect(${e}px, ${t}px, ${s}px, ${i}px)`},setTransformStyle(e,t){let s=Math.floor(e/100*180);return"fix"===t?`rotate(${2*s}deg)`:`rotate(${s}deg)`},setTransitionStyle(e){return`transform ${e}s`},setPv(){["fix","rotate"].map((e=>{this[e+"Style"]={transform:this.setTransformStyle(this.pv,e)}}))}},props:["color","width","fontSize","pv","textColor","bold","textBgColor","borderColor","during","bgColor"],data(){let e=this.setTransformStyle(this.pv),t=(this.width,this.bold,this.setTransformStyle(this.pv,"fix")),s=this.setTransitionStyle(this.during||.3);return{circleStyle:{borderColor:this.borderColor||"#f7f7f7",borderStyle:"solid",borderWidth:"5px",width:(this.width||Be)+"px",height:(this.width||Be)+"px",backgroundColor:this.bgColor||"#f7f7f7"},progressTextStyle:{fontSize:(this.fontSize||64)+"px",color:this.textColor||"#f7f7f7"},fillStyle:{backgroundColor:this.color||"#2ecc71",width:(this.width||Be)+"px",height:(this.width||Be)+"px",clip:this.setClip(0,this.width/2,this.width,0)},rotateStyle:{transform:e,webkitTransform:e,msTransform:e,oTransform:e,mozTransform:e},transitionStyle:{transition:s,webkitTransition:s,mozTransition:s,oTransition:s,msTransition:s},maskStyle:{width:(this.width||Be)+"px",height:(this.width||Be)+"px",clip:this.setClip(0,this.width,this.width,this.width/2)},fixStyle:{transform:t,webkitTransform:t,mozTransform:t,oTransform:t,msTransform:t}}},watch:{pv(e,t){this.setPv()}}},Ve=(s(6875),(0,I.Z)(Ue,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"v-circle",style:e.circleStyle},[t("div",{staticClass:"mask full",style:[e.maskStyle,e.transitionStyle,e.rotateStyle]},[t("div",{staticClass:"fill",style:[e.fillStyle,e.transitionStyle,e.rotateStyle]})]),e._v(" "),t("div",{staticClass:"mask half",style:[e.maskStyle]},[t("div",{staticClass:"fill",style:[e.fillStyle,e.transitionStyle,e.rotateStyle]}),e._v(" "),t("div",{staticClass:"fill fix",style:[e.fillStyle,e.fixStyle,e.transitionStyle]})])])}),[],!1,null,null,null).exports);var je={props:["updatePeriod"],data(){return{enabled:!1,stepTime:this.updatePeriod||50,percentage:100,colorA:o.v.COLOR_A}},methods:{enable(e){const t=Date.now(),s=t+e;this.enabled=!0,function(e){let t=!0;!function s(){t&&(requestAnimationFrame(s),t=e())}()}((e=>{const i=Date.now();return i<s?(this.percentage=100-Math.round((i-t)/(s-t)*100),!0):(this.reset(),this.$emit("completion"),!1)}))},reset(){this.enabled=!1,this.percentage=100}},components:{StopCircle:Ve}},Ge=je,ze=(0,I.Z)(Ge,(function(){var e=this,t=e._self._c;return e.enabled?t("stop-circle",{attrs:{pv:e.percentage,width:"18",color:e.colorA}}):e._e()}),[],!1,null,null,null).exports,We={name:"user-identicon",props:{user:{type:Object,default:null}},data(){return{}},mounted(){this.generateIdenticon()},methods:{generateIdenticon(){this.$refs.identicon.innerHTML=jdenticon.toSvg(this.user.id,16)}}},Ke=(s(9953),(0,I.Z)(We,(function(){return(0,this._self._c)("span",{ref:"identicon",staticClass:"identicon-container",attrs:{title:this.$lang.data.k102}})}),[],!1,null,"2e81e75a",null).exports),qe=s(6606),Ye=s(344),Fe=s(9868),Je={data(){return{error:!1}},methods:{onError(){(0,y.Z)(w.s.Debug,"error catched"),this.error=!0}}},Xe=(0,I.Z)(Je,(function(){var e=this;return(0,e._self._c)("div",[e.error?e._t("error"):e._t("default",null,{error:e.onError})],2)}),[],!1,null,null,null).exports;var Qe={mixins:[m.Z],data(){return{store:i.Z,msg:null,outsideClickListener:e=>{const t=document.querySelector(".msg-options-menu");t&&!t.contains(e.target)&&this.$emit("clickOutside",this.msg)},escClickListener:e=>{if(27==(e.which||e.keyCode)){document.querySelector(".msg-options-menu")&&this.$emit("esc",this.msg)}},siteVerified:now4real._siteStatus>1}},computed:{messageEditDuration(){return 1e3*(this.store.PARAMETERS?.messageEditDuration||0)},messageDeleteDuration(){return 1e3*(this.store.PARAMETERS?.messageDeleteDuration||0)}},methods:{show(e,t){(0,y.Z)(w.s.Debug,"show",t.clientX,t.clientY),this.msg=e,this.msg.isHidden=!!this.store.hiddenUsers[e.author.id];const s=Date.now(),i=e.time;this.msg.isEditable=this.messageEditDuration&&s-i<=this.messageEditDuration,this.msg.isDeletable=this.messageDeleteDuration&&s-i<=this.messageDeleteDuration,this.$nextTick((e=>{const s=document.getElementById("head-wrapper"),i=document.querySelector(".msg-options-menu"),n=document.querySelector(".chat-container"),o=Math.min(n.clientWidth-i.clientWidth-10,t.clientX),a=Math.max(15,Math.min(n.clientHeight-i.clientHeight-15,t.clientY-s.clientHeight));i.style.left=`${o}px`,i.style.top=`${a}px`,i.style.visibility="visible",i.style.opacity="1"})),setTimeout((()=>{window.addEventListener("click",this.outsideClickListener),document.addEventListener("touchstart",this.outsideClickListener),document.addEventListener("keydown",this.escClickListener)}),0)},hide(){if((0,y.Z)(w.s.Debug,"hide"),this.msg){const e=document.querySelector(".msg-options-menu");e.style.visibility="hidden",e.style.opacity="0",this.$nextTick((e=>{this.msg=null}))}setTimeout((()=>{window.removeEventListener("click",this.outsideClickListener),document.removeEventListener("touchstart",this.outsideClickListener),document.removeEventListener("keydown",this.escClickListener)}),0)},hideMsg(){this.$emit("hideMsg",this.msg)},showMsg(){this.$emit("showMsg",this.msg)},reportMsg(){this.$emit("reportMsg",this.msg)},deleteMsg(){this.$emit("deleteMsg",this.msg)},editMsg(){this.$emit("editMsg",this.msg)},replyToMsg(){this.$emit("replyToMsg",this.msg)},muteUser(){this.$emit("muteUser",this.msg)}}},et=(s(7962),(0,I.Z)(Qe,(function(){var e=this,t=e._self._c;return e.msg?t("div",[t("div",{staticClass:"msg-options-menu-mask"}),e._v(" "),t("div",{staticClass:"msg-options-menu-wrapper"},[t("div",{staticClass:"msg-options-menu"},[t("ul",[e.msg.deleted?e._e():t("li",{staticClass:"focus-el",attrs:{tabindex:"13"}},[t("button",{staticClass:"focus-cont",attrs:{title:e.$lang.data.k95,tabindex:"-1"},on:{click:e.replyToMsg}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z",fill:"currentColor"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k95))])])]),e._v(" "),!e.msg.deleted&&e.msg.isMine&&!e.msg.isGif&&e.msg.isEditable?t("li",{staticClass:"focus-el",attrs:{tabindex:"14"}},[t("button",{staticClass:"focus-cont",attrs:{title:"Edit",tabindex:"-1"},on:{click:e.editMsg}},[t("svg",{attrs:{viewBox:"0 0 24 24",width:"24",height:"24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k101))])])]):e._e(),e._v(" "),!e.msg.deleted&&e.msg.isMine&&e.msg.isDeletable?t("li",{staticClass:"focus-el",attrs:{tabindex:"15"}},[t("button",{staticClass:"focus-cont",attrs:{title:e.$lang.data.k96,tabindex:"-1"},on:{click:e.deleteMsg}},[t("svg",{attrs:{viewBox:"0 0 24 24",width:"24",height:"24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 002 2h8a2 2 0 002-2V7H6v12z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k96))])])]):e._e(),e._v(" "),e.msg.isMine||e.moderator?e._e():t("li",{staticClass:"focus-el",attrs:{tabindex:"16"}},[e.msg.isHidden?t("button",{staticClass:"focus-cont",attrs:{title:e.$lang.data.k100,tabindex:"-1"},on:{click:e.showMsg}},[t("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M12 9a3 3 0 00-3 3 3 3 0 003 3 3 3 0 003-3 3 3 0 00-3-3m0 8a5 5 0 01-5-5 5 5 0 015-5 5 5 0 015 5 5 5 0 01-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k100))])]):t("button",{staticClass:"focus-cont",attrs:{title:e.$lang.data.k99,tabindex:"-1"},on:{click:e.hideMsg}},[t("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M11.83 9L15 12.16V12a3 3 0 00-3-3h-.17m-4.3.8l1.55 1.55c-.05.21-.08.42-.08.65a3 3 0 003 3c.22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53a5 5 0 01-5-5c0-.79.2-1.53.53-2.2M2 4.27l2.28 2.28.45.45C3.08 8.3 1.78 10 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.43.42L19.73 22 21 20.73 3.27 3M12 7a5 5 0 015 5c0 .64-.13 1.26-.36 1.82l2.93 2.93c1.5-1.25 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-4 .7l2.17 2.15C10.74 7.13 11.35 7 12 7z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k99))])])]),e._v(" "),!e.msg.isMine&&"BY_AI"!==e.msg.deleted&&e.siteVerified?t("li",{staticClass:"focus-el",attrs:{tabindex:"17"}},[t("button",{staticClass:"focus-cont",attrs:{title:e.$lang.data.k98,tabindex:"-1"},on:{click:e.reportMsg}},[t("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2 1 21z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k98))])])]):e._e(),e._v(" "),e.msg.deleted||!e.moderator||e.msg.isMine&&e.msg.isDeletable?e._e():t("li",{staticClass:"focus-el",attrs:{tabindex:"18"}},[t("button",{staticClass:"focus-cont highlighted",attrs:{title:e.$lang.data.k96,tabindex:"-1"},on:{click:e.deleteMsg}},[t("svg",{attrs:{viewBox:"0 0 24 24",width:"24",height:"24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 002 2h8a2 2 0 002-2V7H6v12z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k96))])])]),e._v(" "),e.moderator&&!e.msg.isMine?t("li",{staticClass:"focus-el",attrs:{tabindex:"19"}},[t("button",{staticClass:"focus-cont highlighted",attrs:{title:e.$lang.data.k97,tabindex:"-1"},on:{click:e.muteUser}},[t("svg",{attrs:{viewBox:"0 0 24 24",width:"24",height:"24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M10 4a4 4 0 00-4 4 4 4 0 004 4 4 4 0 004-4 4 4 0 00-4-4m7.5 9C15 13 13 15 13 17.5s2 4.5 4.5 4.5 4.5-2 4.5-4.5-2-4.5-4.5-4.5M10 14c-4.42 0-8 1.79-8 4v2h9.5a6.5 6.5 0 01-.5-2.5 6.5 6.5 0 01.95-3.36c-.63-.08-1.27-.14-1.95-.14m7.5.5c1.66 0 3 1.34 3 3 0 .56-.15 1.08-.42 1.5L16 14.92c.42-.27.94-.42 1.5-.42M14.92 16L19 20.08c-.42.27-.94.42-1.5.42-1.66 0-3-1.34-3-3 0-.56.15-1.08.42-1.5z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k97))])])]):e._e()])])])]):e._e()}),[],!1,null,null,null).exports),tt=s(3169),st={data(){return{animate:!0}}},it=(s(6388),(0,I.Z)(st,(function(){var e=this,t=e._self._c;return t("svg",{ref:"animatedSvg",class:{animate:e.animate},staticStyle:{width:"24px",height:"24px"},attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}},[t("rect",{staticClass:"bar1",attrs:{x:"3",y:"8",width:"4",height:"16"}}),e._v(" "),t("rect",{staticClass:"bar2",attrs:{x:"10",y:"2",width:"4",height:"22"}}),e._v(" "),t("rect",{staticClass:"bar3",attrs:{x:"17",y:"18",width:"4",height:"6"}})])}),[],!1,null,null,null).exports);const nt=(0,h.gH)((0,h.xr)(o.v.COLOR_A),.78),ot=(0,h.gH)((0,h.xr)(o.v.COLOR_A),-.78);var at={mixins:[m.Z,tt.Z,f],data(){return{store:i.Z,submitted:!1,openState:!1,seeResultsMode:!1,viewOnlyMode:!1,poll:null,pollID:null,voted:null,answers:[],answerPicked:null,pollQuestion:null,loginUnwatcher:null,logoutUnwatcher:null,signInLnk:null,signInBtn:null,CHECK_DELAY:1e3}},computed:{votes(){const e=this.poll?.votesCount;return`${e} ${this.$lang.data[""+("1"===e?"k178":"k178s")]}`},seeResultsActive(){return(this.moderator||this.guest)&&!this.voted&&!this.seeResultsMode&&!this.viewOnlyMode&&this.store.pollState===this.pollState.Open},hidden(){const e=this.store.PARAMETERS?.chatStatus;return e===a.Z.DISABLED_BY_ADMIN||e===a.Z.DISABLED_BY_MODERATOR},pollPreviewStyle(){const e=this.store.pollState===this.pollState.Open;return{backgroundColor:e?ot:nt,color:e?nt:ot}},pollIconColor(){return this.store.pollState===this.pollState.Open?ot:nt},pollIconBgColor(){return this.store.pollState===this.pollState.Open?nt:ot},pollIconWrapperStyle(){return{backgroundColor:this.pollIconBgColor,fill:this.pollIconColor}}},created(){this.subscribe(),this.handleSignIn()},methods:{open(){this.openState||(this.openState=!0,this.subscribePollDetails())},close(){this.openState&&(this.openState=!1,this.seeResultsMode=!1,this.poll&&!this.poll.closed&&!this.voted&&this.answers.some((e=>!!e))&&this.updateAnswers(Array(this.poll.answers.length).fill(!1)),this.unsubscribePollDetails(),this.loginUnwatcher?.(),this.loginUnwatcher=null)},subscribe(){setTimeout((e=>{const t=now4real.Subject.POLL_STATUS;now4real.subscribe(t,(e=>{(0,y.Z)(w.s.Debug,`${t} upd`,e);const s=e.data;s?(this.store.pollState=s.closed?this.pollState.Closed:this.pollState.Open,this.pollQuestion=s.question):(this.store.pollState=this.pollState.Empty,this.pollQuestion=null)})).then((e=>{this.store.pollState=this.pollState.Empty}))}),this.CHECK_DELAY)},handleSignIn(){const e=(e,t)=>t?this.$lang.complete(e,{"<a>":`<a href="${t}" target="_parent">`}):this.$lang.complete(e,{"<a>":"","</a>":""}),t=now4real.config.custom_auth;if(t.enabled){const s=this.authenticated&&!o.v.CHAT_POST;this.viewOnlyMode=s,s||(this.signInLnk=e("k181",t.signin_url))}else this.signInBtn=e("k181")},handlePollVote(){if(null===this.voted){const e=e=>{(0,y.Z)(w.s.Debug,"pollVoteFetcher",e),now4real.getPollVote().then((e=>{let{vote:t}=e;this.store.pollState!==this.pollState.Empty&&(this.voted=t.length>0,this.updateAnswers(this.poll.answers.map(((e,s)=>t.includes(s)))),this.logoutUnwatcher=this.$watch("authenticated",(e=>{e||(this.resetVotes(),this.seeResultsMode=!1,this.logoutUnwatcher?.(),this.logoutUnwatcher=null)})),this.voted||this.$nextTick((e=>{document.querySelector("#poll-answers li:first-child .focus-cont")?.focus()})))})).catch((e=>{(0,y.Z)(w.s.Error,"getPollVote error",e)}))};this.authenticated?e(!1):this.loginUnwatcher||(this.loginUnwatcher=this.$watch("authenticated",(t=>{t&&(e(!0),this.loginUnwatcher?.(),this.loginUnwatcher=null)})))}},resetVotes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,y.Z)(w.s.Debug,"resetVotes",e),this.voted=null,this.answerPicked=null,this.updateAnswers(e)},onSignin(){this.submitted=!0,now4real.login().then((e=>{this.submitted=!1})).catch((e=>{(0,y.Z)(w.s.Error,"login error",e);const t=e.code;if(t===now4real.ErrorCode.ALREADY_STARTED)return;const s=this.$lang.data[t===now4real.ErrorCode.ABORTED?"k84":"k1"];this.$toast(s,{parent:".chat-container",id:"login-error",className:"toast-alert"}),this.submitted=!1}))},onAnswerClick(e){if((0,y.Z)(w.s.Debug,"onAnswerClick",e,this.answers),!this.submitted)if(this.poll.multipleChoice){const t=this.answers;t[e]?t.splice(e,1,!1):t.splice(e,1,!0)}else{const t=Array.from({length:this.answers.length},((t,s)=>s===e&&!this.answers[e]));this.updateAnswers(t),this.answerPicked=this.poll.answers[e].text,this.onSendVote()}},onRevokeVote(){(0,y.Z)(w.s.Debug,"onRevokeVote"),this.sendVote([]).then((e=>{this.voted=!1,this.updateAnswers(Array(this.poll.answers.length).fill(!1)),this.answerPicked=null,this.$nextTick((e=>{document.querySelector("#poll-answers li:first-child .focus-cont")?.focus()}))}))},onSendVote(){(0,y.Z)(w.s.Debug,"onSendVote",this.answers);const e=this.answers.reduce(((e,t,s)=>(t&&e.push(s),e)),[]);this.sendVote(e).then((e=>{this.voted=!0}))},sendVote(e){return this.submitted=!0,now4real.sendVote(e).then((e=>{this.submitted=!1})).catch((e=>{throw(0,y.Z)(w.s.Error,"sendVote error",e),this.$toast(this.$lang.data.k1,{parent:".chat-container",id:"send-vote-error",className:"toast-alert"}),this.submitted=!1,e}))},onSeeResults(){this.seeResultsActive&&(this.updateAnswers(Array(this.answers.length).fill(!1)),this.seeResultsMode=!0)},updateAnswers(e){this.answers.splice(0,this.answers.length,...e)},subscribePollDetails(){const e=now4real.Subject.POLL;now4real.subscribe(e,(t=>{(0,y.Z)(w.s.Debug,`${e} upd`,t);const s=t.data;s?(this.poll=this.decoratePoll(s),(!this.pollID||!s.closed&&s.startDate!==this.pollID||s.closed&&!this.voted&&(this.answers.some((e=>!!e))||this.seeResultsMode))&&(this.resetVotes(Array(s.answers.length).fill(!1)),this.seeResultsMode=!1,this.pollID=s.startDate),this.handlePollVote()):(this.close(),this.logoutUnwatcher?.(),this.logoutUnwatcher=null)}))},decoratePoll(e){if(e){const t=Math.max(...e.answers.map((e=>e.percentage))),s=e.answers.map((e=>({...e,normalizedPercentage:t>0?e.percentage/t*100:0})));e.answers=s}return e},unsubscribePollDetails(){this.poll=null,now4real.unsubscribe(now4real.Subject.POLL)}},components:{Modal:D.Z,Button:R.Z,Spinner:j.Z,PollIcon:it}},rt=at,lt=(s(2099),(0,I.Z)(rt,(function(){var e=this,t=e._self._c;return e.store.pollState!==e.pollState.Empty&&e.store.pollState!==e.pollState.Checking?t("div",{class:{hidden:e.hidden},attrs:{id:"poll-container"}},[t("transition",{attrs:{name:"fade",appear:""}},[t("div",{style:e.pollPreviewStyle,attrs:{id:"poll-preview",title:e.$lang.data[e.store.pollState===e.pollState.Open?"k176":"k176Closed"]},on:{click:e.open}},[t("div",{staticClass:"icon-wrapper",style:e.pollIconWrapperStyle},[t("PollIcon")],1),e._v(" "),t("div",{staticClass:"question",attrs:{title:e.pollQuestion}},[e._v(e._s(e.pollQuestion))]),e._v(" "),t("Button",{key:e.store.pollState,attrs:{"button-class":"btn-open-poll","bg-color":e.pollIconBgColor,color:e.pollIconColor},on:{click:e.open,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.open.apply(null,arguments)}}},[e._v(e._s(e.$lang.data[e.store.pollState===e.pollState.Open?"k182":"k184"]))])],1)]),e._v(" "),e.openState?t("modal",{attrs:{id:"poll-modal"},on:{close:e.close}},[t("template",{slot:"title"},[e._v("\n            "+e._s(e.$lang.data.k176)+"\n        ")]),e._v(" "),e.poll?t("template",{slot:"header"},[t("p",{staticClass:"question",attrs:{title:e.poll.question}},[e._v(e._s(e.poll.question))])]):e._e(),e._v(" "),t("template",{slot:"body"},[e.poll?t("div",[!e.authenticated||e.voted||e.store.pollState!==e.pollState.Open||e.seeResultsMode||e.viewOnlyMode||e.poll.multipleChoice?!e.authenticated||e.voted||e.store.pollState!==e.pollState.Open||e.seeResultsMode||e.viewOnlyMode||!e.poll.multipleChoice?e.authenticated||e.store.pollState===e.pollState.Closed?t("div",[t("ul",{attrs:{id:"results"}},e._l(e.poll.answers,(function(s,i){return t("li",{key:s.text},[t("div",{staticClass:"left"},[t("span",{staticClass:"percentage"},[e._v(e._s(s.percentage)+"%")]),e._v(" "),e.answers[i]?t("svg",{class:"check",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}})]):e._e()]),e._v(" "),t("div",{staticClass:"right"},[t("div",{staticClass:"text",attrs:{title:s.text}},[e._v(e._s(s.text))]),e._v(" "),t("span",{staticClass:"bar",style:{width:s.normalizedPercentage+"%"}})])])})),0)]):e._e():t("div",[t("ul",{attrs:{id:"poll-answers"}},e._l(e.poll.answers,(function(s,i){return t("li",{key:s.text,staticClass:"focus-el",attrs:{tabindex:13+i},on:{click:function(t){return e.onAnswerClick(i)},keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onAnswerClick(i)}}},[t("div",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("input",{staticClass:"check",attrs:{type:"checkbox",name:e.poll.answer,disabled:e.submitted,tabindex:"-1"},domProps:{checked:e.answers[i]}}),e._v(" "),t("div",{staticClass:"text",attrs:{title:s.text,tabindex:"-1"}},[e._v(e._s(s.text))])])])})),0),e._v(" "),t("Button",{attrs:{disabled:!e.answers.includes(!0)||e.submitted,submitted:e.submitted,tabindex:"23"},on:{click:e.onSendVote,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSendVote.apply(null,arguments)}}},[e._v(e._s(e.$lang.data.k182))])],1):t("div",[t("ul",{attrs:{id:"poll-answers"}},e._l(e.poll.answers,(function(s,i){return t("li",{key:s.text,staticClass:"focus-el",attrs:{tabindex:13+i},on:{click:function(t){return e.onAnswerClick(i)},keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onAnswerClick(i)}}},[t("div",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.answerPicked,expression:"answerPicked"}],staticClass:"radio",attrs:{type:"radio",name:e.poll.question,disabled:e.submitted,tabindex:"-1"},domProps:{value:s.text,checked:e._q(e.answerPicked,s.text)},on:{change:function(t){e.answerPicked=s.text}}}),e._v(" "),t("div",{staticClass:"text",attrs:{title:s.text,tabindex:"-1"}},[e._v(e._s(s.text))])])])})),0)])]):t("Spinner")],1),e._v(" "),e.poll?t("template",{slot:"footer"},[e.authenticated||e.store.pollState!==e.pollState.Open?e.voted&&e.store.pollState===e.pollState.Open&&e.authenticated&&!e.viewOnlyMode?t("Button",{attrs:{disabled:e.submitted,submitted:e.submitted,tabindex:"24"},on:{click:e.onRevokeVote,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onRevokeVote.apply(null,arguments)}}},[e._v(e._s(e.$lang.data.k183))]):e.voted||e.store.pollState!==e.pollState.Open||!e.seeResultsMode||e.viewOnlyMode?e.store.pollState===e.pollState.Closed?t("p",{attrs:{id:"final-results"}},[e._v(e._s(e.$lang.data.k180))]):e._e():t("Button",{attrs:{disabled:e.submitted,tabindex:"24"},on:{click:function(t){e.seeResultsMode=!1},keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.seeResultsMode=!1}}},[e._v(e._s(e.$lang.data.k182))]):t("div",{attrs:{id:"signin-to-vote"}},[e.signInLnk?t("div",{domProps:{innerHTML:e._s(e.signInLnk)}}):e.signInBtn?t("Button",{attrs:{tabindex:"24"},on:{click:e.onSignin,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSignin.apply(null,arguments)}}},[e._v(e._s(e.signInBtn))]):e._e()],1),e._v(" "),e.moderator||e.guest||e.seeResultsMode||e.voted||e.store.pollState===e.pollState.Closed?t("p",{class:{underlined:e.seeResultsActive},attrs:{id:"votes-stats"},on:{click:e.onSeeResults}},[t("span",[e._v(e._s(e.votes))]),e._v(" "),t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M3 22V8.814h3.942V22H3m6.898 0V3.162h3.942V22H9.898m6.898 0v-6.187l3.942.017V22z"}})])]):e._e()],1):e._e()],2):e._e()],1):e._e()}),[],!1,null,null,null)),ct=lt.exports,dt={name:"MessageBubble",mixins:[m.Z],components:{Gif:Fe.Z,Fallback:Xe},props:{message:{type:Object,required:!0},completeBubble:{type:Boolean,required:!0},highlighted:{type:Boolean,default:!1},forceMobile:{type:Boolean,default:!1},viewOnly:{type:Boolean,default:!1},signInRequired:{type:Boolean,default:!1},customAuth:{type:Object,default:()=>({enabled:!1})},maxLines:{type:Number,default:10},observer:{default:null}},data(){return{store:i.Z,isExpanded:!1,lineCount:0,isCitedMessageClickable:!1}},computed:{hiddenUsers(){return this.store.hiddenUsers||{}},truncatedStyle(){return{display:"-webkit-box","-webkit-line-clamp":this.maxLines,"-webkit-box-orient":"vertical",overflow:"hidden"}},showTimeDisplay(){return!this.hiddenUsers[this.message.author.id]}},watch:{observer(e,t){t&&(t.unobserve(this.$el),(0,y.Z)(w.s.Debug,"Stopped observing with previous observer",this.message.id)),e&&(e.observe(this.$el),(0,y.Z)(w.s.Debug,"Started observing with new observer",this.message.id))},"message.formattedContent":function(){this.$nextTick((()=>{this.checkMessageHeight(),(0,y.Z)(w.s.Debug,"Recalculated message height after formatted content change",this.message.id)}))}},mounted(){this.$nextTick((()=>{this.checkMessageHeight()})),this.observer&&(this.observer.observe(this.$el),(0,y.Z)(w.s.Debug,"Observing message element",this.message.id))},beforeDestroy(){this.observer&&(this.observer.unobserve(this.$el),(0,y.Z)(w.s.Debug,"Stopped observing message element",this.message.id))},methods:{checkMessageHeight(){const e=this.$refs.messageContent;if(e&&!this.message.isGif&&!this.message.deleted){const t=parseInt(window.getComputedStyle(e).lineHeight),s=e.scrollHeight;this.lineCount=Math.floor(s/t),this.lineCount<=this.maxLines&&this.isExpanded&&(this.isExpanded=!1),(0,y.Z)(w.s.Debug,"Message line count:",this.lineCount,"for message:",this.message.id)}},shouldTruncate(e){return!this.isExpanded&&this.shouldShowReadMoreButton(e)},shouldShowReadMoreButton(e){return!(e.isGif||e.deleted||this.hiddenUsers[e.author.id]||"CHATBOT"===e.author.provider)&&this.lineCount>this.maxLines},toggleExpand(){this.isExpanded=!this.isExpanded},onMessageClick(e){(0,y.Z)(w.s.Debug,"messageBubbleClick",e.clientX,e.clientY),!this.store.isMobile&&!this.forceMobile||this.viewOnly||this.message.deleted&&this.message.isMine||this.customAuth.enabled&&this.signInRequired||this.showMsgOptions(e)},showMsgOptions(e){(0,y.Z)(w.s.Debug,"showMsgOptions",e.clientX,e.clientY),this.$emit("show-msg-options",this.message,e)},onNavigate(e){this.$emit("navigate",e)},onCitedMsgHover(e,t){this.isCitedMessageClickable=!!document.getElementById(t.id)},onCitedMsgBlur(e){this.isCitedMessageClickable=!1},onGifReady(){this.$emit("gif-ready")}}},ht=(s(9951),(0,I.Z)(dt,(function(){var e=this,t=e._self._c;return t("div",{class:{"message-bubble":e.completeBubble,"left-message-bubble":e.completeBubble&&!e.message.isMine,"right-message-bubble":e.completeBubble&&e.message.isMine,"message-old-bubble":!e.completeBubble,"left-message-old-bubble":!e.completeBubble&&!e.message.isMine,"right-message-old-bubble":!e.completeBubble&&e.message.isMine,highlight:e.highlighted,expanded:e.isExpanded},style:e.message.bubbleStyle,attrs:{id:e.message.id,"data-ec":e.message.emojisCount},on:{click:function(t){return t.stopPropagation(),e.onMessageClick.apply(null,arguments)}}},[!e.message.repliesTo||!e.moderator&&e.hiddenUsers[e.message.author.id]?e._e():t("div",{key:"1",staticClass:"cited-message",class:{gif:e.message.isGif,"navigable-citation":e.isCitedMessageClickable},style:e.message.citedMessageStyle,on:{click:function(t){return t.stopPropagation(),e.onNavigate(e.message.repliesTo.id)},mouseover:function(t){return e.onCitedMsgHover(t,e.message.repliesTo)},mouseleave:function(t){return e.onCitedMsgBlur(t)}}},[!e.moderator&&e.hiddenUsers[e.message.repliesTo.author.id]?t("div",{staticClass:"message-bubble-content-hidden"},[t("svg",{attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M2 5.27L3.28 4 20 20.72 18.73 22l-3.08-3.08c-1.15.38-2.37.58-3.65.58-5 0-9.27-3.11-11-7.5.69-1.76 1.79-3.31 3.19-4.54L2 5.27M12 9a3 3 0 013 3 3 3 0 01-.17 1L11 9.17A3 3 0 0112 9m0-4.5c5 0 9.27 3.11 11 7.5a11.79 11.79 0 01-4 5.19l-1.42-1.43A9.862 9.862 0 0020.82 12 9.821 9.821 0 0012 6.5c-1.09 0-2.16.18-3.16.5L7.3 5.47c1.44-.62 3.03-.97 4.7-.97M3.18 12A9.821 9.821 0 0012 17.5c.69 0 1.37-.07 2-.21L11.72 15A3.064 3.064 0 019 12.28L5.6 8.87c-.99.85-1.82 1.91-2.42 3.13z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k79))])]):e.message.repliesToGif?[t("div",{staticClass:"cited-gif-wrapper"},[t("div",{staticClass:"left-col"},[t("div",{staticClass:"name"},[e._v(e._s(e.message.repliesTo.author.name))]),e._v(" "),t("div",{staticClass:"type"},[e._v("GIF")])]),e._v(" "),t("Gif",{staticClass:"gif-content",attrs:{url:e.message.repliesTo.message,width:40,thumbnail:"","accent-color":e.message.citedMessageStyle.color}})],1)]:e.message.repliesTo.deleted?[t("div",{staticClass:"name"},[e._v(e._s(e.message.repliesTo.author.name))]),e._v(" "),t("div",{staticClass:"content-moderated",style:e.message.citedMessageContentStyle},[t("svg",{attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M12 2c5.5 0 10 4.5 10 10s-4.5 10-10 10S2 17.5 2 12 6.5 2 12 2m0 2c-1.9 0-3.6.6-4.9 1.7l11.2 11.2c1-1.4 1.7-3.1 1.7-4.9 0-4.4-3.6-8-8-8m4.9 14.3L5.7 7.1C4.6 8.4 4 10.1 4 12c0 4.4 3.6 8 8 8 1.9 0 3.6-.6 4.9-1.7z"}})]),e._v(" "),t("span",[e._v(e._s(e.message.formattedContentReply))])])]:[t("div",{staticClass:"name"},[e._v(e._s(e.message.repliesTo.author.name))]),e._v(" "),t("div",{staticClass:"content",style:e.message.citedMessageContentStyle,domProps:{innerHTML:e._s(e.message.formattedContentReply)}})]],2),e._v(" "),!e.moderator&&e.hiddenUsers[e.message.author.id]?t("div",{staticClass:"message-bubble-content-hidden"},[t("svg",{attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M2 5.27L3.28 4 20 20.72 18.73 22l-3.08-3.08c-1.15.38-2.37.58-3.65.58-5 0-9.27-3.11-11-7.5.69-1.76 1.79-3.31 3.19-4.54L2 5.27M12 9a3 3 0 013 3 3 3 0 01-.17 1L11 9.17A3 3 0 0112 9m0-4.5c5 0 9.27 3.11 11 7.5a11.79 11.79 0 01-4 5.19l-1.42-1.43A9.862 9.862 0 0020.82 12 9.821 9.821 0 0012 6.5c-1.09 0-2.16.18-3.16.5L7.3 5.47c1.44-.62 3.03-.97 4.7-.97M3.18 12A9.821 9.821 0 0012 17.5c.69 0 1.37-.07 2-.21L11.72 15A3.064 3.064 0 019 12.28L5.6 8.87c-.99.85-1.82 1.91-2.42 3.13z"}})]),e._v(" "),t("span",[e._v(e._s(e.$lang.data.k79))])]):e.message.isGif?t("Fallback",{scopedSlots:e._u([{key:"default",fn:function(s){return[t("Gif",{staticClass:"gif-content",attrs:{width:175,url:e.message.message,"accent-color":e.message.bubbleStyle.color},on:{"~ready":function(t){return e.onGifReady.apply(null,arguments)},"~error":function(e){return s.error.apply(null,arguments)}}})]}}])},[e._v(" "),t("template",{slot:"error"},[t("div",{staticClass:"message-bubble-content",domProps:{innerHTML:e._s(e.message.formattedContent)}})])],2):e.message.deleted?t("div",{staticClass:"message-bubble-content-moderated"},[t("svg",{attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{fill:"currentColor",d:"M12 2c5.5 0 10 4.5 10 10s-4.5 10-10 10S2 17.5 2 12 6.5 2 12 2m0 2c-1.9 0-3.6.6-4.9 1.7l11.2 11.2c1-1.4 1.7-3.1 1.7-4.9 0-4.4-3.6-8-8-8m4.9 14.3L5.7 7.1C4.6 8.4 4 10.1 4 12c0 4.4 3.6 8 8 8 1.9 0 3.6-.6 4.9-1.7z"}})]),e._v(" "),t("span",[e._v(e._s(e.message.formattedContent))])]):t("div",{ref:"messageContent",staticClass:"message-bubble-content",class:{truncated:e.shouldTruncate(e.message)},style:e.shouldTruncate(e.message)?e.truncatedStyle:{},domProps:{innerHTML:e._s(e.message.formattedContent)}}),e._v(" "),e.showTimeDisplay&&!e.shouldShowReadMoreButton(e.message)?t("div",{staticClass:"message-time-display"},[e.message.edited?t("span",{staticClass:"edited-text"},[e._v(e._s(e.$lang.data.k78))]):e._e(),e._v(" "),t("span",[e._v(e._s(e.message.formattedTime))])]):e._e(),e._v(" "),e.shouldShowReadMoreButton(e.message)?t("div",{staticClass:"read-more-container"},[t("button",{staticClass:"read-more-btn",on:{click:function(t){return t.stopPropagation(),e.toggleExpand.apply(null,arguments)}}},[t("span",{staticClass:"arrow-icon"},[t("svg",{class:{"rotate-180":e.isExpanded},attrs:{width:"24",height:"24",viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M7.41 8.58L12 13.17l4.59-4.59L18 10l-6 6-6-6 1.41-1.42z"}})])]),e._v(" "),t("span",{staticClass:"read-more-text",attrs:{title:e.isExpanded?e.$lang.data.k104:e.$lang.data.k103}},[e._v("\n                "+e._s(e.isExpanded?e.$lang.data.k104:e.$lang.data.k103)+"\n            ")])]),e._v(" "),e.showTimeDisplay?t("div",{staticClass:"inline-time-display"},[e.message.edited?t("span",{staticClass:"edited-text"},[e._v(e._s(e.$lang.data.k78))]):e._e(),e._v(" "),t("span",[e._v(e._s(e.message.formattedTime))])]):e._e()]):e._e(),e._v(" "),e.forceMobile||e.viewOnly||e.message.deleted&&e.message.isMine||e.customAuth.enabled&&e.signInRequired?e._e():t("div",{staticClass:"message-options",class:{"message-options-right":!e.message.isMine,"message-options-left":e.message.isMine}},[t("button",{staticClass:"btn hoverable-btn",on:{click:e.showMsgOptions}},[t("span",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24px",height:"24px"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}})])])])])],1)}),[],!1,null,"45c6d030",null)),ut=ht.exports,gt={data(){return{colorA:o.v.COLOR_A}}},pt=(0,I.Z)(gt,(function(){var e=this,t=e._self._c;return t("svg",{staticStyle:{isolation:"isolate"},attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 450 450",width:"450",height:"450"}},[t("defs",[t("clipPath",{attrs:{id:"_clipPath_wo9ClZIGKjHvHpVMXeCqii6GB6BHOKIR"}},[t("rect",{attrs:{width:"450",height:"450"}})])]),e._v(" "),t("g",{attrs:{"clip-path":"url(#_clipPath_wo9ClZIGKjHvHpVMXeCqii6GB6BHOKIR)"}},[t("clipPath",{attrs:{id:"_clipPath_ROWIwt9bTcbUGIcktdoM7G3y0nanDy8l"}},[t("path",{attrs:{d:" M 0 0 L 500 0 L 500 500 L 0 500 L 0 0 Z ",fill:"rgb(255,255,255)"}})]),e._v(" "),t("g",{attrs:{"clip-path":"url(#_clipPath_ROWIwt9bTcbUGIcktdoM7G3y0nanDy8l)"}},[t("mask",{attrs:{id:"_mask_6cNs4d9rpLSg2Sqd2I6ULySrZRJw4iNx"}},[t("circle",{attrs:{"vector-effect":"non-scaling-stroke",cx:"225.0224807792666",cy:"225.011700383065",r:"224.99999999999997",fill:"white",stroke:"none"}})]),e._v(" "),t("g",{attrs:{mask:"url(#_mask_6cNs4d9rpLSg2Sqd2I6ULySrZRJw4iNx)"}},[t("path",{attrs:{d:" M 124.8 448.3 L 35 472 L 44.5 385.8 Q -12.2 310.5 -12.2 236 C -12.2 105.2 93.6 -1 224 -1 C 354.4 -1 460.2 105.2 460.2 236 C 460.2 366.8 354.4 473 224 473 Q 194.8 473 124.8 448.3 Z ",fill:e.colorA}}),e._v(" "),t("path",{attrs:{d:" M 109.6 97.5 C 102.5 98.9 94.8 99.9 87.7 99.9 C 80 99.9 72.9 99.4 65.7 97.5 C 67.2 102.3 70 106.1 73.8 109 C 81.8 115.2 93 115.2 101 109 C 105.2 106.3 108.2 102.2 109.6 97.5 Z  M 213.1 60.7 C 203.1 63 193.1 64 183.1 64 C 173.1 64 163.1 63 153 60.7 C 154.9 66.9 159.2 72.6 164.5 76.4 C 175.5 84.6 190.7 84.6 202.2 76.4 C 207.4 72.6 211.2 66.9 213.1 60.7 Z  M 300 78.4 C 282 82.2 263.5 82.2 245.6 78.4 C 247.5 84.1 250.8 88.9 255.6 92.7 C 265.6 100.4 279.5 100.4 289.5 92.7 C 294.7 88.9 298.1 84.1 300 78.4 Z  M 380.6 100.4 C 365.3 103.7 349.6 103.7 334.8 100.4 C 336.2 105.2 339.6 109.5 343.4 112.3 C 351.9 118.6 363.5 118.6 372 112.3 C 375.8 109.5 378.7 105.2 380.6 100.4 L 380.6 100.4 Z  M 452.2 236.3 C 452.2 362.2 350.5 464.1 225.1 464.1 C 188.8 464.1 154.5 455.5 124.4 440.2 L 116.3 443 C 86.7 453.6 61.9 459.8 45.7 461.7 C 55.2 438.2 57.6 412.4 52.4 387.5 L 51.4 382.3 C 18 342.5 -2 291.8 -2 236.3 C -2 211.7 2 187.3 9.9 164 L 47.1 164 C 52.4 144.9 68.6 131 87.7 131 C 103.4 131 117.3 140.6 124.4 154.5 C 129.7 124.8 153.5 102.3 181.7 102.3 C 204.1 102.3 223.6 116.2 233.2 136.7 C 242.7 124.8 257 117.1 272.8 117.1 C 295.2 117.1 314.3 132.4 321.9 154 C 330 142 342.9 134.4 357.7 134.4 C 375.8 134.4 391.6 146.3 398.7 164 L 440.7 164 C 447.9 186.5 452.2 210.9 452.2 236.3 Z  M 389.7 92.7 C 389.7 110.4 375.4 124.8 357.7 124.8 C 340 124.8 325.7 110.4 325.7 92.7 C 325.7 84.2 329.1 76.1 335.1 70 C 341.1 64 349.2 60.7 357.7 60.7 C 375.3 60.2 389.7 75 389.7 92.7 Z  M 310.5 69.3 C 310.5 79.3 306.6 89 299.5 96.1 C 292.4 103.2 282.8 107.1 272.8 107.1 C 262.8 107.1 253.1 103.2 246.1 96.1 C 239 89 235 79.3 235.1 69.3 C 235.1 48.4 252 31.5 272.8 31.5 C 293.6 31.5 310.4 48.4 310.5 69.3 Z  M 225.1 50.6 C 225.1 61.8 220.7 72.5 212.8 80.5 C 205 88.4 194.2 92.8 183.1 92.7 C 171.931 92.803 161.19 88.406 153.3 80.5 C 145.5 72.5 141 61.8 141.1 50.6 C 141 39.4 145.5 28.7 153.3 20.8 C 161.154 12.827 171.909 8.388 183.1 8.5 C 206.5 8.5 225.1 27.6 225.1 50.6 L 225.1 50.6 Z  M 118.2 90.3 C 118.2 107.1 104.4 121 87.7 121 C 71 121 57.1 107.1 57.1 90.3 C 57.1 73.6 71 59.7 87.7 59.7 C 104.4 59.7 118.2 73.6 118.2 90.3 L 118.2 90.3 Z  M 326.7 8 C 294.7 -6.3 259.9 -14 225.1 -14 C 87.7 -13.5 -24 98 -24 235.8 C -24 292.3 -4.9 347.3 30.4 391.8 C 35.2 415.8 31.9 440.6 20.9 462.2 C -1.1 504.8 89.6 476.1 123 464.1 C 248.5 520.6 395.9 464.1 452.2 338.2 C 508.5 212.4 452.2 64.5 326.7 8 L 326.7 8 Z  M 63.6 325.9 L 63.6 260.3 C 63.6 249.1 69.4 242.8 80 242.8 C 90.5 242.8 96.3 249.1 96.3 260.3 L 96.3 325.9 L 124.9 325.9 L 124.9 250.4 C 124.9 226.6 106.6 214.1 80 214.1 C 53.3 214.1 35 226.6 35 250.4 L 35 325.9 L 63.6 325.9 Z  M 193.1 242.8 C 208.9 242.8 219.5 253.1 219.5 271.3 C 219.5 289.5 208.9 299.8 193.1 299.8 C 177.2 299.8 166.6 289.5 166.6 271.3 C 166.6 253.1 177.2 242.8 193.1 242.8 Z  M 193.1 214.1 C 159.3 214.1 138 240.1 138 271.3 C 138 302.5 159.3 328.6 193.1 328.6 C 226.9 328.6 248.1 302.5 248.1 271.3 C 248.1 240.1 226.9 214.1 193.1 214.1 L 193.1 214.1 Z  M 322.3 216.8 L 322.3 282.3 C 322.3 293.6 318 299.8 307.5 299.8 C 297 299.8 291.8 293.6 291.8 282.3 L 291.8 216.8 L 261.8 216.8 L 261.8 289.5 C 261.8 316 281.5 328.6 303 328.6 C 316.4 328.6 328.1 323.2 336.4 310.2 C 346.4 323.2 358.1 328.6 371.5 328.6 C 393 328.6 412.7 316 412.7 289.5 L 412.7 216.8 L 382.7 216.8 L 382.7 282.3 C 382.7 293.6 377.6 299.8 367 299.8 C 356.5 299.8 352.3 293.6 352.3 282.3 L 352.3 216.8 L 322.3 216.8 Z ",fill:"rgb(255,255,255)"}})])])])])}),[],!1,null,null,null).exports;let mt="https:";const vt=window.markdownit("zero",{}).enable(["emphasis","newline","list","link"]);vt.renderer.rules.link_open=function(e,t,s,i,n){const o=e[t],a=o.attrIndex("href");if(a>=0){let e=o.attrs[a][1];if(e.startsWith("//"))e=mt+e,o.attrs[a][1]=e;else if(e.startsWith("/")||!e.match(/^[a-z]+:\/\//i)){const t=window.now4real.siteContext||"";e=e.startsWith("/")?e.substring(1):e;const s=`${mt}//${t}/${e}`;o.attrs[a][1]=s}}return o.attrPush(["target","_blank"]),o.attrPush(["rel","noopener noreferrer nofollow ugc"]),n.renderToken(e,t,s)};var ft={props:{color:{type:String},bgColor:{type:String}},data(){return{store:i.Z}},computed:{message(){const e=this.store.PARAMETERS.messageDurationValue;let t=null;return null!==e&&(t=this.$lang.data[this.generateTimeUnitKey(e,this.store.PARAMETERS.messageDurationUnit)]),this.$premium&&now4real.config.widget.welcome_message?this.generateCustomMsg(now4real.config.widget.welcome_message,1e3,e,t):e||t?this.$lang.complete("k67"+(now4real.config.custom_auth.enabled?"JWT":""),{$N:e,$A:t}):this.$lang.data["k67NoExpiration"+(now4real.config.custom_auth.enabled?"JWT":"")]},customIcon(){return this.$premium&&now4real.config.widget.welcome_message_img_url?now4real.config.widget.welcome_message_img_url:null}},methods:{generateTimeUnitKey(e,t){return 1===e?{MINUTES:"k5",HOURS:"k7",DAYS:"k9",WEEKS:"k11",MONTHS:"k13",YEARS:"k15"}[t]:{MINUTES:"k5s",HOURS:"k7s",DAYS:"k9s",WEEKS:"k11s",MONTHS:"k13s",YEARS:"k15s"}[t]},generateCustomMsg(e,t,s,i){const n=e.substring(0,t);let o;try{o=vt.render(n)}catch(e){(0,y.Z)(w.s.Error,"Markdown formatting error",e),o=(0,r.sY)(n)}return o=o.replace(/&lt;(?:(?:(?!(&lt;|&gt;)).)+)href=&quot;((?!javascript:).*?)&quot;(?:(?:(?!(&lt;|&gt;)).)*)*&gt;((?:(?!&lt;).)+)&lt;\/a&gt;/gm,((e,t,s,i,n)=>`<a href="${s}" target="_blank" rel="noopener noreferrer nofollow ugc">${n}</a>`)).replace(/&lt;br&gt;/gm,(()=>"<br>")),s&&i&&(o=o.replace(/{{\s*time\s*}}/gm,s).replace(/{{\s*timeUnit\s*}}/gm,i)),o},messageBubbleStyle(){return{backgroundColor:this.bgColor,color:this.color}}},components:{NowIcon:pt}},bt=(s(695),(0,I.Z)(ft,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"message-list-item-row-1 left-message-list-item-row-1",attrs:{id:"welcome-container"}},[t("div",{staticClass:"message-sender-profile-img-container left-message-sender-profile-img-container"},[e.customIcon?t("img",{staticClass:"message-sender-profile-img message-sender-profile-img-left",attrs:{src:e.customIcon}}):t("NowIcon",{staticClass:"message-sender-profile-img message-sender-profile-img-left"})],1),e._v(" "),t("div",{staticClass:"message-bubble left-message-bubble",style:e.messageBubbleStyle()},[t("div",{staticClass:"message-bubble-content",domProps:{innerHTML:e._s(e.message)}})])])}),[],!1,null,"494a852c",null).exports);const _t=(0,h.gH)((0,h.xr)(o.v.COLOR_A),.87),Ct=(0,h.gH)((0,h.xr)(o.v.COLOR_A),.78),wt="#34495e",yt=window.markdownit("zero",{}).enable(["emphasis","newline","list"]);var kt={mixins:[p.Z,m.Z,v.Z,f],data(){return{store:i.Z,loading:!0,chatSubject:now4real.Subject.LIST_CHAT_MESSAGES,welcomeMessageTimestamp:Date.now(),EMOJI_PICKER:a.Z.EMOJI_PICKER,GIF_PICKER:a.Z.GIF_PICKER,activePicker:a.Z.EMOJI_PICKER,pickerOpen:!1,LOGIN_INTENT:"LOGIN",POST_INTENT:"POST",REPORT_INTENT:"REPORT",HIDE_INTENT:a.Z.HIDE,SHOW_INTENT:a.Z.SHOW,TEXT_TYPE:"TEXT",GIF_TYPE:"GIF",customAuth:now4real.config.custom_auth,userIdenticon:now4real.config.widget.user_identicon,standardAuthDisabled:now4real._standardAuthDisabled,colorA:o.v.COLOR_A,colorALighter:Ct,colorC:wt,message:"",lines:1,chars:0,msgOptions:null,replyTo:null,editingMessage:null,suggestionsList:[],highlightColor:_t,sending:!1,stopping:!1,scrollTop:void 0,scrollToEnd:!0,scrollObserver:null,savedScrollTop:void 0,consentGiventOnThisSession:!1,linkDomainsMatcherRegex:null,pageProtocol:"http:",signInRequired:!1,viewOnly:!1,signInLink:null,disabled:!1,startedDisabled:!1,forceMobile:!1,welcomeMessageEnabled:!0,loadingMoreMessages:!1,hasMoreMessages:!0,messageHistoryObserver:null,anchorMessageId:null,cooldownActive:!1,showMoreButtonDisabled:!1,scrollHeightBeforeLoad:0,olderMessagesLoadingError:!1,isSafari:(0,g.G6)(),soundsEnabledPreference:i.Z.soundsEnabled,audioNotifier:null,hasUserSentMessage:!1,lastSoundPlayedTimestamp:Date.now()}},created(){const e=now4real.config.target;if(this.customAuth.enabled){const e="AUTHENTICATED"===this.store.LOGIN_STATUS.status;this.signInRequired=!e&&o.v.CHAT_VIEW&&!o.v.CHAT_POST,this.viewOnly=e&&o.v.CHAT_VIEW&&!o.v.CHAT_POST,this.customAuth.signin_url?this.signInLink=this.$lang.complete("k93",{"<a>":`<a href="${this.customAuth.signin_url}" target="_parent">`}):this.signInLink=this.$lang.complete("k93",{"<a>":"","</a>":""})}else this.viewOnly=this.standardAuthDisabled;o.v.PAGE_COUNTER_VIEW||o.v.SITE_COUNTER_VIEW||(this.store.PARAMETERS.chatStatus===a.Z.DISABLED_BY_ADMIN?(this.disabled=this.$lang.data.k91,this.startedDisabled=!0):this.store.PARAMETERS.chatStatus===a.Z.DISABLED_BY_MODERATOR&&(this.disabled=this.$lang.data.k92,this.startedDisabled=!0)),this.computelinkEnabledDomains(),o.v.CHAT_VIEW&&(this.startedDisabled||this.store.containerMode||!now4real.config.widget.chat_bubbles||e===a.Z.WIDGET||(e===a.Z.API_AND_WIDGET||e===a.Z.DEMO)&&this.store.notificatorBubbleClosed)?now4real.subscribe(this.chatSubject,(e=>{const t=e.data.action;if("RESET"===t)this.hasMoreMessages=!0,this.loadingMoreMessages=!1,this.cooldownActive=!1,this.anchorMessageId=null;else if("REMOVE"===t)this.msgOptions&&this.msgOptions.id===e.data.id&&this.hideMsgOptions();else if("ADD"===t&&this.canPlaySound()){const t=e.data.isMine,s=e.data.time;!t&&s>this.lastSoundPlayedTimestamp&&(this.audioNotifier.play(),this.lastSoundPlayedTimestamp=Date.now())}})).then((e=>{this.store[this.chatSubject]=now4real[this.chatSubject],this.loading=!1})).catch((e=>{e&&e.code===now4real.ErrorCode.INVALID_CALL&&(this.loading=!1)})):this.loading=!1,b.Z.$on(a.Z.TAB_SWITCH_EVENT,((e,t)=>{t===a.Z.CHAT_TAB&&this.closePickers(!0)})),b.Z.$on(a.Z.MINIMIZE_EVENT,(e=>{this.closePickers(!0)})),e===a.Z.API_AND_WIDGET&&(this.suggestionsList=now4real._suggestions||[],b.Z.$on(a.Z.API_SUGGESTIONS_EVENT,(e=>{this.suggestionsList=e||[]}))),b.Z.$on(a.Z.SOUNDS_TOGGLED_EVENT,(e=>{this.soundsEnabledPreference=e})),this.$watch("store.PARAMETERS",(e=>{if(e){const t=e.chatStatus;if(t===a.Z.DISABLED_BY_ADMIN||t===a.Z.DISABLED_BY_MODERATOR?(this.$refs.input?.clear(),this.disabled=this.$lang.data[""+(t===a.Z.DISABLED_BY_ADMIN?"k91":"k92")],this.closePickers(),this.abortReplyToMessage()):t===a.Z.ENABLED&&(this.disabled=!1,this.startedDisabled&&(this.viewOnly=!0)),e.gifsStatus===a.Z.DISABLED){const e=this.$refs.rcPkr,t=e?.getOpenPicker();t===this.GIF_PICKER&&(e.close(),this.pickerOpen=!1),this.activePicker=this.EMOJI_PICKER}}})),this.forceMobile=this.store.containerMode&&navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile|Opera Mini)/),this.welcomeMessageEnabled=!(this.viewOnly||this.$premium&&""===now4real.config.widget.welcome_message),this.$watch("store.LOGIN_STATUS",((e,t)=>{e&&"NOT_AUTHENTICATED"===e.status?(this.closePickers(!0),this.editingMessage&&this.cancelEditMessage(),this.hasUserSentMessage=!1):e&&"AUTHENTICATED"===e.status&&t&&"NOT_AUTHENTICATED"===t.status&&(this.soundsEnabledPreference=this.store.soundsEnabled)})),this.$watch(`store.${this.chatSubject}`,(()=>{this.$refs.list&&this.scrollToEnd&&!this.msgOptions&&this.$nextTick().then((e=>{(0,d.Og)(this.$refs.list)}))})),this.audioNotifier=new k({audioSource:M,cooldownMs:1e4,volume:.5,playOnlyInBackground:!0})},mounted(){this.signInRequired||this.viewOnly||this.startedDisabled||(this.listenVirtualKeyboardEvents(),this.listenChatListResize()),this.setupScrollingBehavior()},methods:{canPlaySound(){return this.soundsEnabledPreference||void 0===this.soundsEnabledPreference&&this.hasUserSentMessage},onGifReady(){(0,y.Z)(w.s.Debug,"onGifReady",this.scrollToEnd),this.scrollToEnd&&!this.msgOptions&&this.scrollToBottom()},sendGif(e){(0,y.Z)(w.s.Debug,"sendGif",e),this.send(e,this.GIF_TYPE)},computelinkEnabledDomains(){let e=[],t=now4real._parentOrigin;t&&!t.startsWith("file://")&&(e.push(t.replace(/https?:\/\//,"")),this.pageProtocol=(0,c.e)(t).protocol);let s=now4real.siteContext;"shared-public-sandbox.test"!==s&&e.push(s);let i=now4real.groupContext;i&&e.push(i),e=e.filter(((t,s)=>e.indexOf(t)==s)),(0,y.Z)(w.s.Debug,"domains",e),e.length&&(this.linkDomainsMatcherRegex=e.map((e=>/:\d{1,5}$/.test(e)?(0,r.hr)(e):(0,r.hr)(e)+"(:(80|443))?")).join("|"))},isScrolledToBottom:d.N2,scrollToBottom(){(0,d.Og)(this.$refs.list),this.scrollTop=this.$refs.list.scrollTop,this.scrollToEnd=!0},listenVirtualKeyboardEvents(){d.i4.init({recentlyFocusedTimeoutDuration:3e3,el:this.$refs.input.$el}),d.i4.on("virtualKeyboardVisible",(()=>{this.$emit("virtualKeyboardVisibilityChange",!0)})),d.i4.on("virtualKeyboardHidden",(()=>{this.$emit("virtualKeyboardVisibilityChange",!1)}))},listenChatListResize(){const e=()=>{const e=this.$refs.list;this.oldListHeight=e.clientHeight;new ResizeObserver((t=>{e.clientHeight!==this.oldListHeight&&(this.oldListHeight=e.clientHeight,(0,y.Z)(w.s.Debug,"Chat list resized",this.scrollToEnd),this.scrollToEnd&&!this.msgOptions&&(0,d.Og)(e))})).observe(e)};if(this.ready)e();else{const t=this.$watch("ready",(s=>{s&&(t(),e())}))}},setupScrollingBehavior(){const e=()=>{this.$nextTick((e=>{this.$refs.list&&this.scrollToEnd&&this.$nextTick().then((e=>{(0,d.Og)(this.$refs.list)})),this.setupScrollObserver()}))};if(this.ready)e();else{const t=this.$watch("ready",(s=>{s&&(t(),e())}))}},onScroll(e){this.scrollTop=this.$refs.list.scrollTop},loadOlderMessages(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loadingMoreMessages||this.cooldownActive||!this.hasMoreMessages||(this.loadingMoreMessages=!0,this.olderMessagesLoadingError=!1,e&&this.$refs.list&&(this.scrollHeightBeforeLoad=this.$refs.list.scrollHeight),e||(this.anchorMessageId=this.findAnchorMessageForScroll()),(0,y.Z)(w.s.Debug,"Loading older messages",e?"from button":"from observer"),now4real.getOlderMessages().then((t=>{if(this.olderMessagesLoadingError=!1,!t.hasMore)return(0,y.Z)(w.s.Debug,"No more older messages available"),this.hasMoreMessages=!1,this.loadingMoreMessages=!1,void(this.messageHistoryObserver&&this.messageHistoryObserver.disconnect());(0,y.Z)(w.s.Debug,`Loaded ${t.messages.length} older messages`),this.$nextTick((()=>{if(!this.isSafari)try{e?this.maintainScrollPositionAfterButtonLoad():this.maintainScrollPositionWithAnchor()}catch(e){(0,y.Z)(w.s.Error,"Error maintaining scroll position",e)}this.cooldownActive=!0,setTimeout((()=>{if(this.cooldownActive=!1,0===this.$refs.list.scrollTop){document.getElementById(this.anchorMessageId).scrollIntoView({block:"start"}),(0,y.Z)(w.s.Debug,"Fix scroll to anchor message",this.anchorMessageId)}}),500),this.loadingMoreMessages=!1}))})).catch((e=>{(0,y.Z)(w.s.Error,"Error loading older messages",e),this.loadingMoreMessages=!1,this.olderMessagesLoadingError=!0,this.$toast(this.$lang.data.k88,{parent:".chat-container",id:"load-more-error",className:"toast-alert",duration:3e3}),this.cooldownActive=!0,setTimeout((()=>{this.cooldownActive=!1}),3e3)})))},maintainScrollPositionAfterButtonLoad(){if(!this.$refs.list||0===this.scrollHeightBeforeLoad)return;const e=this.$refs.list.scrollHeight-this.scrollHeightBeforeLoad;this.$refs.list.scrollTop+=e,(0,y.Z)(w.s.Debug,"Maintained scroll position after button load",{heightDifference:e,oldHeight:this.scrollHeightBeforeLoad,newHeight:this.$refs.list.scrollHeight,newScrollTop:this.$refs.list.scrollTop}),this.scrollHeightBeforeLoad=0},maintainScrollPositionWithAnchor(){if(!this.anchorMessageId)return;const e=document.getElementById(this.anchorMessageId);e?(e.scrollIntoView({block:"start"}),(0,y.Z)(w.s.Debug,"Scrolled to anchor message",this.anchorMessageId)):(0,y.Z)(w.s.Debug,"Anchor element not found")},onWrite(e,t,s){this.message=e,this.lines=t,this.chars=s,this.$refs.typing.write(e)},onEnter(){this.sendDisabled||this.send()},send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.TEXT_TYPE;(0,y.Z)(w.s.Debug,"send call",this.sending,e,t);const s=e||this.message;if(this.customAuth.enabled&&!this.consentGiventOnThisSession&&!this.authenticatedUser.consentGiven&&(!this.$whiteLabel||now4real.config.widget.consent_message))return(0,y.Z)(w.s.Debug,"legal agreement required"),void this.$refs.jwtModal.show(this.POST_INTENT,{content:s,typeHint:t});if(this.sending)return;this.sending=!0,this.$refs.input&&this.$refs.input.disable(),this.$refs.typing.write("");const i=this.editingMessage&&t===this.TEXT_TYPE,n=i?this.editingMessage.id:null,o=!i&&this.replyTo?{replyTo:this.replyTo.id}:null;(i?(0,l.XD)(["DISCONNECTED"],20,(e=>now4real.editMessage(n,s))):(0,l.XD)(["DISCONNECTED"],20,(e=>now4real.post(s,o)))).then((e=>{let s=this.$refs.stop,i=this.$refs.input;const n=t===this.TEXT_TYPE;(n||this.editingMessage)&&(this.message="",this.lines=1,this.chars=0),i&&(n||this.editingMessage)&&i.clear(),this.$refs.rcPkr?.storeRecents(),s&&i&&0!==e?.waitPeriod&&(this.stopping=!0,s.enable(e?.waitPeriod),i.disableEnter()),this.sending=!1,this.replyTo=null,this.editingMessage=null,i&&(i.enable(),this.store.isMobile||i.focus()),this.suggestionsList=e?.suggestions||[],this.$toast.removeToastsById("post-error"),this.closePickers(),this.hasUserSentMessage||(this.hasUserSentMessage=!0,b.Z.$emit(a.Z.FIRST_MESSAGE_SENT_EVENT))})).catch((e=>{let n=this.$refs.stop,o=this.$refs.input;if(e.code!==now4real.ErrorCode.NOT_AUTHENTICATED||i){(0,y.Z)(w.s.Error,i?"Edit error":"Post error",e);let t,s=!1;switch(e.code){case now4real.ErrorCode.CHAT_DISABLED:t="k86";break;case now4real.ErrorCode.TOO_FREQUENT:t="k82";break;case now4real.ErrorCode.BLOCKED:t="k83",s=!0;break;case now4real.ErrorCode.CHATBOT:t="k87";break;case now4real.ErrorCode.USER_MUTED:t="k2";break;case now4real.ErrorCode.NOT_AUTHORIZED:if(i){t="k89";break}default:t="k1"}let a=s?this.$whiteLabel?now4real.config.widget.moderation_info_url?this.$lang.complete(t,{"<a>":`<a href="${now4real.config.widget.moderation_info_url}" target="_blank" rel="noopener noreferrer nofollow">`}):this.$lang.transform(t,/\s*<a>.*<\/a>/,""):this.$lang.complete(t,{"<a>":'<a href="https://now4real.com/message-blocked/" target="_blank" rel="noopener noreferrer nofollow">'}):this.$lang.data[t];const r=s?8e3:5e3,l=i||this.replyTo?".reply-to-wrapper":".compose-container";this.$toast(a,{relativeElement:l,id:"post-error",className:"toast-alert",duration:r}),n&&o&&(this.stopping=!0,n.enable(2e3),o.disableEnter())}else this.showLoginModal(this.POST_INTENT,{content:s,typeHint:t});this.sending=!1,o&&(o.enable(),this.store.isMobile||o.focus())}))},openEmojiPicker(){this.$refs.rcPkr.open(this.EMOJI_PICKER),this.activePicker=this.EMOJI_PICKER,this.pickerOpen=!0,this.store.isMobile||this.$nextTick().then((()=>{this.$refs.input&&this.$refs.input.focus()}))},openGifPicker(){this.$refs.rcPkr.open(this.GIF_PICKER),this.activePicker=this.GIF_PICKER,this.pickerOpen=!0,this.store.isMobile||this.$nextTick().then((()=>{this.$refs.input&&this.$refs.input.focus()}))},closePickers(e){this.$refs.rcPkr?.close(e),this.pickerOpen=!1},onNavigate(e){if(e&&document.getElementById(e)){(0,y.Z)(w.s.Debug,"navigate",e),this.lastNavigateEvent=Date.now();const t=document.getElementById(e);t.scrollIntoView({block:"nearest",inline:"center"});t.parentElement.parentElement.style.backgroundColor=this.highlightColor,setTimeout((t=>{const s=document.getElementById(e);if(s){let e=s.parentElement.parentElement;e&&(e.style.backgroundColor="")}}),2e3)}},onShowMsgOptions(e,t){this.msgOptions=e,this.$refs.msgOptions.show(e,t)},hideMsgOptions(){(0,y.Z)(w.s.Debug,"hideMsgOptions"),this.msgOptions=null,this.$refs.msgOptions.hide()},muteUser(e){this.hideMsgOptions(),this.$refs.muteModal.show(e.author)},reportMsg(e){this.hideMsgOptions(),this.authenticated?this.$refs.reportModal.show(e):this.showLoginModal(this.REPORT_INTENT,u(e))},hideMsg(e){this.hideMsgOptions(),this.authenticated?this.$refs.hideModal.show(e,this.HIDE_INTENT):this.showLoginModal(this.HIDE_INTENT,u(e))},showMsg(e){this.hideMsgOptions(),this.$refs.hideModal.show(e,this.SHOW_INTENT)},deleteMsg(e){this.hideMsgOptions(),now4real.deleteMessage(e.id).catch((e=>{const t=e.code===now4real.ErrorCode.NOT_AUTHORIZED?"k90":"k1";this.$toast(this.$lang.data[t],{parent:".chat-container",id:"delete-error",className:"toast-alert"})}))},replyToMsg(e){this.hideMsgOptions(),this.$refs.input&&e&&(this.editingMessage&&(this.editingMessage=null,this.$refs.input.clear()),this.replyTo=u(e),this.replyTo.formattedContent=this.formatMessage(e,!0),this.replyTo.citedMessageStyle=this.citedMessageStyle(!0),this.replyTo.citedMessageContentStyle=this.citedMessageContentStyle(!0),this.$refs.input.focus())},editMsg(e){this.hideMsgOptions(),this.$refs.input&&e&&(this.replyTo=null,this.editingMessage=u(e),this.editingMessage.formattedContent=this.formatMessage(e,!0),this.editingMessage.citedMessageStyle=this.citedMessageStyle(!0),this.editingMessage.citedMessageContentStyle=this.citedMessageContentStyle(!0),this.$refs.input.setValue(e.message),this.$refs.input.focus())},cancelEditMessage(){this.editingMessage=null,this.$refs.input?.clear()},abortReplyToMessage(){(0,y.Z)(w.s.Debug,"abortReplyToMessage"),this.replyTo=null},formatTime(e){let t=this.$lang.data.k4;return 12!==t&&24!==t&&(t=24),(0,n.mr)(e,t)},formatMessageModerated(e){let t;switch(e.deleted){case"BY_AUTHOR":t=e.isMine?"k71":"k72";break;case"BY_MODERATOR":t="k73";break;case"BY_ADMINISTRATOR":t="k74";break;case"BY_NOW4REAL":t="k75";break;case"BY_AI":t="k76";break;default:t="k77"}return this.$lang.data[t]},formatMessage(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s="CHATBOT"===e?.author?.provider,i=now4real.config.widget.markdown_enabled;let n=(0,r.Xv)(e.message);if(i||s)try{n=yt.render(e.message)}catch(e){(0,y.Z)(w.s.Error,"Markdown formatting error",e)}if(!t&&this.linkDomainsMatcherRegex)try{const t=e.author.role===a.Z.MODERATOR||e.author.role===a.Z.GUEST,s="ALL"===this.store.PARAMETERS.clickableLinks;n=(0,r.fL)(n,{pageProtocol:this.pageProtocol,domainRegex:t||s?null:this.linkDomainsMatcherRegex})}catch(e){(0,y.Z)(w.s.Error,"Link parsing error",e)}return n},insertEmoji(e){this.$refs.input?.insertText(e)},onAuthModalAuth(e,t,s){if(this.closePickers(!0),e.persistent||this.$toast(this.$lang.data.k85,{parent:".chat-container",id:"login-not-persistent",className:"toast-warn",duration:6e3}),s){const i=e.user,n=i&&i.id,o=i&&i.role===a.Z.MODERATOR;if(t===this.POST_INTENT){this.$refs.input&&setTimeout((()=>{this.send(s.content,s.typeHint)}),500)}else if(t===this.REPORT_INTENT){const e=s.author.id;n&&n!==e&&setTimeout((()=>{this.reportMsg(s)}),500)}else if(t===this.HIDE_INTENT){const e=s.author.id,t=this.store.hiddenUsers;!n||n===e||t[e]||o||setTimeout((()=>{this.hideMsg(s)}),500)}}},onAuthModalError(e){const t=e.code;if(t===now4real.ErrorCode.ALREADY_STARTED)return;const s=this.$lang.data[t===now4real.ErrorCode.ABORTED?"k84":"k1"];this.$toast(s,{parent:".chat-container",id:"login-error",className:"toast-alert"})},showLoginModal(e,t){now4real.login().then((s=>{this.onAuthModalAuth(s,e,t)})).catch((e=>{(0,y.Z)(w.s.Error,"login error",e),this.onAuthModalError(e)}))},onStopCompletion(){this.stopping=!1,this.$refs.input&&this.$refs.input.enableEnter()},onJwtModalClose(){this.$refs.jwtModal.hide(),this.$refs.input&&(this.$refs.input.focus(),this.$refs.input.enable())},onJwtModalAccepted(e,t){this.$refs.jwtModal.hide(),this.consentGiventOnThisSession=!0,this.$refs.input&&(this.$refs.input.enable(),t&&setTimeout((()=>{this.send(t.content,t.typeHint)}),500))},messageBubbleStyle(e){return{backgroundColor:e?o.v.COLOR_A:_t,color:e?o.v.COLOR_B:wt}},citedMessageStyle(e){return{backgroundColor:e?o.v.COLOR_A:_t,borderLeft:`.25em solid ${e?_t:o.v.COLOR_A}`,color:e?_t:o.v.COLOR_A}},citedMessageContentStyle(e){return{color:e?o.v.COLOR_B:wt}},onSuggestionClicked(e){this.sending||this.stopping||this.send(e,this.TEXT_TYPE)},setupMessageHistoryObserver(){this.messageHistoryObserver||((0,y.Z)(w.s.Debug,"Setting up message history observer",this.store[this.chatSubject]?.length),this.messageHistoryObserver=new IntersectionObserver((e=>{const t=e[0];t.isIntersecting&&!this.loadingMoreMessages&&!this.cooldownActive&&this.hasMoreMessages&&this.store[this.chatSubject].length>=this.listChatMessagesInitialCount&&((0,y.Z)(w.s.Debug,"Oldest message element visible, loading older messages"),this.messageHistoryObserver.unobserve(t.target),this.loadOlderMessages(!1))}),{root:this.$refs.list,rootMargin:"200px 0px 0px 0px",threshold:.1}))},isLoadTriggerMessage(e,t){return this.hasMoreMessages&&t&&(0===e&&!t.isWelcomeMessage||1===e&&t.isWelcomeMessage)},findAnchorMessageForScroll(){if(!this.store[this.chatSubject]||0===this.store[this.chatSubject].length)return null;const e=this.store[this.chatSubject][0];return e&&e.id?e.id:null},handleShowMoreClick(){this.loadOlderMessages(!0)},saveScrollPosition(){this.$refs.list&&(this.savedScrollTop=this.$refs.list.scrollTop,(0,y.Z)(w.s.Debug,"Saved scroll position",this.savedScrollTop))},restoreScrollPosition(){this.$refs.list&&void 0!==this.savedScrollTop&&(this.$refs.list.scrollTop=this.savedScrollTop,(0,y.Z)(w.s.Debug,"Restored scroll position",this.savedScrollTop))},setupScrollObserver(){this.scrollObserver&&this.scrollObserver.disconnect(),this.$refs.bottomSentinel&&this.$refs.list&&(this.scrollObserver=new IntersectionObserver((e=>{const t=e[0];(0,y.Z)(w.s.Debug,"Scroll observer triggered",t.isIntersecting),this.scrollToEnd=t.isIntersecting}),{root:this.$refs.list,threshold:.1,rootMargin:"10px"}),this.scrollObserver.observe(this.$refs.bottomSentinel),(0,y.Z)(w.s.Debug,"Scroll observer setup complete"))}},computed:{enrichedMessageList(){let e=this.store[this.chatSubject].map((e=>{const t=e.isMine,s=e.repliesTo;let i;i=e.deleted?this.formatMessageModerated(e):this.formatMessage(e);let n=null;return s&&(n=s.deleted?this.formatMessageModerated(s):this.formatMessage(s,!0)),{...e,isGif:this.isGif(e),formattedContent:i,formattedTime:this.formatTime(e.time),signedInWith:(0,_.Z)(e.author.provider,this.$lang.data),bubbleStyle:this.messageBubbleStyle(t),repliesToGif:!!s&&this.isGif(s),formattedContentReply:n,citedMessageStyle:s?this.citedMessageStyle(t):null,citedMessageContentStyle:s?this.citedMessageContentStyle(t):null}}));if(this.welcomeMessageEnabled){const t={isWelcomeMessage:!0,id:"wm-"+this.welcomeMessageTimestamp,author:{id:"welcome-bot",name:"Welcome Bot",pic:null,provider:"system"},message:null,time:this.welcomeMessageTimestamp,isMine:!1,isGif:!1,formattedContent:null,formattedTime:null,signedInWith:null,bubbleStyle:null,repliesToGif:!1,formattedContentReply:null,citedMessageStyle:null,citedMessageContentStyle:null};let s=0;for(;s<e.length&&e[s].time<t.time;)s++;e.splice(s,0,t)}return e},landscaped(){return this.store.isLandscape},messageMaxLength(){return this.store.PARAMETERS?this.moderator?this.store.PARAMETERS.messageMaxLengthModerator:this.guest?this.store.PARAMETERS.messageMaxLengthGuest:this.store.PARAMETERS.messageMaxLength:140},messageDurationSeconds(){if(!this.store.PARAMETERS||!this.store.PARAMETERS.messageDurationValue)return null;const{messageDurationValue:e,messageDurationUnit:t}=this.store.PARAMETERS;return(0,n.WW)(e,t)},listChatMessagesInitialCount(){return this.store.PARAMETERS?.listChatMessagesInitialCount||50},ready(){return!this.loading},replyToWrapperStyle(){return{backgroundColor:o.v.COLOR_A}},composeContainerStyle(){return{backgroundColor:o.v.COLOR_A}},scrollerEnabled(){const e=this.$refs.list;return this.store[this.chatSubject].length>0&&void 0!==this.scrollTop&&e&&e.scrollHeight-e.scrollTop-e.clientHeight>50},sendDisabled(){return this.sending||this.stopping||!this.connected||0===this.message.trim().length||this.disabled||this.chars>this.messageMaxLength},counterEnabled(){return this.lines>1},timeFrame(){const e=this.store[this.chatSubject];if(!e||0===e.length)return[];const t=(0,n.iZ)(Date.now()),s=new Array(e.length);let i=0;for(;i<e.length;){const o=(0,n.iZ)(e[i].time);if(o===t){0!==i&&(s[i]=(0,n.p6)(e[i].time,this.$lang.currentLang));break}e[i]!==t&&(!i||e[i-1]&&(0,n.iZ)(e[i-1].time)!==o)&&(s[i]=(0,n.p6)(e[i].time,this.$lang.currentLang)),i++}return s},bubble(){const e=this.enrichedMessageList,t=[];let s=!1;for(let i=e.length-1;i>=0;i--){const n=e[i].isMine;i===e.length-1?(t.unshift(!0),n&&(s=!0)):s&&n?t.unshift(!1):(t.unshift(e[i].author.id!==e[i+1].author.id),n&&(s=!0))}return t},showMoreText(){return this.olderMessagesLoadingError&&!this.loadingMoreMessages&&this.store[this.chatSubject]&&this.store[this.chatSubject].length>=this.listChatMessagesInitialCount}},watch:{"store.isLandscape"(e){e&&this.closePickers()},"store.isMobile"(){this.msgOptions&&this.hideMsgOptions()},"store.LOGIN_STATUS"(){this.msgOptions&&this.hideMsgOptions()},messageDurationSeconds(e,t){e>t&&null!==t&&setTimeout((()=>{(0,y.Z)(w.s.Debug,"Message duration increased, resetting hasMoreMessages",{newValue:e,oldValue:t}),this.hasMoreMessages=!0}),0)}},activated(){this.setupMessageHistoryObserver(),this.restoreScrollPosition()},deactivated(){this.saveScrollPosition()},beforeDestroy(){this.scrollObserver&&(this.scrollObserver.disconnect(),this.scrollObserver=null),this.messageHistoryObserver&&(this.messageHistoryObserver.disconnect(),this.messageHistoryObserver=null,(0,y.Z)(w.s.Debug,"Message history observer disconnected before destroy"))},components:{AutoresizeArea:Z,JwtModal:V,MuteModal:q,ReportModal:J,HideModal:Q,Typing:pe,Spinner:j.Z,Stopper:ze,UserPic:G.Z,UserBadge:qe.Z,UserIdenticon:Ke,CloseIcon:Ye.Z,Gif:Fe.Z,Fallback:Xe,MessageOptions:et,RichContentPicker:Ne,Poll:ct,ChatSuggestions:oe,MessageBubble:ut,WelcomeBubble:bt}},Mt=kt,Et=(s(3370),(0,I.Z)(Mt,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"chat-container"},[t("message-options",{ref:"msgOptions",on:{hideMsg:e.hideMsg,showMsg:e.showMsg,reportMsg:e.reportMsg,muteUser:e.muteUser,deleteMsg:e.deleteMsg,replyToMsg:e.replyToMsg,editMsg:e.editMsg,clickOutside:e.hideMsgOptions,esc:e.hideMsgOptions}}),e._v(" "),t("jwt-modal",{ref:"jwtModal",on:{close:e.onJwtModalClose,accept:e.onJwtModalAccepted}}),e._v(" "),t("mute-modal",{ref:"muteModal"}),e._v(" "),t("report-modal",{ref:"reportModal"}),e._v(" "),t("hide-modal",{ref:"hideModal"}),e._v(" "),e.$premium?t("poll",{ref:"poll"}):e._e(),e._v(" "),e.ready?t("div",{ref:"list",staticClass:"message-list-container smooth-scroll focus-el",class:{disabled:!!e.disabled},attrs:{tabindex:"1000"},on:{scroll:function(t){return e.onScroll(t)}}},[e.showMoreText?t("div",{staticClass:"show-more-container"},[t("span",{staticClass:"show-more-text",on:{click:e.handleShowMoreClick}},[e._v("\n                "+e._s(e.$lang.data.k103)+"\n            ")])]):e._e(),e._v(" "),e.loadingMoreMessages?t("div",{staticClass:"load-more-spinner"},[t("spinner",{attrs:{circleColor:"#565043",circleSize:"9"}})],1):e._e(),e._v(" "),t("transition-group",{attrs:{name:"message-fade-out",tag:"div"}},e._l(e.enrichedMessageList,(function(s,i){return t("div",{key:s.id,staticClass:"message-list-item",class:{"message-list-separator-item":i<e.enrichedMessageList.length-1&&s.author.id!==e.enrichedMessageList[i+1].author.id}},[e.timeFrame[i]?t("div",{staticClass:"message-day"},[e._v(e._s(e.timeFrame[i]))]):e._e(),e._v(" "),s.isWelcomeMessage?[t("WelcomeBubble",{attrs:{color:e.colorC,"bg-color":e.colorALighter}})]:[t("div",{staticClass:"message-list-item-row-1",class:{"left-message-list-item-row-1":!s.isMine,"right-message-list-item-row-1":s.isMine,mobile:e.store.isMobile}},[e.bubble[i]?t("div",{staticClass:"message-sender-profile-img-container",class:{"left-message-sender-profile-img-container":!s.isMine,"right-message-sender-profile-img-container":s.isMine}},[t("UserPic",{staticClass:"message-sender-profile-img",class:{"message-sender-profile-img-left":!s.isMine,"message-sender-profile-img-right":s.isMine},attrs:{user:s.author,title:s.signedInWith}})],1):e._e(),e._v(" "),t("MessageBubble",{attrs:{message:s,"complete-bubble":e.bubble[i],highlighted:e.msgOptions&&e.msgOptions.id===s.id,"force-mobile":e.forceMobile,"view-only":e.viewOnly,"sign-in-required":e.signInRequired,"custom-auth":e.customAuth,observer:e.isLoadTriggerMessage(i,e.enrichedMessageList[0])?e.messageHistoryObserver:null},on:{"show-msg-options":e.onShowMsgOptions,navigate:e.onNavigate,"gif-ready":e.onGifReady}})],1),e._v(" "),e.bubble[i]&&!s.isWelcomeMessage?t("div",{staticClass:"message-list-item-row-2",class:{"left-message-list-item-row-2":!s.isMine,"right-message-list-item-row-2":s.isMine}},[e.userIdenticon||e.moderator?t("user-identicon",{attrs:{user:s.author}}):e._e(),e._v(" "),t("span",{staticClass:"message-sender-name"},[e._v(e._s(s.author.name))]),e._v(" "),s.author.badge&&s.author.badge.label?t("user-badge",{staticClass:"msg-badge",attrs:{user:s.author}}):e._e()],1):e._e()]],2)})),0),e._v(" "),t("div",{ref:"bottomSentinel",staticClass:"chat-bottom-sentinel"})],1):t("spinner"),e._v(" "),t("div",{staticClass:"suggestions"},[t("ChatSuggestions",{attrs:{suggestions:e.suggestionsList,color:e.colorA},on:{"suggestion-clicked":e.onSuggestionClicked}}),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.scrollerEnabled,expression:"scrollerEnabled"}],staticClass:"scroller",on:{click:e.scrollToBottom,mousedown:function(e){e.preventDefault()}}},[t("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M7.41 8.58L12 13.17l4.59-4.59L18 10l-6 6-6-6 1.41-1.42z"}})])])])],1),e._v(" "),e.startedDisabled?e._e():t("div",{staticClass:"typing"},[t("typing",{ref:"typing"})],1),e._v(" "),e.replyTo?t("div",{staticClass:"reply-to-wrapper",style:e.replyToWrapperStyle},[t("div",{key:"2",staticClass:"cited-message",style:e.replyTo.citedMessageStyle},[e.replyTo.isGif?[t("div",{staticClass:"cited-gif-wrapper"},[t("div",{staticClass:"left-col"},[t("div",{staticClass:"name"},[e._v(e._s(e.replyTo.author.name))]),e._v(" "),t("div",{staticClass:"type"},[e._v("GIF")])]),e._v(" "),t("gif",{staticClass:"gif-content",attrs:{url:e.replyTo.message,width:40,thumbnail:"","accent-color":e.replyTo.citedMessageStyle.color}})],1)]:[t("div",{staticClass:"name"},[e._v(e._s(e.replyTo.author.name))]),e._v(" "),t("div",{staticClass:"content",style:e.replyTo.citedMessageContentStyle,domProps:{innerHTML:e._s(e.replyTo.formattedContent)}})]],2),e._v(" "),t("button",{staticClass:"btn close-btn hoverable-btn",attrs:{title:e.$lang.data.k25},on:{click:function(t){return t.stopPropagation(),e.abortReplyToMessage.apply(null,arguments)}}},[t("span",[t("close-icon")],1)])]):e._e(),e._v(" "),e.editingMessage?t("div",{staticClass:"reply-to-wrapper",style:e.replyToWrapperStyle},[t("div",{key:"3",staticClass:"cited-message",style:e.editingMessage.citedMessageStyle},[t("div",{staticClass:"name"},[e._v(e._s(e.$lang.data.k101))]),e._v(" "),t("div",{staticClass:"content",style:e.editingMessage.citedMessageContentStyle,domProps:{innerHTML:e._s(e.editingMessage.formattedContent)}})]),e._v(" "),t("button",{staticClass:"btn close-btn hoverable-btn",attrs:{title:e.$lang.data.k25},on:{click:function(t){return t.stopPropagation(),e.cancelEditMessage.apply(null,arguments)}}},[t("span",[t("close-icon")],1)])]):e._e(),e._v(" "),t("div",{staticClass:"compose-container",style:e.composeContainerStyle},[t("rich-content-picker",{ref:"rcPkr",attrs:{"gif-rating":e.store.PARAMETERS.gifsStatus},on:{"emoji-selection":e.insertEmoji,"gif-selection":e.sendGif}}),e._v(" "),e.signInRequired||e.viewOnly||e.disabled?e.disabled?t("div",{staticClass:"chat-disabled"},[e._v(e._s(e.disabled))]):e.viewOnly?t("div",{staticClass:"read-only"},[e._v(e._s(e.$lang.data.k94))]):e.signInRequired?t("div",{staticClass:"auth-required",domProps:{innerHTML:e._s(e.signInLink)}}):e._e():t("div",{staticClass:"input-container"},[t("div",{staticClass:"picker-btn-container",class:{"disabled-picker-btn":e.landscaped}},[e.pickerOpen?t("button",{staticClass:"btn hoverable-btn focus-el",attrs:{title:e.$lang.data.k25,tabindex:"1001"},on:{click:function(t){return e.closePickers()},mousedown:function(e){e.preventDefault()}}},[t("span",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M7.41 8.58L12 13.17l4.59-4.59L18 10l-6 6-6-6 1.41-1.42z"}})])])]):e.activePicker===e.EMOJI_PICKER?t("button",{staticClass:"btn hoverable-btn focus-el",attrs:{title:"Emoticon",tabindex:"1001"},on:{click:e.openEmojiPicker,mousedown:function(e){e.preventDefault()}}},[t("span",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M12 17.5c2.33 0 4.3-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5M8.5 11A1.5 1.5 0 0010 9.5 1.5 1.5 0 008.5 8 1.5 1.5 0 007 9.5 1.5 1.5 0 008.5 11m7 0A1.5 1.5 0 0017 9.5 1.5 1.5 0 0015.5 8 1.5 1.5 0 0014 9.5a1.5 1.5 0 001.5 1.5M12 20a8 8 0 01-8-8 8 8 0 018-8 8 8 0 018 8 8 8 0 01-8 8m0-18C6.47 2 2 6.5 2 12a10 10 0 0010 10 10 10 0 0010-10A10 10 0 0012 2z"}})])])]):e.activePicker===e.GIF_PICKER?t("button",{staticClass:"btn hoverable-btn focus-el",attrs:{title:"GIF",tabindex:"1001"},on:{click:e.openGifPicker,mousedown:function(e){e.preventDefault()}}},[t("span",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 467.88 300.62",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M90.5 121.62v57.375c0 21.037 17.212 38.25 38.25 38.25h57.375v-76.5H128.75v19.125H167v38.25h-38.25c-11.475 0-19.125-7.65-19.125-19.125V121.62c0-11.475 7.65-19.125 19.125-19.125h57.375V83.37H128.75c-21.038 0-38.25 17.212-38.25 38.25zM205.25 217.25h57.375v-19.125H243.5V102.5h19.125V83.375H205.25V102.5h19.125v95.625H205.25z"}}),t("path",{attrs:{d:"M400.5 0H67.38C34.867 0 .005 46.862.005 79.375v143.88c0 32.513 34.862 77.375 67.375 77.375H400.5c32.513 0 67.375-46.862 67.375-79.375V79.375C467.875 46.862 433.013 0 400.5 0zm32.25 217.25c0 21.037-15.213 48.25-36.25 48.25H71.38c-21.038 0-36.25-27.213-36.25-48.25V83.37c0-21.038 15.212-48.25 36.25-48.25H396.5c21.037 0 36.25 27.212 36.25 48.25z"}}),t("path",{attrs:{d:"M377.38 102.5V83.375h-95.625v133.88h19.125V159.88h57.375v-19.125H300.88v-38.25z"}})])])]):e._e()]),e._v(" "),t("div",{staticClass:"picker-btn-container",class:{"disabled-picker-btn":e.landscaped}},[e.pickerOpen&&e.activePicker===e.GIF_PICKER?t("button",{staticClass:"btn hoverable-btn focus-el",attrs:{title:"Emoticon",tabindex:"1002"},on:{click:e.openEmojiPicker,mousedown:function(e){e.preventDefault()}}},[t("span",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M12 17.5c2.33 0 4.3-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5M8.5 11A1.5 1.5 0 0010 9.5 1.5 1.5 0 008.5 8 1.5 1.5 0 007 9.5 1.5 1.5 0 008.5 11m7 0A1.5 1.5 0 0017 9.5 1.5 1.5 0 0015.5 8 1.5 1.5 0 0014 9.5a1.5 1.5 0 001.5 1.5M12 20a8 8 0 01-8-8 8 8 0 018-8 8 8 0 018 8 8 8 0 01-8 8m0-18C6.47 2 2 6.5 2 12a10 10 0 0010 10 10 10 0 0010-10A10 10 0 0012 2z"}})])])]):e.pickerOpen&&e.gifsEnabled&&e.activePicker===e.EMOJI_PICKER?t("button",{staticClass:"btn hoverable-btn focus-el",attrs:{title:"GIF",tabindex:"1002"},on:{click:e.openGifPicker,mousedown:function(e){e.preventDefault()}}},[t("span",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[t("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 467.88 300.62",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M90.5 121.62v57.375c0 21.037 17.212 38.25 38.25 38.25h57.375v-76.5H128.75v19.125H167v38.25h-38.25c-11.475 0-19.125-7.65-19.125-19.125V121.62c0-11.475 7.65-19.125 19.125-19.125h57.375V83.37H128.75c-21.038 0-38.25 17.212-38.25 38.25zM205.25 217.25h57.375v-19.125H243.5V102.5h19.125V83.375H205.25V102.5h19.125v95.625H205.25z"}}),t("path",{attrs:{d:"M400.5 0H67.38C34.867 0 .005 46.862.005 79.375v143.88c0 32.513 34.862 77.375 67.375 77.375H400.5c32.513 0 67.375-46.862 67.375-79.375V79.375C467.875 46.862 433.013 0 400.5 0zm32.25 217.25c0 21.037-15.213 48.25-36.25 48.25H71.38c-21.038 0-36.25-27.213-36.25-48.25V83.37c0-21.038 15.212-48.25 36.25-48.25H396.5c21.037 0 36.25 27.212 36.25 48.25z"}}),t("path",{attrs:{d:"M377.38 102.5V83.375h-95.625v133.88h19.125V159.88h57.375v-19.125H300.88v-38.25z"}})])])]):e._e()]),e._v(" "),t("div",{staticClass:"input-area-container"},[t("autoresize-area",{ref:"input",attrs:{"max-lines":4,"max-length":e.messageMaxLength},on:{input:e.onWrite,enter:e.onEnter}})],1),e._v(" "),t("div",{staticClass:"post-btn-container"},[t("stopper",{ref:"stop",staticClass:"stopper",attrs:{"update-period":100},on:{completion:e.onStopCompletion}}),e._v(" "),e.stopping?e._e():t("div",[e.counterEnabled?t("div",{staticClass:"chars-counter",class:{"limit-reached":e.chars>=e.messageMaxLength}},[e._v(e._s(e.chars)+"/"+e._s(e.messageMaxLength))]):e._e(),e._v(" "),e.sending?t("spinner",{staticClass:"chat-spinner",attrs:{circleColor:"#fff",circleSize:"9"}}):t("button",{staticClass:"btn post-btn hoverable-btn focus-el",attrs:{tabindex:"1004",title:e.editingMessage?e.$lang.data.k101:e.$lang.data.k81,disabled:e.sendDisabled},on:{click:function(t){return e.send()},mousedown:function(e){e.preventDefault()}}},[t("span",{staticClass:"focus-cont",attrs:{tabindex:"-1"}},[e.editingMessage?t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}})]):t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M2,21L23,12L2,3V10L17,12L2,14V21Z"}})])])])],1)],1)])],1)],1)}),[],!1,null,null,null)),Tt=Et.exports},5876:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var i=s(896),n=s(4053),o=s(491),a=s(2138),r=s(2358);function l(e){return e||"-"}var c={name:"presence",props:{context:{type:String,default:i.Z.PAGE},hideTotal:{type:Boolean,default:!1}},data(){return{store:n.Z,pageCounter:void 0,siteCounter:void 0}},created(){(0,r.Z)(a.s.Debug,"created"),this.handleCounters()},computed:{summary(){return this.showTotal?"1"===this.pageCounter?this.$lang.complete("k105",{$N:l(this.siteCounter)}):this.$lang.complete("k106",{$N:l(this.pageCounter),$M:l(this.siteCounter)}):this.context===i.Z.PAGE?"1"===this.pageCounter?this.$lang.data.k107:this.$lang.complete("k108",{$N:l(this.pageCounter)}):"1"===this.siteCounter?this.$lang.data.k109:this.$lang.complete("k110",{$N:l(this.siteCounter)})},show(){return!(this.context===i.Z.PAGE&&!o.v.PAGE_COUNTER_VIEW||this.context===i.Z.SITE&&!o.v.SITE_COUNTER_VIEW)},showTotal(){return this.show&&!this.hideTotal&&this.context===i.Z.PAGE&&o.v.SITE_COUNTER_VIEW}},watch:{context(e){(0,r.Z)(a.s.Debug,"newContext ->",e),this.handleCounters()}},methods:{handleCounters(){if(!this.show)return;const e=now4real.Subject.COUNTER_PAGE_VIEWERS,t=now4real.Subject.COUNTER_SITE_VIEWERS;this.context===i.Z.PAGE&&void 0===this.pageCounter&&((0,r.Z)(a.s.Debug,"init page counter"),void 0!==this.store[e]?(this.pageCounter=null,this.$watch(`store.${e}`,(e=>{this.pageCounter=e}),{immediate:!0})):(this.store[e]=null,now4real.subscribe(e,(t=>{this.store[e]=t.data.value,this.pageCounter=t.data.value})))),(this.context===i.Z.SITE||this.showTotal)&&void 0===this.siteCounter&&((0,r.Z)(a.s.Debug,"init site counter"),void 0!==this.store[t]?(this.siteCounter=null,this.$watch(`store.${t}`,(e=>{this.siteCounter=e}),{immediate:!0})):(this.store[t]=null,now4real.subscribe(t,(e=>{this.store[t]=e.data.value,this.siteCounter=e.data.value}))))}}},d=(s(4675),(0,s(1900).Z)(c,(function(){var e=this,t=e._self._c;return e.show?t("div",{attrs:{id:"presence-container"}},[t("div",{staticClass:"presence-summary"},[e._v("\n        "+e._s(e.summary)+"\n    ")])]):e._e()}),[],!1,null,null,null).exports)},9953:function(e,t,s){var i=s(9877);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("71acf5ac",i,!0,{})},6933:function(e,t,s){var i=s(4908);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("34eff828",i,!0,{})},3242:function(e,t,s){var i=s(350);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("53eb2d37",i,!0,{})},3370:function(e,t,s){var i=s(1389);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("4c88486e",i,!0,{})},8626:function(e,t,s){var i=s(2842);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("9c233a2e",i,!0,{})},3529:function(e,t,s){var i=s(2111);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("06a55db0",i,!0,{})},175:function(e,t,s){var i=s(8070);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("386acbd0",i,!0,{})},9951:function(e,t,s){var i=s(2969);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("20832f14",i,!0,{})},7962:function(e,t,s){var i=s(1770);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("4aa72343",i,!0,{})},4855:function(e,t,s){var i=s(3517);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("601aa48c",i,!0,{})},6388:function(e,t,s){var i=s(9222);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("22d7a730",i,!0,{})},2099:function(e,t,s){var i=s(6770);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("2c8a8770",i,!0,{})},3466:function(e,t,s){var i=s(2197);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("d5a4e238",i,!0,{})},7895:function(e,t,s){var i=s(9050);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("34dab8c1",i,!0,{})},6875:function(e,t,s){var i=s(4317);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("2baeb406",i,!0,{})},19:function(e,t,s){var i=s(8614);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("3fd6e4af",i,!0,{})},5614:function(e,t,s){var i=s(1134);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("1efa844f",i,!0,{})},8408:function(e,t,s){var i=s(6236);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("59270ba2",i,!0,{})},3747:function(e,t,s){var i=s(9277);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("659ccc3c",i,!0,{})},1061:function(e,t,s){var i=s(7703);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("0d1e6596",i,!0,{})},695:function(e,t,s){var i=s(9922);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("0fab3712",i,!0,{})},4675:function(e,t,s){var i=s(1778);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(5346).Z)("2f8f887a",i,!0,{})},4409:function(e,t,s){"use strict";e.exports=s.p+"imgs/powered-by-tenor.d3d9643721ed1c253d11.png"}}]);