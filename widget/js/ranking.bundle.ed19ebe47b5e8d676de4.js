(self.webpackChunkn4rWidget=self.webpackChunkn4rWidget||[]).push([[109],{3052:function(t,e,n){"use strict";var r=n(491),i=n(4053),a=n(2138),u=n(2358),o=r.v.UNSUB_GRACE_PERIOD;e.Z={data:function(){return{activated:!1,timerId:void 0}},activated:function(){this.activated=!0,(0,u.Z)(a.s.Debug,this.subject+" activated")},deactivated:function(){this.activated=!1,(0,u.Z)(a.s.Debug,this.subject+" deactivated")},computed:{isActive:function(){return i.Z.openedFrameConfig&&this.activated}},watch:{isActive:function(t,e){var n=this;t?this.timerId?(clearTimeout(this.timerId),this.timerId=void 0,(0,u.Z)(a.s.Debug,this.subject+" greace unset")):this.subscribe():(this.timerId=setTimeout((function(){(0,u.Z)(a.s.Debug,n.subject+" greace expired"),n.timerId=void 0,n.unsubscribe().then(n.resetState)}),o),(0,u.Z)(a.s.Debug,"".concat(this.subject," ").concat(o,"ms greace set")))}}}},2120:function(t,e,n){"use strict";function r(t){var e=document.createElement("a");return e.href=t,e}n.d(e,{e:function(){return r}})},8817:function(){},7837:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return C}});var r=n(4053),i=n(896),a=n(491),u=n(9814),o=n(3052),s=n(4780),c=n(2120),l=n(8),g=n(1099),d=n(7157),b=n(2138),h=n(2358),v={name:"ranking",mixins:[o.Z,s.Z],data:function(){return{store:r.Z,currentRankingSubject:now4real.Subject.RANKING_PAGE_VIEWERS,currentPageCounterSubject:now4real.Subject.COUNTER_PAGE_VIEWERS,currentSiteCounterSubject:now4real.Subject.COUNTER_SITE_VIEWERS,rankingForegroundSubject:now4real.Subject.RANKING_PAGE_VIEWERS,rankingActiveSubject:now4real.Subject.RANKING_PAGE_CHATTERS,pageCounterForegroundSubject:now4real.Subject.COUNTER_PAGE_VIEWERS,siteCounterForegroundSubject:now4real.Subject.COUNTER_SITE_VIEWERS,pageCounterActiveSubject:now4real.Subject.COUNTER_PAGE_CHATTERS,siteCounterActiveSubject:now4real.Subject.COUNTER_SITE_CHATTERS,pageUrl:now4real.siteContext+now4real.pageContext,loading:!1,ranking:[],pageCounter:null,siteCounter:null,pageCounterUnwatcher:null,siteCounterUnwatcher:null,showHead:void 0}},created:function(){this.showHead=a.v.SITE_COUNTER_VIEW},methods:{getNumber:l.D,getSuffix:l._,generateClick:function(t){(0,u.H)(t.target.firstChild)},labelizeRankingItem:function(t){var e=t.title,n=t.url?(0,c.e)(t.url):t.url;return"/"===e&&n&&"/"===n.pathname?"Home - "+n.host:e},titleizeRankingItem:function(t){return this.labelizeRankingItem(t)+"\n"+(t.url||t.key)},subscribe:function(t,e,n){var r=this;t=t||this.currentRankingSubject,e=e||this.currentPageCounterSubject,n=n||this.currentSiteCounterSubject,(0,h.Z)(b.s.Debug,"Subscribe ".concat(t,", ").concat(e,", ").concat(n)),this.loading=!0;var i,a,u=[now4real.subscribe(t,(function(t){"INIT"===t.data.action&&(r.loading=!1)})).then((function(e){r.ranking=now4real[t]}))];this.showHead&&(n===this.siteCounterForegroundSubject?(i=void 0===this.store[this.siteCounterForegroundSubject]?now4real.subscribe(n,(function(t){r.store[n]=t.data.value})):Promise.resolve(),this.siteCounterUnwatcher=this.$watch("store.".concat(n),(function(t){void 0!==t&&(r.siteCounter=t)}),{immediate:!0})):i=now4real.subscribe(n,(function(t){r.siteCounter=t.data.value})),u.push(i));return e===this.pageCounterForegroundSubject?(a=void 0===this.store[this.pageCounterForegroundSubject]?now4real.subscribe(e,(function(t){r.store[e]=t.data.value})):Promise.resolve(),this.pageCounterUnwatcher=this.$watch("store.".concat(e),(function(t){void 0!==t&&(r.pageCounter=t)}),{immediate:!0})):a=now4real.subscribe(e,(function(t){r.pageCounter=t.data.value})),u.push(a),Promise.all(u)},unsubscribe:function(t,e,n){t=t||this.currentRankingSubject,e=e||this.currentPageCounterSubject,n=n||this.currentSiteCounterSubject,(0,h.Z)(b.s.Debug,"Unsubscribe ".concat(t,", ").concat(e,", ").concat(n));var r=[now4real.unsubscribe(t)];return this.showHead&&n!==this.siteCounterForegroundSubject&&r.push(now4real.unsubscribe(n)),e!==this.pageCounterForegroundSubject&&r.push(now4real.unsubscribe(e)),Promise.all(r)},resetState:function(){(0,h.Z)(b.s.Debug,"".concat(this.currentRankingSubject," reset state call")),this.ranking=[],this.showHead&&(this.siteCounterUnwatcher&&(this.siteCounterUnwatcher(),this.siteCounterUnwatcher=null),this.siteCounter=null),this.pageCounterUnwatcher&&(this.pageCounterUnwatcher(),this.pageCounterUnwatcher=null),this.pageCounter=null},rankingRowStyle:function(t){return{color:t?a.v.COLOR_A:"#000",fontWeight:t?"700":"400"}}},computed:{showNote:function(){return this.connected&&this.ranking.length>=10},showSwitch:function(){return a.v.SCOPE===i.Z.PAGE},title:function(){return this.currentRankingSubject===this.rankingActiveSubject?this.$lang.data.k57:this.currentRankingSubject===this.rankingForegroundSubject?this.$lang.data.k56:void 0},populatedRanking:function(){return this.ranking.length>0},currentPagePresence:function(){return this.ranking.filter((function(t){return t.isCurrentPage})).length>0},foregroundSwitchLabelStyle:function(){var t=this.currentRankingSubject===this.rankingForegroundSubject;return{borderTop:"1px solid ".concat(a.v.COLOR_A),backgroundColor:t?a.v.COLOR_A:a.v.COLOR_B,color:t?a.v.COLOR_B:a.v.COLOR_A}},activeSwitchLabelStyle:function(){var t=this.currentRankingSubject===this.rankingActiveSubject;return{borderTop:"1px solid ".concat(a.v.COLOR_A),backgroundColor:t?a.v.COLOR_A:a.v.COLOR_B,color:t?a.v.COLOR_B:a.v.COLOR_A}}},watch:{currentRankingSubject:function(t,e){var n=this;this.unsubscribe(e).then((function(e){n.resetState(),n.currentPageCounterSubject=t===n.rankingForegroundSubject?n.pageCounterForegroundSubject:n.pageCounterActiveSubject,n.currentSiteCounterSubject=t===n.rankingForegroundSubject?n.siteCounterForegroundSubject:n.siteCounterActiveSubject,n.subscribe(t).catch((function(t){return(0,h.Z)(b.s.Error,t.message)}))})).catch((function(t){return(0,h.Z)(b.s.Error,t.message)}))}},components:{AnimatedCounter:g.Z,Spinner:d.Z}},S=(n(3026),(0,n(1900).Z)(v,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"ranking-container"}},[e("div",{staticClass:"ranking-wrapper"},[e("div",{staticClass:"ranking-table-wrapper smooth-scroll"},[e("table",{staticClass:"ranking-table"},[t.showHead?e("thead",[e("tr",[e("th",[t._v("\n                            "+t._s(t.title)+"\n                        ")]),t._v(" "),e("th",[e("animated-counter",{attrs:{value:t.getNumber(t.siteCounter),suffix:t.getSuffix(t.siteCounter),emptySymbol:""}})],1)])]):t._e(),t._v(" "),t.connected&&t.populatedRanking?e("transition-group",{key:"rank",attrs:{name:"flip-list",tag:"tbody"}},t._l(t.ranking,(function(n,r){return e("tr",{key:n.key,style:t.rankingRowStyle(n.isCurrentPage)},[e("td",{staticClass:"focus-el",attrs:{tabindex:n.url?201+r:null},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.generateClick.apply(null,arguments)}}},[n.url?e("a",{staticClass:"link focus-cont",attrs:{title:t.titleizeRankingItem(n),href:n.url,target:"_parent",tabindex:"-1"}},[t._v(t._s(t.labelizeRankingItem(n))+"\n                            ")]):e("span",{attrs:{title:t.titleizeRankingItem(n)}},[t._v(t._s(t.labelizeRankingItem(n))+"\n                            ")])]),t._v(" "),e("td",[t._v(t._s(n.users))])])})),0):t.connected&&t.loading?e("tbody",{key:"loading-rank"},[e("tr",{staticClass:"ranking-loading"},[e("td",{attrs:{colspan:"2"}},[e("spinner")],1)])]):t.connected?t._e():e("tbody",{key:"no-rank"},[e("tr",{staticClass:"ranking-empty"},[e("td",{attrs:{colspan:"2"}},[t._v(t._s(t.$lang.data.k60))])])]),t._v(" "),e("tbody",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&t.connected&&!t.currentPagePresence,expression:"!loading && connected && !currentPagePresence"}]},[e("tr",{class:{"current-row":t.populatedRanking},style:t.rankingRowStyle(!0)},[e("td",[e("span",{staticClass:"current-label",attrs:{title:t.pageUrl}},[t._v("\n                                "+t._s(t.$lang.data.k61)+"\n                            ")])]),t._v(" "),e("td",[e("animated-counter",{attrs:{value:t.getNumber(t.pageCounter),suffix:t.getSuffix(t.pageCounter),emptySymbol:""}})],1)])])],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showNote,expression:"showNote"}],staticClass:"ranking-note"},[t._v("\n                "+t._s(t.$lang.data.k62)+"\n            ")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSwitch,expression:"showSwitch"}],staticClass:"ranking-switch"},[e("ul",{staticClass:"segmented-control",class:{"segmented-control-disabled":!t.connected}},[e("li",{staticClass:"segmented-control-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentRankingSubject,expression:"currentRankingSubject"}],staticClass:"segmented-control-input",attrs:{type:"radio",id:"option-1"},domProps:{value:t.rankingForegroundSubject,checked:t._q(t.currentRankingSubject,t.rankingForegroundSubject)},on:{change:function(e){t.currentRankingSubject=t.rankingForegroundSubject}}}),t._v(" "),e("label",{staticClass:"segmented-control-label",style:t.foregroundSwitchLabelStyle,attrs:{for:"option-1"}},[t._v(t._s(t.$lang.data.k58))])]),t._v(" "),e("li",{staticClass:"segmented-control-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentRankingSubject,expression:"currentRankingSubject"}],staticClass:"segmented-control-input",attrs:{type:"radio",id:"option-2"},domProps:{value:t.rankingActiveSubject,checked:t._q(t.currentRankingSubject,t.rankingActiveSubject)},on:{change:function(e){t.currentRankingSubject=t.rankingActiveSubject}}}),t._v(" "),e("label",{staticClass:"segmented-control-label",style:t.activeSwitchLabelStyle,attrs:{for:"option-2"}},[t._v(t._s(t.$lang.data.k59))])])])])])])}),[],!1,null,null,null)),C=S.exports},3026:function(t,e,n){var r=n(8817);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[t.id,r,""]]),r.locals&&(t.exports=r.locals);(0,n(5346).Z)("f6524164",r,!0,{})}}]);