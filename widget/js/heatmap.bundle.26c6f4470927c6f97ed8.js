(self.webpackChunkn4rWidget=self.webpackChunkn4rWidget||[]).push([[534],{3052:function(t,e,s){"use strict";var a=s(491),n=s(4053),o=s(2138),r=s(2358);const i=a.v.UNSUB_GRACE_PERIOD;e.Z={data(){return{activated:!1,timerId:void 0}},activated(){this.activated=!0,(0,r.Z)(o.s.Debug,this.subject+" activated")},deactivated(){this.activated=!1,(0,r.Z)(o.s.Debug,this.subject+" deactivated")},computed:{isActive(){return n.Z.openedFrameConfig&&this.activated}},watch:{isActive(t,e){t?this.timerId?(clearTimeout(this.timerId),this.timerId=void 0,(0,r.Z)(o.s.Debug,this.subject+" greace unset")):this.subscribe():(this.timerId=setTimeout((()=>{(0,r.Z)(o.s.Debug,this.subject+" greace expired"),this.timerId=void 0,this.unsubscribe().then(this.resetState)}),i),(0,r.Z)(o.s.Debug,`${this.subject} ${i}ms greace set`))}}}},586:function(){},2441:function(){},6851:function(){},5104:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return y}});var a=s(491),n=s(896),o=s(4053),r=s(3052),i=s(4780),c=s(1795);function u(t){let e=1;return"-"===t[0]&&(e=-1,t=t.substr(1)),function(s,a){return(s[t]<a[t]?-1:s[t]>a[t]?1:0)*e}}var l=s(7157);const d={ad:"Andorra",ai:"Anguilla",aq:"Antarctica",as:"American Samoa",aw:"Aruba",ax:"Åland Islands",bh:"Bahrain",bl:"Saint Barthélemy",bm:"Bermuda",bq:"Bonaire, Sint Eustatius and Saba",bv:"Bouvet Island",cc:"Cocos (Keeling) Islands",ck:"Cook Islands",cw:"Curaçao",cx:"Christmas Island",eh:"Western Sahara",fm:"Micronesia, Federated States of",fo:"Faroe Islands",gg:"Guernsey",gi:"Gibraltar",gp:"Guadeloupe",gs:"South Georgia and the South Sandwich Islands",gu:"Guam",hk:"Hong Kong",hm:"Heard Island and McDonald Islands",im:"Isle of Man",io:"British Indian Ocean Territory",je:"Jersey",ki:"Kiribati",ky:"Cayman Islands",li:"Liechtenstein",lu:"Luxembourg",mc:"Monaco",me:"Montenegro",mf:"Saint Martin (French part)",mh:"Marshall Islands",mo:"Macao",mp:"Northern Mariana Islands",mq:"Martinique",ms:"Montserrat",nf:"Norfolk Island",nr:"Nauru",nu:"Niue",pm:"Saint Pierre and Miquelon",pn:"Pitcairn",pr:"Puerto Rico",ps:"Palestine, State of",pw:"Palau",sg:"Singapore",sh:"Saint Helena, Ascension and Tristan da Cunha",sj:"Svalbard and Jan Mayen",sm:"San Marino",ss:"South Sudan",sx:"Sint Maarten (Dutch part)",tc:"Turks and Caicos Islands",tf:"French Southern Territories",tk:"Tokelau",to:"Tonga",tv:"Tuvalu",um:"United States Minor Outlying Islands",va:"Holy See",vc:"Saint Vincent and the Grenadines",vg:"Virgin Islands, British",vi:"Virgin Islands, U.S.",wf:"Wallis and Futuna",ws:"Samoa",xk:"Kosovo",yt:"Mayotte",zz:"Unknown"};var h={name:"heatmap-legend",props:["countriesMap","countriesData"],mixins:[i.Z],data(){return{map:this.countriesMap,data:this.countriesData}},methods:{retrieveCountry(t){return this.data[t]||d[t]},toHSLColor(t){return(0,c.J7)(t)}},computed:{countriesArray(){return Object.keys(this.map).map((t=>({countryCode:t,country:this.retrieveCountry(t),intensity:this.map[t]})))},orderedCountriesArray(){return this.countriesArray.sort(function(){const t=arguments;return function(e,s){const a=t.length;let n=0,o=0;for(;0===o&&n<a;)o=u(t[n])(e,s),n++;return o}}("-intensity","country"))},populatedCountries(){return this.orderedCountriesArray.length>0}},components:{Spinner:l.Z}},p=h,m=(s(3404),s(1900)),b=(0,m.Z)(p,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"smooth-scroll",attrs:{id:"heatmap-legend-wrapper"}},[t.connected&&t.populatedCountries?e("table",{key:"leg",staticClass:"legend-table"},t._l(t.orderedCountriesArray,(function(s){return e("tr",{key:s.countryCode,staticClass:"legend-row"},[e("td",{staticClass:"legend-row-data"},[e("span",{staticClass:"intensity-label-wrapper"},[e("span",{staticClass:"intensity-label",style:{backgroundColor:t.toHSLColor(s.intensity),width:100*s.intensity+"%"}})]),t._v(" "),e("span",{staticClass:"country-name"},[t._v(t._s(s.country))])])])})),0):t.connected?e("table",{key:"loleg",staticClass:"legend-table"},[e("tr",{staticClass:"legend-row"},[e("td",{staticClass:"legend-row-data"},[e("spinner")],1)])]):e("table",{key:"noleg",staticClass:"legend-table"},[e("tr",{staticClass:"legend-row"},[e("td",{staticClass:"legend-row-data legend-empty"},[t._v("\n                "+t._s(t.$lang.data.k55)+"\n            ")])])])])}),[],!1,null,null,null).exports,v=s(4962),g=s(2138),C=s(2358),S=s(5825),_=s.n(S);s(4043);const E="#e7e7e7";var f={name:"heatmap",mixins:[r.Z,i.Z],data(){const t=a.v.SCOPE===n.Z.SITE;return{singleContext:t,subject:t&&a.v.SITE_COUNTER_VIEW||!t&&a.v.SITE_COUNTER_VIEW&&!a.v.PAGE_COUNTER_VIEW?now4real.Subject.HEATMAP_SITE_VIEWERS:now4real.Subject.HEATMAP_PAGE_VIEWERS,pageHeatmapForegroundSubject:now4real.Subject.HEATMAP_PAGE_VIEWERS,siteHeatmapForegroundSubject:now4real.Subject.HEATMAP_SITE_VIEWERS,store:o.Z,map:{},data:{},vmap:void 0,showSwitch:void 0}},created(){this.showSwitch=a.v.PAGE_COUNTER_VIEW&&a.v.SITE_COUNTER_VIEW},methods:{handleMobileConf(t,e){t||e?_()(".jqvmap-zoomin, .jqvmap-zoomout").hide():_()(".jqvmap-zoomin, .jqvmap-zoomout").show()},subscribe(t){let e=t||this.subject;return now4real.subscribe(e,(t=>{const e=t.data.country.toLowerCase(),s=t.data.intensity;null!==s&&0!==s?this.$set(this.map,e,s):this.$delete(this.map,e);const a=null!==s&&0!==s?(0,c.J7)(s):E,n={};n[e]=a,this.vmap.vectorMap("set","colors",n),(0,C.Z)(g.s.Debug,"map color update",e,s,a,n)}))},unsubscribe(t){let e=t||this.subject;return now4real.unsubscribe(e)},resetState(){(0,C.Z)(g.s.Debug,`${this.subject} reset state call`),Object.keys(this.map).forEach(((t,e)=>{(0,C.Z)(g.s.Debug,"deleting ",t),this.$delete(this.map,t);const s={};s[t]=E,this.vmap.vectorMap("set","colors",s)}))}},mounted(){(0,C.Z)(g.s.Debug,"Jqvmap mounted"),this.vmap=_()("#jqvmap");const t=_()("#jqvmap").vectorMap({map:"world_en",backgroundColor:"#fff",borderColor:"#3c515d",borderOpacity:.5,borderWidth:1,color:E,enableZoom:!1,selectedRegions:null,showTooltip:!0,onRegionClick:(t,e,s)=>{t.preventDefault()},onLabelShow:(t,e,s)=>{void 0===this.map[s]?t.preventDefault():e.text(e[0].innerText)},onRegionOver:(t,e)=>{t.preventDefault()}}).mapData.paths;for(let e in t)this.data[e]=t[e].name;this.data.cd="Democratic Republic of the Congo",this.handleMobileConf(this.store.isMobile,this.store.isTablet)},destroyed(){_()(".jqvmap-label").remove()},watch:{"store.isMobile"(t){this.handleMobileConf(t)},connected(t){const e=Object.keys(this.map);e.length>0&&(t?e.forEach(((t,e)=>{(0,C.Z)(g.s.Debug,`${t} restored`);const s={};s[t]=(0,c.J7)(this.map[t]),this.vmap.vectorMap("set","colors",s)})):e.forEach(((t,e)=>{(0,C.Z)(g.s.Debug,`${t} resetted`);const s={};s[t]=E,this.vmap.vectorMap("set","colors",s)})))},subject(t,e){this.unsubscribe(e).then((()=>{this.resetState(),this.subscribe(t).then((()=>{(0,C.Z)(g.s.Debug,`changed from ${e} to ${t}`)})).catch((t=>(0,C.Z)(g.s.Error,t.message)))})).catch((t=>(0,C.Z)(g.s.Error,t.message)))}},computed:{landscaped(){return this.store.isLandscape},context(){return this.subject===this.pageHeatmapForegroundSubject?n.Z.PAGE:this.subject===this.siteHeatmapForegroundSubject?n.Z.SITE:void 0},pageSwitchLabelStyle(){const t=this.subject===this.pageHeatmapForegroundSubject;return{borderTop:`1px solid ${a.v.COLOR_A}`,backgroundColor:t?a.v.COLOR_A:a.v.COLOR_B,color:t?a.v.COLOR_B:a.v.COLOR_A}},siteSwitchLabelStyle(){const t=this.subject===this.siteHeatmapForegroundSubject;return{borderTop:`1px solid ${a.v.COLOR_A}`,backgroundColor:t?a.v.COLOR_A:a.v.COLOR_B,color:t?a.v.COLOR_B:a.v.COLOR_A}}},components:{HeatmapLegend:b,Presence:v.Z}},w=f,y=(s(773),(0,m.Z)(w,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"heatmap-container"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.landscaped,expression:"!landscaped"}],attrs:{id:"jqvmap"}}),t._v(" "),e("presence",{directives:[{name:"show",rawName:"v-show",value:t.connected,expression:"connected"}],attrs:{context:t.context,hideTotal:""}}),t._v(" "),e("heatmap-legend",{attrs:{"countries-map":t.map,"countries-data":t.data}}),t._v(" "),t.showSwitch?e("div",{attrs:{id:"heatmap-switch"}},[e("ul",{staticClass:"segmented-control",class:{"segmented-control-disabled":!t.connected}},[e("li",{staticClass:"segmented-control-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.subject,expression:"subject"}],staticClass:"segmented-control-input",attrs:{type:"radio",id:"option-1"},domProps:{value:t.pageHeatmapForegroundSubject,checked:t._q(t.subject,t.pageHeatmapForegroundSubject)},on:{change:function(e){t.subject=t.pageHeatmapForegroundSubject}}}),t._v(" "),e("label",{staticClass:"segmented-control-label",style:t.pageSwitchLabelStyle,attrs:{for:"option-1"}},[t._v(t._s(t.$lang.data.k53))])]),t._v(" "),e("li",{staticClass:"segmented-control-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.subject,expression:"subject"}],staticClass:"segmented-control-input",attrs:{type:"radio",id:"option-2"},domProps:{value:t.siteHeatmapForegroundSubject,checked:t._q(t.subject,t.siteHeatmapForegroundSubject)},on:{change:function(e){t.subject=t.siteHeatmapForegroundSubject}}}),t._v(" "),e("label",{staticClass:"segmented-control-label",style:t.siteSwitchLabelStyle,attrs:{for:"option-2"}},[t._v(t._s(t.$lang.data.k54))])])])]):t._e()],1)}),[],!1,null,null,null).exports)},4962:function(t,e,s){"use strict";s.d(e,{Z:function(){return l}});var a=s(896),n=s(4053),o=s(491),r=s(2138),i=s(2358);function c(t){return t||"-"}var u={name:"presence",props:{context:{type:String,default:a.Z.PAGE},hideTotal:{type:Boolean,default:!1}},data(){return{store:n.Z,pageCounter:void 0,siteCounter:void 0}},created(){(0,i.Z)(r.s.Debug,"created"),this.handleCounters()},computed:{summary(){return this.showTotal?"1"===this.pageCounter?this.$lang.complete("k93",{$N:c(this.siteCounter)}):this.$lang.complete("k94",{$N:c(this.pageCounter),$M:c(this.siteCounter)}):this.context===a.Z.PAGE?"1"===this.pageCounter?this.$lang.data.k95:this.$lang.complete("k96",{$N:c(this.pageCounter)}):"1"===this.siteCounter?this.$lang.data.k97:this.$lang.complete("k98",{$N:c(this.siteCounter)})},show(){return!(this.context===a.Z.PAGE&&!o.v.PAGE_COUNTER_VIEW||this.context===a.Z.SITE&&!o.v.SITE_COUNTER_VIEW)},showTotal(){return this.show&&!this.hideTotal&&this.context===a.Z.PAGE&&o.v.SITE_COUNTER_VIEW}},watch:{context(t){(0,i.Z)(r.s.Debug,"newContext ->",t),this.handleCounters()}},methods:{handleCounters(){if(!this.show)return;const t=now4real.Subject.COUNTER_PAGE_VIEWERS,e=now4real.Subject.COUNTER_SITE_VIEWERS;this.context===a.Z.PAGE&&void 0===this.pageCounter&&((0,i.Z)(r.s.Debug,"init page counter"),void 0!==this.store[t]?(this.pageCounter=null,this.$watch(`store.${t}`,(t=>{this.pageCounter=t}),{immediate:!0})):(this.store[t]=null,now4real.subscribe(t,(e=>{this.store[t]=e.data.value,this.pageCounter=e.data.value})))),(this.context===a.Z.SITE||this.showTotal)&&void 0===this.siteCounter&&((0,i.Z)(r.s.Debug,"init site counter"),void 0!==this.store[e]?(this.siteCounter=null,this.$watch(`store.${e}`,(t=>{this.siteCounter=t}),{immediate:!0})):(this.store[e]=null,now4real.subscribe(e,(t=>{this.store[e]=t.data.value,this.siteCounter=t.data.value}))))}}},l=(s(2059),(0,s(1900).Z)(u,(function(){var t=this,e=t._self._c;return t.show?e("div",{attrs:{id:"presence-container"}},[e("div",{staticClass:"presence-summary"},[t._v("\n        "+t._s(t.summary)+"\n    ")])]):t._e()}),[],!1,null,null,null).exports)},3404:function(t,e,s){var a=s(586);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,s(5346).Z)("37385e00",a,!0,{})},773:function(t,e,s){var a=s(2441);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,s(5346).Z)("2a82cac4",a,!0,{})},2059:function(t,e,s){var a=s(6851);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,s(5346).Z)("2d65ca4c",a,!0,{})}}]);